<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>gvNIX - Documentaci&oacute;n de referencia</title><link rel="stylesheet" href="css/html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.73.2"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="book" lang="es"><div class="titlepage"><div><div><h1 class="title"><a name="spring-roo-reference-guide"></a>gvNIX - Documentaci&oacute;n de referencia</h1></div><div><div xmlns:fo="http://www.w3.org/1999/XSL/Format" class="authorgroup"><h2>Authors</h2><p></p>
      <span class="author"><a class="ulink" href="http://www.disid.com" target="_top">DiSiD Technologies S.L.</a></span>
    </div></div><div><p class="releaseinfo">1.0.0-RELEASE</p></div><div><div class="legalnotice"><a name="d4e10"></a>
      <p>Copyright 2010 - 2013 Consejer&iacute;a de Infraestructuras, Transporte
      y Medio Ambiende - Generalidad Valenciana</p>

      <p>Esta obra est&aacute; bajo la licencia Reconocimiento-Compartir bajo la
      misma licencia 3.0 Espa&ntilde;a <a class="ulink" href="???" target="_top">http://creativecommons.org/licenses/by-sa/3.0/es/</a>
      de Creative Commons. Puede copiarla, distribuirla y comunicarla
      p&uacute;blicamente siempre que especifique sus autores y comparta cualquier
      obra derivada bajo la misma licencia. La licencia completa se puede
      consultar en <a class="ulink" href="???" target="_top">http://creativecommons.org/licenses/by-sa/3.0/es/</a></p>
    </div></div></div><hr></div><div class="toc"><dl><dt><span class="part"><a href="#introduccion-part">I. Primeros pasos con gvNIX</a></span></dt><dd><dl><dt><span class="chapter"><a href="#introduccion">1. Introducci&oacute;n</a></span></dt><dd><dl><dt><span class="section"><a href="#introduccion_que-es-gvnix">1.1. &iquest;Qu&eacute; es gvNIX?</a></span></dt><dt><span class="section"><a href="#d4e44">1.2. &iquest;Qu&eacute; es Spring Roo?</a></span></dt><dt><span class="section"><a href="#d4e79">1.3. &iquest;Qu&eacute; ofrece gvNIX?</a></span></dt><dt><span class="section"><a href="#d4e105">1.4. Arquitectura</a></span></dt><dt><span class="section"><a href="#d4e146">1.5. El int&eacute;rprete de comandos</a></span></dt><dt><span class="section"><a href="#d4e176">1.6. &iquest;C&oacute;mo funciona?</a></span></dt><dt><span class="section"><a href="#d4e208">1.7. Generaci&oacute;n de c&oacute;digo</a></span></dt></dl></dd><dt><span class="chapter"><a href="#instalacion">2. Instalaci&oacute;n de gvNIX</a></span></dt><dd><dl><dt><span class="section"><a href="#instalacion_requisitos">2.1. Requisitos previos</a></span></dt><dd><dl><dt><span class="section"><a href="#d4e236">2.1.1. Configuraci&oacute;n del entorno</a></span></dt><dt><span class="section"><a href="#d4e280">2.1.2. Acceso a trav&eacute;s de un proxy</a></span></dt></dl></dd><dt><span class="section"><a href="#instalacion_instalacion">2.2. Descarga e instalaci&oacute;n de gvNIX</a></span></dt></dl></dd><dt><span class="chapter"><a href="#guia-desarrollo-eclipse">3. Desarrollo con Eclipse</a></span></dt><dd><dl><dt><span class="section"><a href="#guia-desarrollo_eclipse-instalar">3.1. Instalaci&oacute;n</a></span></dt><dd><dl><dt><span class="section"><a href="#guia-desarrollo_eclipse-instalar1">3.1.1. STS como distribuci&oacute;n</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_eclipse-instalar2">3.1.2. STS como plugin</a></span></dt></dl></dd><dt><span class="section"><a href="#d4e429">3.2. Consola gvNIX / Roo integrada en Eclipse</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_eclipse-usasr">3.3. Utilizar Eclipse como IDE</a></span></dt><dd><dl><dt><span class="section"><a href="#guia-desarrollo_eclipse-usar">3.3.1. Crear proyecto gvNIX en Eclipse IDE</a></span></dt><dt><span class="section"><a href="#d4e495">3.3.2. Importar proyecto gvNIX en Eclipse</a></span></dt></dl></dd><dt><span class="section"><a href="#guia-desarrollo_eclipse-pruebas-unitarias">3.4. Generaci&oacute;n de pruebas de integraci&oacute;n</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_aplicacion-base_arrancar-aplicacion-eclipse">3.5. Arrancar la aplicaci&oacute;n con Eclipse</a></span></dt><dd><dl><dt><span class="section"><a href="#guia-desarrollo_aplicacion-base_arrancar-aplicacion-eclipse_mostrar-vista-servidores">3.5.1. Mostrar la Vista de Servidores en Eclipse</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_aplicacion-base_arrancar-aplicacion-eclipse_crear-entorno-ejecucion">3.5.2. Crear un nuevo Servidor</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_aplicacion-base_arrancar-aplicacion-eclipse_ajustar-configuracion-server">3.5.3. Ajustar la configuraci&oacute;n del Servidor</a></span></dt><dt><span class="section"><a href="#d4e615">3.5.4. Ejecuci&oacute;n de la aplicaci&oacute;n en el Servidor</a></span></dt></dl></dd><dt><span class="section"><a href="#d4e648">3.6. Trabajando con el c&oacute;digo de la aplicaci&oacute;n en Eclipse</a></span></dt><dd><dl><dt><span class="section"><a href="#guia-desarrollo_eclipse-modificar-codigo">3.6.1. Modificaci&oacute;n del c&oacute;digo generado</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#ejemplos">4. Ejemplos gvNIX/Roo</a></span></dt></dl></dd><dt><span class="part"><a href="#desarrollo">II. Desarrollo de aplicaciones con gvNIX</a></span></dt><dd><dl><dt><span class="chapter"><a href="#guia-desarrollo-crear-app">5. Crear una nueva aplicaci&oacute;n</a></span></dt><dd><dl><dt><span class="section"><a href="#guia-desarrollo_aplicacion-base_crear-projecto">5.1. Crear un nuevo proyecto</a></span></dt></dl></dd><dt><span class="chapter"><a href="#guia-desarrollo-acceso-datos">6. Gesti&oacute;n del acceso a datos</a></span></dt><dd><dl><dt><span class="section"><a href="#guia-desarrollo-acceso-datos_persistencia-objetos">6.1. Persistencia de objetos</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_gestion-acceso-datos">6.2. Configurar la conexi&oacute;n con la base de datos</a></span></dt><dd><dl><dt><span class="section"><a href="#d4e891">6.2.1. jpa setup</a></span></dt><dt><span class="section"><a href="#d4e992">6.2.2. database properties</a></span></dt><dt><span class="section"><a href="#d4e1013">6.2.3. Ejemplo: Conectar con PostgreSQL</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_acceso-datos_actualizacion-esquema">6.2.4. Actualizaci&oacute;n autom&aacute;tica del esquema</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_gestion-acceso-datos_multiples-fuentes-datos">6.2.5. M&uacute;ltiples fuentes de datos</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#guia-desarrollo_generacion-codigo">7. C&oacute;digo generado por gvNIX/Roo</a></span></dt><dd><dl><dt><span class="section"><a href="#d4e1109">7.1. Clases Java y ficheros AJ</a></span></dt><dd><dl><dt><span class="section"><a href="#d4e1111">7.1.1. Archivos Java</a></span></dt><dt><span class="section"><a href="#d4e1114">7.1.2. Archivos AJ</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#guia-desarrollo_gestion-entidades">8. Gesti&oacute;n de entidades</a></span></dt><dd><dl><dt><span class="section"><a href="#guia-desarrollo_gestion-entidades_definicion_crear-con-comando">8.1. Crear una entidad con el int&eacute;rprete de
    comandos</a></span></dt><dd><dl><dt><span class="section"><a href="#guia-desarrollo_gestion-entidades_definicion_crear-con-comando_entity">8.1.1. Comando entity</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_gestion-entidades_definicion_crear-con-comando_field">8.1.2. Comando field</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_gestion-entidades_definicion_crear-con-comando_field_ejemplos">8.1.3. Proyecto ejemplo</a></span></dt></dl></dd><dt><span class="section"><a href="#guia-desarrollo_gestion-entidades_definicion_crear-a-mano">8.2. Crear una entidad con un IDE</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_gestion-entidades_definicion_modificar-modelo">8.3. Modificar una entidad</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_gestion-entidades_definicion_identificadores-compuestos">8.4. Identificadores compuestos</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_gestion-entidades_enlazar-base-datos-existente">8.5. Definir caracter&iacute;sticas espec&iacute;ficas para el modelo relacional</a></span></dt><dd><dl><dt><span class="section"><a href="#guia-desarrollo_gestion-entidades_enlazar-base-datos-existente_tablas">8.5.1. Definir un nombre de tabla</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_gestion-entidades_enlazar-base-datos-existente_columnas">8.5.2. Definir un nombre de columna</a></span></dt><dt><span class="section"><a href="#d4e1550">8.5.3. Campos calculados</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_gestion-entidades_enlazar-base-datos-existente_clave-primaria">8.5.4. Clave primaria</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_gestion-entidades_enlazar-base-datos-existente_campo-control-optimista">8.5.5. Campo para el control de concurrencia optimista.</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_gestion-entidades_enlazar-base-datos-existente_regeneracion-bbdd">8.5.6. Regeneraci&oacute;n de la Base de datos en cada
      arranque.</a></span></dt><dt><span class="section"><a href="#d4e1621">8.5.7. Creaci&oacute;n de una nueva entidad sin comandos</a></span></dt></dl></dd><dt><span class="section"><a href="#guia-desarrollo_gestion-entidades_ingenieria-inversa">8.6. Ingenier&iacute;a inversa de entidades</a></span></dt><dd><dl><dt><span class="section"><a href="#guia-desarrollo_ingenieria-inversa_instalacion">8.6.1. Instalaci&oacute;n del driver JDBC</a></span></dt><dt><span class="section"><a href="#d4e1666">8.6.2. Comandos de la ingenier&iacute;a inversa</a></span></dt><dt><span class="section"><a href="#d4e1701">8.6.3. Anotaci&oacute;n @RooDbManaged</a></span></dt><dt><span class="section"><a href="#d4e1711">8.6.4. Soporte de funcionalidades JPA 2.0</a></span></dt><dd><dl><dt><span class="section"><a href="#d4e1714">8.6.4.1. Claves primarias simples</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_entidades-dbre_clave_compuesta">8.6.4.2. Claves primarias compuestas</a></span></dt></dl></dd><dt><span class="section"><a href="#d4e1727">8.6.5. Ingenier&iacute;a inversa multi esquema</a></span></dt><dt><span class="section"><a href="#d4e1735">8.6.6. Ingenier&iacute;a inversa incremental</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#guia-desarrollo_entidades-buscadores">9. Buscadores de entidades</a></span></dt><dd><dl><dt><span class="section"><a href="#guia-desarrollo_entidades-buscadores-descripcion">9.1. Descripci&oacute;n</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_entidades-buscadores-listado">9.2. Listar buscadores</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_entidades-buscadores-crear">9.3. Creaci&oacute;n de un buscador</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_entidades-buscadores-codigo-generado">9.4. C&oacute;digo generado</a></span></dt></dl></dd><dt><span class="chapter"><a href="#guia-desarrollo_aplicacion-base_test">10. Pruebas de integraci&oacute;n</a></span></dt><dd><dl><dt><span class="section"><a href="#guia-desarrollo_aplicacion-base_test-integracion">10.1. Creaci&oacute;n de pruebas de integraci&oacute;n</a></span></dt></dl></dd><dt><span class="chapter"><a href="#guia-desarrollo_capa-web">11. Gesti&oacute;n de la capa web</a></span></dt><dd><dl><dt><span class="section"><a href="#guia-desarrollo_web_definir-controller">11.1. Crear la capa web con el int&eacute;rprete de
    comandos</a></span></dt><dd><dl><dt><span class="section"><a href="#guia-desarrollo_web_definir-controller_comandos_controller-setup">11.1.1. web mvc setup</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_web_definir-controller_comandos_controller-scaffold">11.1.2. web mvc scaffold</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_web_definir-controller_comandos_controller-scafold">11.1.3. web mvc all</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_web_definir-controller_comandos_controller-class">11.1.4. web mvc controller</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_capa-web_crear-comando">11.1.5. Proyecto ejemplo</a></span></dt></dl></dd><dt><span class="section"><a href="#guia-desarrollo_web_definir-controller_a-mano">11.2. Crear la capa web con un IDE</a></span></dt><dd><dl><dt><span class="section"><a href="#guia-desarrollo_web_definir-controller_a-mano_propio">11.2.1. Controlador a medida</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_web_definir-controller_a-mano_automatico">11.2.2. Controlador CRUD</a></span></dt><dt><span class="section"><a href="#d4e2023">11.2.3. C&oacute;digo generado en las vistas de la capa web</a></span></dt><dd><dl><dt><span class="section"><a href="#d4e2028">11.2.3.1. Estructura de archivos de las vistas en la capa web</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_web_tiles">11.2.3.2. Motor de plantillas: Tiles</a></span></dt><dt><span class="section"><a href="#d4e2079">11.2.3.3. Vistas CRUD (Create, Read, Update, Delete)</a></span></dt><dt><span class="section"><a href="#d4e2105">11.2.3.4. Componentes de las JSP de las vistas CRUD</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="#d4e2136">11.3. Visualizaci&oacute;n de entidades en la capa web</a></span></dt></dl></dd><dt><span class="chapter"><a href="#guia-desarrollo_capa-web-buscadores">12. Buscadores en la capa web</a></span></dt><dd><dl><dt><span class="section"><a href="#guia-desarrollo_capa-web-buscadores-descripcion">12.1. Descripci&oacute;n</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_capa-web-buscadores-crear">12.2. Creaci&oacute;n de buscadores</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_capa-web-buscadores-codigo-generado">12.3. C&oacute;digo generado</a></span></dt></dl></dd><dt><span class="chapter"><a href="#guia-desarrollo_capa-web-arranque-pruebas">13. Arranque y pruebas de la aplicaci&oacute;n web</a></span></dt><dd><dl><dt><span class="section"><a href="#guia-desarrollo_aplicacion-base_test-funcional">13.1. Pruebas funcionales</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_aplicacion-base_arrancar-aplicacion">13.2. Arrancar la aplicaci&oacute;n web</a></span></dt><dt><span class="section"><a href="#guia-desarrollo_aplicacion-base_ejecutar-tests-funcionales">13.3. Ejecutar los tests funcionales</a></span></dt></dl></dd></dl></dd><dt><span class="part"><a href="#addons-gvnix">III. Desarrollo avanzado con gvNIX</a></span></dt><dd><dl><dt><span class="chapter"><a href="#addon-theme-manager">14. Add-on Theme Manager</a></span></dt><dd><dl><dt><span class="section"><a href="#addon-theme-manager_descripcion">14.1. Descripci&oacute;n</a></span></dt><dt><span class="section"><a href="#d4e2281">14.2. Temas disponibles por defecto.</a></span></dt><dt><span class="section"><a href="#d4e2294">14.3. Futuras versiones</a></span></dt></dl></dd><dt><span class="chapter"><a href="#addon-web-menu">15. Add-on Web Menu</a></span></dt><dd><dl><dt><span class="section"><a href="#addon-web-menu_descripcion">15.1. Descripci&oacute;n</a></span></dt><dt><span class="section"><a href="#d4e2334">15.2. Definiciones</a></span></dt><dt><span class="section"><a href="#addon-web-menu_instalacion">15.3. Instalaci&oacute;n de la gesti&oacute;n del men&uacute;</a></span></dt><dt><span class="section"><a href="#d4e2393">15.4. Modificaci&oacute;n del men&uacute;.</a></span></dt><dt><span class="section"><a href="#addon-web-menu_futuras-versiones">15.5. Futuras versiones</a></span></dt></dl></dd><dt><span class="chapter"><a href="#addon-web-screen-patterns">16. Add-on Web Screen Patterns</a></span></dt><dd><dl><dt><span class="section"><a href="#addon-web-relation-styles_descripcion">16.1. Descripci&oacute;n</a></span></dt><dt><span class="section"><a href="#addon-web-relation-styles_instalacion">16.2. Instalaci&oacute;n</a></span></dt><dt><span class="section"><a href="#addon-web-relation-styles_creacion">16.3. Creaci&oacute;n de un patr&oacute;n</a></span></dt><dd><dl><dt><span class="section"><a href="#addon-web-relation-styles_creacion-maestro">16.3.1. Creaci&oacute;n de un patr&oacute;n maestro</a></span></dt><dt><span class="section"><a href="#addon-web-relation-styles_creacion-detalle">16.3.2. Creaci&oacute;n de un patr&oacute;n detalle</a></span></dt></dl></dd><dt><span class="section"><a href="#d4e2486">16.4. Tipos de patrones</a></span></dt><dd><dl><dt><span class="section"><a href="#d4e2488">16.4.1. Tabular</a></span></dt><dt><span class="section"><a href="#d4e2506">16.4.2. Registro</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#addon-persistence">17. Add-on OCC (Optimistic Concurrency Control)</a></span></dt><dd><dl><dt><span class="section"><a href="#addon-persistence_occchecksum">17.1. Introducci&oacute;n</a></span></dt><dt><span class="section"><a href="#addon-persistence_incluir">17.2. A&ntilde;adir el control en las entidades</a></span></dt></dl></dd><dt><span class="chapter"><a href="#addon-web-dialog">18. Add-on Web Dialog</a></span></dt><dd><dl><dt><span class="section"><a href="#addon-web-exception-handler_descripcion">18.1. Descripci&oacute;n</a></span></dt><dt><span class="section"><a href="#d4e2635">18.2. Instalaci&oacute;n</a></span></dt><dt><span class="section"><a href="#addon-web-exception-handler_excptiones-de-gvnix">18.3. Excepciones controladas por gvNIX</a></span></dt><dd><dl><dt><span class="section"><a href="#addon-web-exception-handler_funcionalidad">18.3.1. A&ntilde;adir nuevas excepciones a la gesti&oacute;n</a></span></dt></dl></dd><dt><span class="section"><a href="#addon-web-exception-handler_nuevos-dialogos">18.4. Nuevos di&aacute;logos modales</a></span></dt><dd><dl><dt><span class="section"><a href="#d4e2760">18.4.1. Ejemplos de dialogos personalizados</a></span></dt><dd><dl><dt><span class="section"><a href="#d4e2764">18.4.1.1. Mensaje de aviso de aplicaci&oacute;n</a></span></dt><dt><span class="section"><a href="#d4e2769">18.4.1.2. Mensaje de confirmaci&oacute;n</a></span></dt><dt><span class="section"><a href="#d4e2802">18.4.1.3. Di&aacute;logo modal con formulario</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="#addon-web-exception-handler_futuras-versiones">18.5. Futuras versiones</a></span></dt></dl></dd><dt><span class="chapter"><a href="#addon-cit-security">19. Add-on CIT Security</a></span></dt><dd><dl><dt><span class="section"><a href="#addon-cit-security_descripcion">19.1. Descripci&oacute;n</a></span></dt></dl></dd><dt><span class="chapter"><a href="#addon-web-report">20. Add-on Web Report</a></span></dt><dd><dl><dt><span class="section"><a href="#addon-web-report_descripcion">20.1. Descripci&oacute;n</a></span></dt><dt><span class="section"><a href="#addon-web-report_instalacion">20.2. Instalaci&oacute;n</a></span></dt><dt><span class="section"><a href="#addon-web-report_generacion">20.3. Generaci&oacute;n de un informe</a></span></dt><dt><span class="section"><a href="#addon-web-report_futuras-versiones">20.4. Futuras versiones</a></span></dt></dl></dd><dt><span class="chapter"><a href="#addon-service">21. Add-on Service</a></span></dt><dd><dl><dt><span class="section"><a href="#addon-service_descripcion">21.1. Descripci&oacute;n</a></span></dt><dt><span class="section"><a href="#addon-service_crear-local">21.2. Creaci&oacute;n de servicios locales</a></span></dt><dt><span class="section"><a href="#addon-service_crear-desde-java">21.3. Creaci&oacute;n de servidores desde Java</a></span></dt><dt><span class="section"><a href="#addon-service_crear-desde-wsdl">21.4. Creaci&oacute;n de servidores desde WSDL</a></span></dt><dt><span class="section"><a href="#d4e3062">21.5. Creaci&oacute;n de clientes</a></span></dt><dt><span class="section"><a href="#d4e3081">21.6. Acceso a un WSDL en un servidor seguro</a></span></dt><dd><dl><dt><span class="section"><a href="#d4e3114">21.6.1. Creaci&oacute;n de clientes con firma</a></span></dt></dl></dd><dt><span class="section"><a href="#d4e3141">21.7. Listar los servicios</a></span></dt></dl></dd><dt><span class="chapter"><a href="#addon-web-i18n">22. Add-on Web MVC i18n</a></span></dt><dd><dl><dt><span class="section"><a href="#addon-web-i18n_descripcion">22.1. Descripci&oacute;n</a></span></dt><dt><span class="section"><a href="#d4e3159">22.2. Instalaci&oacute;n de un idioma</a></span></dt><dt><span class="section"><a href="#addon-web-i18n_futuras-versiones">22.3. Futuras versiones</a></span></dt></dl></dd><dt><span class="chapter"><a href="#addon-dynamic_config">23. Add-on Dynamic Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#d4e3182">23.1. Descripci&oacute;n</a></span></dt><dt><span class="section"><a href="#d4e3198">23.2. Funcionalidad</a></span></dt><dt><span class="section"><a href="#addon-dynamic_config_futuras-versiones">23.3. Futuras versiones</a></span></dt></dl></dd><dt><span class="chapter"><a href="#addon-web-mvc-binding">24. Add-on Web MVC Binding</a></span></dt><dd><dl><dt><span class="section"><a href="#addon-web-mvc-binding_descripcion">24.1. Descripci&oacute;n</a></span></dt><dt><span class="section"><a href="#addon-web-mvc-binding_futuras-versiones">24.2. Futuras versiones</a></span></dt></dl></dd></dl></dd><dt><span class="part"><a href="#d4e3292">IV. Recetas de desarrollo</a></span></dt><dd><dl><dt><span class="chapter"><a href="#recetas">25. Recetas</a></span></dt><dd><dl><dt><span class="section"><a href="#recetas-repositorio_maven">25.1. Repositorios Maven</a></span></dt><dt><span class="section"><a href="#recetas-finders-multitud-campos">25.2. Desarrollo de buscadores con gran cantidad de campos</a></span></dt><dt><span class="section"><a href="#recetas-finders-modificar">25.3. Campos opcionales en los buscadores</a></span></dt><dt><span class="section"><a href="#recetas-reports-fuentes">25.4. Instalar fuentes de letra para los informes</a></span></dt><dt><span class="section"><a href="#recetas-reports-subinforme">25.5. Dise&ntilde;o de informes con sub informes</a></span></dt></dl></dd></dl></dd><dt><span class="part"><a href="#apendices">V. Ap&eacute;ndices</a></span></dt><dd><dl><dt><span class="chapter"><a href="#apendice-comandos">26. Ap&eacute;ndice de comandos de gvNIX</a></span></dt><dd><dl><dt><span class="section"><a href="#apendice-comandos_addon-persistence">26.1. Comandos del add-on OCC</a></span></dt><dd><dl><dt><span class="section"><a href="#apendice-comandos_addon-persistence_occchecksum_occ-checksum-set">26.1.1. occ checksum set</a></span></dt><dt><span class="section"><a href="#apendice-comandos_addon-persistence_occchecksum_occ-checksum-all">26.1.2. occ checksum all</a></span></dt></dl></dd><dt><span class="section"><a href="#apendice-comandos_addon-theme-manager">26.2. Comandos del add-on Theme Manager</a></span></dt><dd><dl><dt><span class="section"><a href="#apendice-comandos_addon-theme-manager_theme-install">26.2.1. theme install</a></span></dt><dt><span class="section"><a href="#apendice-comandos_addon-theme-manager_theme-set">26.2.2. theme set</a></span></dt><dt><span class="section"><a href="#apendice-comandos_addon-theme-manager_theme-list">26.2.3. theme list</a></span></dt></dl></dd><dt><span class="section"><a href="#apendice-comandos_addon-web-dialog">26.3. Comandos del add-on Web Dialog</a></span></dt><dd><dl><dt><span class="section"><a href="#apendice-comandos_addon-web-exception-handler_dialog-setup">26.3.1. web mvc dialog setup</a></span></dt><dt><span class="section"><a href="#apendice-comandos_addon-web-exception-handler_exception-handler-list">26.3.2. web mvc dialog exception list</a></span></dt><dt><span class="section"><a href="#d4e3786">26.3.3. web
    mvc dialog exception add</a></span></dt><dt><span class="section"><a href="#d4e3818">26.3.4. web
    mvc dialog exception set language</a></span></dt><dt><span class="section"><a href="#d4e3850">26.3.5. web
    mvc dialog exception remove</a></span></dt><dt><span class="section"><a href="#d4e3862">26.3.6. web mvc
    dialog add</a></span></dt></dl></dd><dt><span class="section"><a href="#apendice-comandos_addon-web-menu">26.4. Comandos del add-on Web Menu</a></span></dt><dd><dl><dt><span class="section"><a href="#apendice-comandos_addon-web-menu_page-menu-setup">26.4.1. menu setup</a></span></dt><dt><span class="section"><a href="#apendice-comandos_addon-web-menu_page-add">26.4.2. menu entry add</a></span></dt><dt><span class="section"><a href="#apendice-comandos_addon-web-menu_page-hide">26.4.3. menu entry visibility</a></span></dt><dt><span class="section"><a href="#apendice-comandos_addon-web-menu_page-show">26.4.4. menu entry roles</a></span></dt><dt><span class="section"><a href="#apendice-comandos_addon-web-menu_page-move">26.4.5. menu entry move</a></span></dt><dt><span class="section"><a href="#apendice-comandos_addon-web-menu_page-update">26.4.6. menu entry update</a></span></dt><dt><span class="section"><a href="#apendice-comandos_addon-web-menu_page-info">26.4.7. menu entry info</a></span></dt><dt><span class="section"><a href="#apendice-comandos_addon-web-menu_page-list">26.4.8. menu tree</a></span></dt></dl></dd><dt><span class="section"><a href="#apendice-comandos_web-relation-styles">26.5. Comandos del add-on Web Screen Patterns</a></span></dt><dd><dl><dt><span class="section"><a href="#apendice-comandos_addon-web_mvc_pattern_install">26.5.1. web mvc pattern install</a></span></dt><dt><span class="section"><a href="#apendice-comandos_addon-web_mvc_pattern">26.5.2. web mvc pattern master</a></span></dt><dt><span class="section"><a href="#apendice-comandos_addon-web_mvc_relation_pattern">26.5.3. web mvc pattern detail</a></span></dt></dl></dd><dt><span class="section"><a href="#apendice-comandos_cit-security">26.6. Comandos del add-on CIT Security</a></span></dt><dd><dl><dt><span class="section"><a href="#apendice-comandos_addon-cit-security_cit-security-setup">26.6.1. cit security setup</a></span></dt></dl></dd><dt><span class="section"><a href="#apendice-comandos_addon-web-report">26.7. Comandos del add-on Web Report</a></span></dt><dd><dl><dt><span class="section"><a href="#apendice-comandos_addon-web-report_setup">26.7.1. web report setup</a></span></dt><dt><span class="section"><a href="#apendice-comandos_addon-web-report_add">26.7.2. web report add</a></span></dt></dl></dd><dt><span class="section"><a href="#apendice-comandos_addon-service">26.8. Comandos del add-on Service</a></span></dt><dd><dl><dt><span class="section"><a href="#apendice-comandos_addon-service_class">26.8.1. remote service class</a></span></dt><dt><span class="section"><a href="#apendice-comandos_addon-service_operation">26.8.2. remote service operation</a></span></dt><dt><span class="section"><a href="#apendice-comandos_addon-service_define_ws">26.8.3. remote service define ws</a></span></dt><dt><span class="section"><a href="#apendice-comandos_addon-service_export_operation">26.8.4. remote service export operation</a></span></dt><dt><span class="section"><a href="#apendice-comandos_addon-service_list_operation">26.8.5. remote service list operation</a></span></dt><dt><span class="section"><a href="#apendice-comandos_addon-service_export_ws">26.8.6. remote service export ws</a></span></dt><dt><span class="section"><a href="#apendice-comandos_addon-service_import_ws">26.8.7. remote service import ws</a></span></dt><dt><span class="section"><a href="#apendice-comandos_addon-service_ws_list">26.8.8. remote service ws list</a></span></dt><dt><span class="section"><a href="#apendice-comandos_addon-service_security_ws">26.8.9. remote service security ws</a></span></dt></dl></dd><dt><span class="section"><a href="#apendice-comandos_addon-web_i18n">26.9. Comandos del add-on Web MVC i18n</a></span></dt><dd><dl><dt><span class="section"><a href="#apendice-comandos_addon-web_i18n_install_language">26.9.1. web mvc install language</a></span></dt></dl></dd><dt><span class="section"><a href="#apendice-comandos_addon-dynamic_config">26.10. Comandos del add-on Dynamic Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#apendice-comandos_addon-dynamic_config-config_save">26.10.1. configuration create</a></span></dt><dt><span class="section"><a href="#apendice-comandos_addon-dynamic_config-config_prop_add">26.10.2. configuration property add</a></span></dt><dt><span class="section"><a href="#apendice-comandos_addon-dynamic_config-config_prop_update">26.10.3. configuration property value</a></span></dt><dt><span class="section"><a href="#apendice-comandos_addon-dynamic_config-config_prop_undefined">26.10.4. configuration property undefined</a></span></dt><dt><span class="section"><a href="#apendice-comandos_addon-dynamic_config-config_list">26.10.5. configuration list</a></span></dt><dt><span class="section"><a href="#apendice-comandos_addon-dynamic_config-config_export">26.10.6. configuration export</a></span></dt></dl></dd><dt><span class="section"><a href="#apendice-comandos_addon-web-mvc-binding">26.11. Comandos del add-on Web MVC Binding</a></span></dt><dd><dl><dt><span class="section"><a href="#apendice-comandos_addon-web-mvc-binding_web-binding-setup">26.11.1. web mvc binding stringTrimmer</a></span></dt></dl></dd></dl></dd></dl></dd><dt><span class="part"><a href="#d4e4846">VI. Recursos</a></span></dt><dd><dl><dt><span class="chapter"><a href="#recursos">27. Recursos</a></span></dt><dd><dl><dt><span class="section"><a href="#recursos_cit">27.1. Proyectos relacionados con gvNIX</a></span></dt><dt><span class="section"><a href="#recursos_roo">27.2. Recursos de Spring Roo</a></span></dt><dt><span class="section"><a href="#recursos_librerias">27.3. Recursos de librer&iacute;as relacionadas</a></span></dt></dl></dd></dl></dd></dl></div>
  

  

  <div class="part" lang="es"><div class="titlepage"><div><div><h1 class="title"><a name="introduccion-part"></a>Parte&nbsp;I.&nbsp;Primeros pasos con gvNIX</h1></div></div></div>
    

    <div class="partintro" lang="es"><div></div>
      <p>Esta parte de la documentaci&oacute;n contiene la
      informaci&oacute;n necesaria para entender qu&eacute; es gvNIX y c&oacute;mo empezar a
      utilizarlo.</p>
    </div>

    <div class="chapter" lang="es"><div class="titlepage"><div><div><h2 class="title"><a name="introduccion"></a>Cap&iacute;tulo 1. Introducci&oacute;n</h2></div></div></div>
  

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="introduccion_que-es-gvnix"></a>1.1. &iquest;Qu&eacute; es gvNIX?</h2></div></div></div>
    

    <p>gvNIX es un entorno de trabajo Java de c&oacute;digo abierto
    para el desarrollo r&aacute;pido de aplicaciones web altamente productivo,
    flexible y que no compromete la calidad de los proyectos.</p>

    <p>Est&aacute; compuesto de un conjunto de herramientas de
    c&oacute;digo abierto entre las que destaca su n&uacute;cleo, <a class="ulink" href="http://www.springsource.org/spring-roo" target="_top">Spring Roo</a>.
    Esto le proporciona un amplio apoyo por parte de importantes
    organizaciones como Spring Source y VMWare. A&ntilde;ade funcionalidades de alto
    nivel a las prestaciones que ya se obtienen con <a class="ulink" href="http://www.springsource.org/spring-roo" target="_top"> Spring Roo</a>
    para mejorar la productividad.</p>

    <p>gvNIX es un proyecto subvencionado y liderado por la
    Consejer&iacute;a de Infraestructuras, Transporte y Medio Ambiente (CITMA) de la
    Generalidad Valenciana.</p>

    <p>gvNIX est&aacute; disponible dentro del proyecto de Migraci&oacute;n
    a Software de fuentes abiertas <a class="ulink" href="http://www.gvpontis.gva.es" target="_top">gvPONTIS</a>.</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p><a class="ulink" href="http://www.gvnix.org" target="_top">Comunidad
        online de gvNIX</a></p>
      </li><li>
        <p><a class="ulink" href="http://gvnix.googlecode.com" target="_top">Proyecto gvNIX en Google
        Code</a></p>
      </li><li>
        <p><a class="ulink" href="http://www.gvpontis.gva.es/cast/gvnix/" target="_top">P&aacute;gina de gvNIX
        dentro del proyecto gvPONTIS</a></p>
      </li><li>
        <p><a class="ulink" href="http://www.springsource.org/spring-roo" target="_top">P&aacute;gina oficial de
        Spring Roo</a></p>
      </li></ul></div>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e44"></a>1.2. &iquest;Qu&eacute; es Spring Roo?</h2></div></div></div>
    

    <p>Seg&uacute;n su creador, Ben Alex: "Roo es un peque&ntilde;o genio
    que observa desde un segundo plano y gestiona todo aquello de lo que no me
    quiero preocupar".</p>

    <p>Spring Roo es un entorno de trabajo Java que permite
    el desarrollo de aplicaciones web de forma r&aacute;pida y c&oacute;moda para el
    desarrollador. Sus principales caracter&iacute;sticas son:</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p>Generaci&oacute;n de c&oacute;digo en Java (lenguaje
        est&aacute;tico).</p>
      </li><li>
        <p>Eliminar el trabajo tedioso centrando el
        desarrollo en la l&oacute;gica de negocio.</p>
      </li><li>
        <p>Convenci&oacute;n sobre configuraci&oacute;n.</p>
      </li><li>
        <p>Desarrollo dirigido por el dominio (Domain-Driven
        Development):</p>

        <div class="itemizedlist"><ul type="circle"><li>
            <p>Dise&ntilde;o dirigido por el modelo de
            entidades.</p>
          </li><li>
            <p>L&oacute;gica en las entidades (Real Object
            Oriented), eliminando capas redundantes.</p>
          </li><li>
            <p>Otras capas opcionales (servicios, DAOs,
            ...).</p>
          </li></ul></div>
      </li><li>
        <p>Crea un proyecto en segundos.</p>
      </li><li>
        <p>Realimentaci&oacute;n: a&ntilde;ade valor durante todo el ciclo
        de vida.</p>
      </li><li>
        <p>No incorpora elementos adicionales al entorno de ejecuci&oacute;n, por
        lo que no penaliza la velocidad ni la memoria de la aplicaci&oacute;n.</p>
      </li><li>
        <p>No requiere ning&uacute;n IDE.</p>
      </li><li>
        <p>Recibe instrucciones a trav&eacute;s de una consola interactiva con
        autocompletado y ayuda en l&iacute;nea.</p>
      </li><li>
        <p>Extensible usando <span class="emphasis"><em>bundles OSGi</em></span>.</p>
      </li><li>
        <p>Aprovecha el conocimiento: no necesita m&aacute;s conocimiento que el
        necesario para el desarrollo de aplicaciones JEE.</p>
      </li></ul></div>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e79"></a>1.3. &iquest;Qu&eacute; ofrece gvNIX?</h2></div></div></div>
    

    <p>gvNIX aprovecha las caracter&iacute;sticas de Spring Roo y aporta su propia
    filosof&iacute;a, ofrecer al desarrollador componentes de alto valor funcional
    para aplicaciones corporativas:</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p>Control de concurrencia a nivel de aplicaci&oacute;n sin campos en base
        de datos.</p>
      </li><li>
        <p>Gesti&oacute;n de temas visuales.</p>
      </li><li>
        <p>Gesti&oacute;n de la visualizaci&oacute;n de excepciones.</p>
      </li><li>
        <p>Gesti&oacute;n de mensajes de usuario en ventana modal.</p>
      </li><li>
        <p>Gesti&oacute;n de la estructura de p&aacute;ginas en el men&uacute;.</p>
      </li><li>
        <p>Gesti&oacute;n de patrones de visualizaci&oacute;n de entidades y sus
        relaciones.</p>
      </li><li>
        <p>Gesti&oacute;n de transformaci&oacute;n de cadenas vac&iacute;as a valores
        nulos.</p>
      </li><li>
        <p>Gesti&oacute;n de servicios locales y servicios web (importaci&oacute;n y
        exposici&oacute;n).</p>
      </li><li>
        <p>Control de acceso (autenticaci&oacute;n y autorizaci&oacute;n).</p>
      </li><li>
        <p>Gesti&oacute;n de configuraciones por entorno.</p>
      </li><li>
        <p>Generaci&oacute;n de documentos (reportes).</p>
      </li></ul></div>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e105"></a>1.4. Arquitectura</h2></div></div></div>
    

    <p>gvNIX se centra en el desarrollo de aplicaciones Java
    para entornos corporativos.</p>

    <p>La arquitectura de Roo y gvNIX se subdivide en 2
    grandes bloques: el entorno de desarrollo y el entorno de ejecuci&oacute;n</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p>El entorno de desarrollo incorpora distintas
        herramientas enfocadas al desarrollo r&aacute;pido de aplicaciones Java. La
        caracter&iacute;stica m&aacute;s importante del entorno de desarrollo es que no
        introduce ning&uacute;n tipo de librer&iacute;a propia, de tal forma que en tiempo
        de ejecuci&oacute;n no a&ntilde;ade sobre coste alguno al rendimiento a las
        aplicaciones.</p>
      </li><li>
        <p>El entorno de ejecuci&oacute;n es un entorno t&iacute;pico de
        aplicaciones basadas en Spring 3:</p>

        <div class="itemizedlist"><ul type="circle"><li>
            <p>Acceso a bases de datos relacionales usando el API Java
            Persistence (JPA).</p>
          </li><li>
            <p>Inyecci&oacute;n de dependencias.</p>
          </li><li>
            <p>Gesti&oacute;n de transacciones propia de Spring.</p>
          </li><li>
            <p>Pruebas unitarias con JUnit.</p>
          </li><li>
            <p>Configuraci&oacute;n Maven para la construcci&oacute;n de las
            aplicaciones.</p>
          </li><li>
            <p>Vistas JSP usando Spring MVC. Adem&aacute;s, se pueden utilizar
            otras tecnolog&iacute;as de visualizaci&oacute;n tales como Flex, GWT, JSF y
            Vaadin.</p>
          </li></ul></div>

        <p>Las aplicaciones basadas en Spring son
        probablemente las aplicaciones Java m&aacute;s populares seguidas de JSF,
        Struts y GWT seg&uacute;n el <a class="ulink" href="http://twitpic.com/9mgnd5" target="_top">Developer Productivity Report
        2012</a>.</p>
      </li></ul></div>

    <p>Es importante destacar que Roo y gvNIX no imponen
    ninguna restricci&oacute;n sobre el tipo de aplicaciones que se pueden generar
    con este entorno. Algunos ejemplos de las funcionalidades que se pueden
    cubrir f&aacute;cilmente con la versi&oacute;n actual son (notar que no est&aacute;n limitadas
    &uacute;nicamente a estas):</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p>Intercambio de mensajes por JMS o env&iacute;o por
        SMTP.</p>
      </li><li>
        <p>Capa de servicios opcional con posibilidad de
        acceso remoto para clientes RIA.</p>
      </li><li>
        <p>Ejecuci&oacute;n de acciones predefinidas contra la base
        de datos.</p>
      </li></ul></div>

    <p>Una de las mayores diferencias entre Roo/gvNIX y las
    aplicaciones tradicionales generadas a mano es que, por defecto, no a&ntilde;ade
    capas de abstracci&oacute;n innecesarias. Las aplicaciones Java m&aacute;s tradicionales
    tienen una capa DAO, capas de servicios, capa de dominio y una capa de
    control. En una aplicaci&oacute;n generada con Roo/gvNIX inicialmente solo se usa
    una <a class="link" href="#guia-desarrollo_gestion-entidades" title="Cap&iacute;tulo 8. Gesti&oacute;n de entidades">capa de
    Entidad</a> (que es similar a la capa de dominio) y una <a class="link" href="#guia-desarrollo_capa-web" title="Cap&iacute;tulo 11. Gesti&oacute;n de la capa web">capa Web</a>. Se podr&aacute; generar
    tambi&eacute;n una capa de Servicios y/o DAO si fuese necesario.</p>

    <p>A continuaci&oacute;n se puede ver un diagrama de los
    componentes de la arquitectura, capas y tecnolog&iacute;as relacionadas en
    Roo/gvNIX:</p>

    <div class="figure"><a name="d4e141"></a><div class="figure-contents">
      

      <div class="mediaobject" align="center"><img src="images/gvnix-arquitectura-v1.0.png" align="middle" alt="Diagrama Arquitectura"></div>
    </div><p class="title"><b>Figura 1.1. Diagrama Arquitectura</b></p></div><br class="figure-break">
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e146"></a>1.5. El int&eacute;rprete de comandos</h2></div></div></div>
    

    <p>Para que el entorno empiece a funcionar, hay que arrancar un
    int&eacute;rprete de comandos (<span class="emphasis"><em>Roo shell</em></span>) mediante el que se
    interactuar&aacute; con el entorno de desarrollo. Este int&eacute;rprete de comandos o
    consola tiene dos funciones b&aacute;sicas:</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p>Ejecutar las &oacute;rdenes indicadas por el desarrollador.</p>
      </li></ul></div>

    <div class="itemizedlist"><ul type="disc"><li>
        <p>Monitorizar cualquier cambio en el proyecto para reajustar el
        c&oacute;digo generado.</p>
      </li></ul></div>

    <p>La consola tiene el siguiente aspecto:</p>

    <pre class="programlisting">    ____  ____  ____  
   / __ \/ __ \/ __ \ 
  / /_/ / / / / / / / 
 / _, _/ /_/ / /_/ /   gvNIX x.x.x distribution
/_/ |_|\____/\____/    x.x.x-RELEASE [rev xxxxxxx]

Welcome to Spring Roo. For assistance press TAB or type "hint" then hit ENTER.
roo-gvNIX&gt;</pre>

    <p>La usabilidad es un factor clave en el entorno de
    trabajo. Entre las principales caracter&iacute;sticas de usabilidad que
    proporciona la consola se encuentran:</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p>Comandos <span class="emphasis"><em>hint</em></span> y
        <span class="emphasis"><em>help</em></span>: Gu&iacute;an al usuario sobre la forma de
        proceder</p>
      </li><li>
        <p><span class="emphasis"><em>TAB</em></span> para completar
        pr&aacute;cticamente cualquier comando.</p>

        <p>Pulsando <span class="emphasis"><em>TAB</em></span> Roo sugiere que hacer a
        continuaci&oacute;n, que comando se puede utilizar a continuaci&oacute;n, incluso
        pulsando alg&uacute;n caracter qu&eacute; comandos que empiezan por ese caracter se
        pueden utilizar.</p>
      </li><li>
        <p>Si se produce alg&uacute;n error en alguna operaci&oacute;n, Roo
        deshar&aacute; todos los cambios generados dejando la aplicaci&oacute;n como se
        encontraba inicialmente.</p>
      </li><li>
        <p>Ejecuci&oacute;n de <span class="emphasis"><em>scripts</em></span>: Se
        puede guardar una secuencia de comandos en un archivo de texto y
        ejecutarlos en bloque cuantas veces se necesite. Por ejemplo, se puede
        hacer un gui&oacute;n para crear una aplicaci&oacute;n completa y ejecutarlo en el
        int&eacute;rprete de Roo.</p>
      </li><li>
        <p>Funcionamiento predictivo y conservador: Al
        ejecutarse en segundo plano debe ser un entorno conservador en el
        sentido que si no cambia nada en el proyecto no debe tocar nada, el
        desarrollador no debe perder nunca el control del proyecto.</p>
      </li></ul></div>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e176"></a>1.6. &iquest;C&oacute;mo funciona?</h2></div></div></div>
    

    <p>Este diagrama muestra a alto nivel el modelo funcional de Roo y
    gvNIX:</p>

    <div class="figure"><a name="d4e179"></a><div class="figure-contents">
      

      <div class="mediaobject" align="center"><img src="images/modelo-roo.png" align="middle" alt="Diagrama de modelo funcional de Roo y gvNIX"></div>
    </div><p class="title"><b>Figura 1.2. Diagrama de modelo funcional de Roo y gvNIX</b></p></div><br class="figure-break">

    <div class="itemizedlist"><div class="itemizedlist"><ul type="circle"><li>
          <p>Anotaciones</p>

          <p>Conjunto de <a class="ulink" href="http://hartocodigo.blogspot.com/2009/02/anotaciones-en-java-5.html" target="_top">anotaciones
          JAVA</a> que utilizan Roo y gvNIX para poder identificar un tipo de
          artefacto concreto y su configuraci&oacute;n. Tienen una pol&iacute;tica de
          retenci&oacute;n <span class="emphasis"><em>SOURCE</em></span> por lo que el compilador Java
          no las incluir&aacute; en la clases compiladas.</p>
        </li></ul></div><ul type="disc"><li>
        <p>Proyecto Java</p>

        <p>Es el contenido de nuestra aplicaci&oacute;n formada por
        todos los archivos necesarios.</p>
      </li><li>
        <div class="itemizedlist"><p>Infraestructura de Roo/gvNIX</p><p>Toda la infraestructura de Roo/gvNIX que forma
           el entorno de desarrollo, autocontenida y separada del proyecto
           final. Se compone de:</p><ul type="circle"><li>
            <p>Add-ons</p>

            <p>Componentes que autom&aacute;ticamente monitorizan y
            realizan cambios en nuestro proyecto.</p>

            <p>Tambi&eacute;n ofrecen un conjunto de comandos para que los
            desarrolladores puedan realizar operaciones a trav&eacute;s del
            int&eacute;rprete de comandos.</p>
          </li><li>
            <p>Int&eacute;rprete de comandos (Shell)</p>

            <p>Componente que permite la recepci&oacute;n y
            ejecuci&oacute;n de &oacute;rdenes del desarrollador</p>
          </li><li>
            <p>STS: SpringSource Tool Suite</p>

            <p>Plugin/Aplicaci&oacute;n Eclipse de SpringSource para
            trabajar con proyectos Spring. Entre otras, dispone de
            herramientas para trabajar con Roo/gvNIX.</p>
          </li></ul></div>
      </li></ul></div>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e208"></a>1.7. Generaci&oacute;n de c&oacute;digo</h2></div></div></div>
    

    <p><span class="emphasis"><em>Roo y gvNIX es un generador de c&oacute;digo
    h&iacute;brido, puesto que intenta combinar lo mejor de los modelos de
    generaci&oacute;n pasiva y activa.</em></span></p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p>Generaci&oacute;n pasiva:</p>

        <p>El desarrollador indica a la herramienta qu&eacute; es lo que debe
        generar, y una vez generado finaliza el trabajo de la herramienta.
        No se asume un mantenimiento a largo plazo del c&oacute;digo generado. El
        desarrollador interact&uacute;a mediante el int&eacute;rprete de comandos, desde
        ah&iacute; se realiza y termina el proceso de generaci&oacute;n de c&oacute;digo, que
        genera archivos xml y java.</p>
      </li><li>
        <p>Generaci&oacute;n activa:</p>

        <p>Es una realimentaci&oacute;n autom&aacute;tica que genera un modelo
        detallado de metadatos con la ayuda de las anotaciones @Roo y @GvNIX
        e incrementalmente actualiza archivos aj y jsp. Permite mantener
        autom&aacute;ticamente elementos del proyecto en respuesta a cambios, este
        tipo de generaci&oacute;n nunca modifica archivos java, estos solo se
        modifican por indicaci&oacute;n expresa del desarrollador y solo a trav&eacute;s
        del int&eacute;rprete de comandos.</p>
      </li></ul></div>
  </div>
</div>

    <div class="chapter" lang="es"><div class="titlepage"><div><div><h2 class="title"><a name="instalacion"></a>Cap&iacute;tulo 2. Instalaci&oacute;n de gvNIX</h2></div></div></div>
  

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="instalacion_requisitos"></a>2.1. Requisitos previos</h2></div></div></div>
    

    <p>gvNIX es en si mismo una aplicaci&oacute;n Java por lo que
    requiere tener una m&aacute;quina virtual Java instalada en el sistema.</p>

    <p>La lista de requisitos es la siguiente:</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p>Java JDK 5, 6 o 7 (<a class="ulink" href="http://www.oracle.com/technetwork/java/javase/downloads/jdk6-jsp-136632.html" target="_top">M&aacute;s informaci&oacute;n</a>).</p>
      </li><li>
        <p>Maven 2.0.9 o superior
        (<a class="ulink" href="http://maven.apache.org/" target="_top">http://maven.apache.org/</a>).</p>

        <p><span class="bold"><strong>Importante</strong></span>: usar las versiones de Maven 2.0.x o
        Maven 3.0.x. La versi&oacute;n Maven 2.2.x no es compatible.</p>
      </li><li>
        <p>Conexi&oacute;n a Internet para la descarga de las dependencias de los
        proyectos.</p>
      </li></ul></div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="d4e236"></a>2.1.1. Configuraci&oacute;n del entorno</h3></div></div></div>
      

      <p>La configuraci&oacute;n del entorno solo ser&aacute; necesario si se va a
      utilizar gvNIX desde la consola del sistema. Por lo tanto, no ser&aacute;
      necesario realizar todos los pasos indicados en este punto si se va a
      utilizar gvNIX desde Eclipse o STS tal y como se detallar&aacute; posteriomente.</p>

      <p>Una vez descargado el archivo de instalaci&oacute;n de Java JDK y Maven
      veamos como configurar el entorno de trabajo para usar estas
      herramientas.</p>

      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Nota</h3>
        <p>Las siguientes notas sobre configuraci&oacute;n son una recomendaci&oacute;n
        de buenas pr&aacute;cticas. La variable <span class="emphasis"><em>$HOME</em></span> hace referencia al path
        del directorio de ra&iacute;z de usuario (por ejemplo:
        <span class="emphasis"><em>/home/usuario</em></span>). Se supondr&ntilde;&aacute; instalado
        Java JDK y Maven en:</p>

        <div class="orderedlist"><ol type="1"><li>
            <p>Java JDK 1.6 instalada en:
            <span class="emphasis"><em>/home/usuario/software/jdk1.6.0_35</em></span></p>
          </li><li>
            <p>Maven 3 instalado en:
            <span class="emphasis"><em>/home/usuario/software/apache-maven-3.0.4</em></span></p>
          </li></ol></div>
      </div>

      <div class="itemizedlist"><ul type="disc"><li>
          <p><span class="bold"><strong>Variables de entorno</strong></span>.</p>

          <p>En entornos Unix, se puede utilizar
          <span class="emphasis"><em>$HOME/.bashrc</em></span> para definir las variables de
          entorno y autom&aacute;ticamente se cargar&aacute;n al abrir una nueva consola. Es
          una buena pr&aacute;ctica definirlas en nuestro propio archivo y cargarlo
          desde el <span class="emphasis"><em>$HOME/.bashrc</em></span>, en este caso dicho
          archivo se llamar&aacute; <span class="emphasis"><em>$HOME/.bash_devel</em></span>.</p>

          <p>En sistemas Windows, establecer en las propiedades de "Mi PC"
          &uacute;nicamente las variables de entorno que se definen a continuaci&oacute;n en
          el segundo punto.</p>

          <div class="itemizedlist"><ul type="circle"><li>
              <p><span class="bold"><strong>Modificar
              <span class="emphasis"><em>$HOME/.bashrc</em></span> para que cargue el archivo
              <span class="emphasis"><em>$HOME/.bash_devel</em></span></strong></span>:</p>

              <p>A&ntilde;adir al final del archivo .bashrc las siguientes
              l&iacute;neas:</p>

              <pre class="programlisting"># Development settings
if [ -f ~/.bash_devel ]; then
   . ~/.bash_devel
fi</pre>
            </li><li>
              <p><span class="bold"><strong>Crear/Modificar
              <span class="emphasis"><em>$HOME/.bash_devel</em></span> para a&ntilde;adir las variables
              de entorno</strong></span>:</p>

              <pre class="programlisting">export JAVA_HOME=$HOME/software/jdk1.6.0_35

export M2_HOME=$HOME/software/apache-maven-3.0.4

export M2=$M2_HOME/bin

export MAVEN_OPTS="-Xmx1024m -XX:MaxPermSize=512"

export PATH=$JAVA_HOME/bin:$M2:$PATH</pre>
            </li></ul></div>

          <p>Con estos cambios cada vez que se abra una consola del sistema
          estar&aacute;n cargadas las variables de entorno. Tambi&eacute;n se puede cargar
          los cambios realizados en estos ficheros ejecutando el comando
          <span class="emphasis"><em>source</em></span> en la consola de entornos Unix:</p>

          <pre class="programlisting">bash:~$ source .bashrc</pre>

          <p>Una vez realizados estos cambios se puede comprobar su
          funcionamiento: (Ejecutando los comandos siguientes veremos salidas
          similares a las que se muestran)</p>

          <pre class="programlisting">bash:~$ <span class="bold"><strong>java -version</strong></span>
java version "1.6.0_35"
Java(TM) SE Runtime Environment (build 1.6.0_35-b04)
Java HotSpot(TM) 64-Bit Server VM (build 20.8-b03, mixed mode)
bash:~$ <span class="bold"><strong>mvn -version</strong></span>
Apache Maven 3.0.4 (r1056850; 2012-01-09 17:58:10+0100)
Java version: 1.6.0_35, vendor: Sun Microsystems Inc.
Java home: /home/usuario/software/jdk1.6.0_35/jre
Default locale: es_ES, platform encoding: UTF-8
OS name: "linux", version: "3.2.0-30-generic", arch: "amd64", family: "unix"</pre>
        </li></ul></div>
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="d4e280"></a>2.1.2. Acceso a trav&eacute;s de un proxy</h3></div></div></div>
      

      <p>Si la conexi&oacute;n a Internet se realiza a trav&eacute;s de un proxy, habr&aacute;
      que configurar tanto Java como Maven para que puedan acceder al exterior
      correctamente.</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p><span class="bold"><strong>Java a trav&eacute;s de
          proxy</strong></span>:</p>

          <p>Es posible que la red en la que se est&eacute; trabajando requiera de la
          configuraci&oacute;n de un Proxy para el acesso a internet.</p>

          <p>gvNIX/Roo dispone de un comando que indica si la
          instalaci&oacute;n de Java est&aacute;, o no, configurada para conectar a Internet
          a trav&eacute;s de un proxy.</p>

          <pre class="programlisting">roo-gvNIX&gt; <span class="bold"><strong>proxy configuration</strong></span>
                     *** Your system has no proxy setup ***
http://download.oracle.com/javase/6/docs/technotes/guides/net/proxies.html offers 
useful information.
For most people, simply edit /etc/java-6-openjdk/net.properties (or equivalent) and
set the java.net.useSystemProxies=true property to use your operating system-defined
proxy settings.</pre>

          <p>En el ejemplo anterior indica que no hay ning&uacute;n proxy
          configurado. Si es necesario hacerlo se debe seguir la gu&iacute;a tal y
          como indica la salida del comando.</p>

          <p>Si se han seguido las recomendaciones para instalar Java, ir a
          /home/usuario/software/jdk1.6.0_35/jre/lib. Aqu&iacute; estar&aacute; el archivo
          net.properties que se debe editar y configurarlo seg&uacute;n las
          necesidades.</p>

          <p>La opci&oacute;n m&aacute;s sencilla es establecer la propiedad
          <span class="emphasis"><em>java.net.useSystemProxies=true</em></span>. Esto le indica
          a Java que debe utilizar la configuraci&oacute;n del proxy que previamente
          se haya definido en el sistema operativo. Sin embargo puede no
          funcionar en todos los sistemas.</p>

          <p>En caso de no funcionar lo anterior, definir la configuraci&oacute;n
          espec&iacute;fica del proxy buscando las propiedades descritas a
          continuaci&oacute;n y a&ntilde;adi&eacute;ndolas si no existen:</p>

          <pre class="programlisting">java.net.useSystemProxies=false

http.proxyHost=host.proxy.de.red (ejemplo: proxy.mired.com)
http.proxyPort=puerto (ejemplo: 8080)
http.nonProxyHosts=hosts.a.ignorar.1|host.a.ignorar.2
 (ejemplo: localhost|127.0.0.1|192.168.1.*|*.mired.com)

https.proxyHost=host.proxy.de.red (ejemplo: proxy.mired.com)
https.proxyPort=puerto (ejemplo: 8080)
https.nonProxyHosts=hosts.a.ignorar.1|host.a.ignorar.2
 (ejemplo: localhost|127.0.0.1|192.168.1.*|*.mired.com)</pre>

          <p>Si se configura alguna de estas propiedades el comando
          <span class="emphasis"><em>proxy configuration</em></span> informar&aacute; de los
          valores configurados.</p>
        </li><li>
          <p><span class="bold"><strong>Maven a trav&eacute;s de
          proxy:</strong></span></p>

          <p>Algunos comandos de gvNIX/Roo utilizan la herramienta Maven y
          dicha herramienta en algunos casos necesita conexi&oacute;n con Internet
          para, por ejemplo, descargar las dependencias de los proyectos
          generados.</p>

          <p>Es por ello que si se accede a Internet a trav&eacute;s de un proxy
          se deber&aacute; configurar en el fichero $M2_HOME/conf/settings.xml las
          siguientes secciones en el lugar adecuado del fichero. Revisar las
          secciones comentadas porque existir&aacute; ya una secci&oacute;n de este tipo
          como ejemplo:</p>

          <pre class="programlisting">&lt;proxy&gt;
        &lt;id&gt;Proxyhttp&lt;/id&gt;
        &lt;active&gt;true&lt;/active&gt;
        &lt;protocol&gt;http&lt;/protocol&gt;
        &lt;host&gt;host.proxy.de.red (ejemplo: proxy.mired.com)&lt;/host&gt;
        &lt;port&gt;puerto (ejemplo: 8080)&lt;/port&gt;
&lt;/proxy&gt;
&lt;proxy&gt;
        &lt;id&gt;Proxyhttps&lt;/id&gt;
        &lt;active&gt;true&lt;/active&gt;
        &lt;protocol&gt;https&lt;/protocol&gt;
        &lt;host&gt;host.proxy.de.red (ejemplo: proxy.mired.com)&lt;/host&gt;
        &lt;port&gt;puerto (ejemplo: 8080)&lt;/port&gt;
&lt;/proxy&gt;</pre>
        </li></ul></div>
    </div>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="instalacion_instalacion"></a>2.2. Descarga e instalaci&oacute;n de gvNIX</h2></div></div></div>
    

    <div class="orderedlist"><ol type="1"><li>
        <p>Descargar (<a class="ulink" href="https://code.google.com/p/gvnix/downloads/list" target="_top">https://code.google.com/p/gvnix/downloads/list</a>)
        y descomprimir el fichero ZIP de la versi&oacute;n de gvNIX m&aacute;s actual, por ejemplo
        gvNIX-X.Y.Z.RELEASE.zip</p>

        <div class="itemizedlist"><ul type="disc"><li>
            <p>Ejemplo para sistemas Unix y Apple:</p>

            <pre class="programlisting">bash:~$ unzip gvNIX-X.Y.Z.RELEASE.zip</pre>
          </li></ul></div>
      </li><li>
        <p>Al descomprimir el fichero ZIP se crear&aacute; un nuevo directorio
        <span class="emphasis"><em>gvNIX-X.Y.Z.RELEASE</em></span>. En el resto del documento
        se har&aacute; referencia a este directorio como
        <span class="emphasis"><em>GVNIX_HOME</em></span></p>
      </li><li>
        <p>Incluir el directorio <span class="emphasis"><em>bin</em></span> de gvNIX en la
        variable de entorno <span class="emphasis"><em>PATH.</em></span></p>

        <p><span class="emphasis"><em>Solo ser&aacute; necesaria si se utiliza gvNIX desde la
        consola del sistema. Por lo tanto, no ser&aacute; necesario realizar todos
        los pasos indicados en este punto si se utiliza gvNIX desde
        Eclipse o STS tal y como se detallar&aacute; posteriomente.</em></span></p>

        <div class="itemizedlist"><ul type="disc"><li>
            <p>Ejemplo para sistemas Unix y Apple:</p>

            <pre class="programlisting">bash:~$ cd gvNIX-X.Y.Z.RELEASE
bash:~/gvNIX-X.Y.Z.RELEASE$ export PATH=$PWD/bin:$PATH</pre>

            <p>Se puede definir la variable <span class="emphasis"><em>GVNIX_HOME</em></span>
            y su inclusi&oacute;n en el PATH del sistema mediante el archivo
            <span class="emphasis"><em>.bash_devel</em></span> y as&iacute; tenerla disponible de
            manera permanente.</p>

            <p>Recordar que en sistemas Windows, se pueden establecer en
            las propiedades de "Mi PC" las variables de entorno que se definen
            a continuaci&oacute;n.</p>

            <p>Para ello modificamos el archivo para que quede como
            sigue:</p>

            <pre class="programlisting">...
export GVNIX_HOME=$HOME/software/gvNIX-X.Y.Z.RELEASE

export PATH=$JAVA_HOME/bin:$M2:$GVNIX_HOME/bin:$PATH</pre>

            <p>Notar que la &uacute;ltima l&iacute;nea es la modificaci&oacute;n de la
            definici&oacute;n de la variable <span class="emphasis"><em>PATH</em></span>. Recordar
            recargar el fichero <span class="emphasis"><em>.bash_devel</em></span> mediante el
            comando <span class="emphasis"><em>source</em></span> de la consola de entornos Unix.</p>
          </li></ul></div>
      </li></ol></div>

    <p>Una vez hecho esto, ya se puede trabajar con el entorno gvNIX desde
    la l&iacute;nea de comandos. Sin embargo, se recomienda utilizar un IDE de
    desarrollo que permita integrar el entorno gvNIX como, por ejemplo STS o
    Eclipse tal y como se ver&aacute; en la secci&oacute;n posterior. A&uacute;n as&iacute;, si se desea abrir el
    int&eacute;rprete de comandos desde la l&iacute;nea de comandos se puede hacer de la
    siguiente forma:</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p>Cambiar al directorio donde se encuentre el proyecto
        Java existente o a un directorio vac&iacute;o en el caso de tratarse
        de un proyecto nuevo:</p>

        <pre class="programlisting">bash:~$ cd ~/project-directory</pre>
      </li><li>
        <p>Ejecutar el int&eacute;rprete de comando de gvNIX para interactuar con
        el proyecto Java:</p>

        <pre class="programlisting">bash:~/project-directory$ gvnix.sh

(En sistemas windows el int&eacute;rprete se abrir&aacute; con gvnix.bat)</pre>
      </li><li>
      <p>Con esto se abrir&aacute; la consola de gvNIX y se mostrar&aacute; algo similar
      a lo siguiente:</p>

	    <pre class="programlisting">    ____  ____  ____  
			   / __ \/ __ \/ __ \ 
			  / /_/ / / / / / / / 
			 / _, _/ /_/ / /_/ /   gvNIX x.x.x distribution
			/_/ |_|\____/\____/    x.x.x-RELEASE [rev xxxxxxx]
			
			
			Welcome to Spring Roo. For assistance press TAB or type "hint" then hit ENTER.
			roo-gvNIX&gt;
		</pre>
	  </li></ul></div>

  </div>
</div>

    <div class="chapter" lang="es"><div class="titlepage"><div><div><h2 class="title"><a name="guia-desarrollo-eclipse"></a>Cap&iacute;tulo 3. Desarrollo con Eclipse</h2></div></div></div>
  

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="guia-desarrollo_eclipse-instalar"></a>3.1. Instalaci&oacute;n</h2></div></div></div>
     
    

    <p>Spring ha desarrollado una extensi&oacute;n para Eclipse llamada
    SpringSource Tool Suite o STS, que ofrece soporte para trabajar en
    Eclipse con aplicaciones de Spring, entre ellas Spring Roo y por tanto
    gvNIX. Entre otras funcionalidades incorpora un int&eacute;rprete de comandos
    de Roo que permite ejecutar &oacute;rdenes sin necesidad de salir de
    Eclipse.</p>

    <p>Hay dos formas de instalar STS, la primera es como una distribuci&oacute;n
    propia y la segunda es como un plugin de un Eclipse ya existente. 
    Se recomienda encarecidamente utilizar la primera de ellas por su 
    facilidad de instalaci&oacute;n y mejor rendimiento.</p>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="guia-desarrollo_eclipse-instalar1"></a>3.1.1. STS como distribuci&oacute;n</h3></div></div></div>
      

      <p>
        <span class="emphasis"><em>
          <span class="emphasis"><em>Para instalar el IDE como una distribuci&oacute;n propia realizar
          los siguientes pasos:</em></span>
        </em></span>
      </p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>Descargar la &uacute;ltima versi&oacute;n de Springsource Tool Suite desde
          <a class="ulink" href="http://www.springsource.org/springsource-tool-suite-download" target="_top">
          http://www.springsource.org/springsource-tool-suite-download</a>. Elegir
          la versi&oacute;n comprimida que se adapte al sistema operativo y
          arquitectura de 32bits o 64bits.</p>
        </li><li>Descomprimir el archivo descargado y moverlo a una carpeta,
        por ejemplo $HOME/software.</li><li>Ejecutar STS
        ($HOME/software/springsource-X.X.X/sts-X.X.X.RELEASE/STS). Tener en
        cuenta que STS es una aplicaci&oacute;n Java por lo que requiere tener una
        m&aacute;quina virtual Java instalada en el sistema.</li></ul></div>
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="guia-desarrollo_eclipse-instalar2"></a>3.1.2. STS como plugin</h3></div></div></div>
      
    </div>

    <p>
      <span class="emphasis"><em>
        <span class="emphasis"><em>Para instalar el IDE en un Eclipse existente seguir los
        siguientes pasos:</em></span>
      </em></span>
    </p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p>Si no se dispone todav&iacute;a de &eacute;l, descargar Eclipse IDE for Java
        EE Developers de <a class="ulink" href="http://www.eclipse.org/downloads/" target="_top">
        http://www.eclipse.org/downloads/</a></p>
      </li><li>
        <p>Crear la variable de classpath de Eclipse M2_REPO, para
        ello:</p>

        <div class="orderedlist"><ol type="1"><li>
            <p><span class="bold"><strong>
                <span class="emphasis"><em>
                  <code class="literal">Window &gt; Preferences &gt; Java &gt; Build Path
                  &gt; Classpath Variables</code>
                </em></span>
              </strong></span>, bot&oacute;n <span class="emphasis"><em>
                <span class="emphasis"><em>
                  <code class="literal">New...</code>
                </em></span>
              </em></span>.</p>
          </li><li>
            <p>Definir los siguientes valores:</p>

            <div class="itemizedlist"><ul type="circle"><li>
                <p><span class="emphasis"><em>
                    <span class="emphasis"><em>
                      <code class="literal">Name</code>
                    </em></span>
                  </em></span> = <span class="emphasis"><em>
                    <span class="emphasis"><em>
                      <code class="literal">M2_REPO</code>
                    </em></span>
                  </em></span>.</p>
              </li><li>
                <p><span class="emphasis"><em>
                    <span class="emphasis"><em>
                      <code class="literal">Path</code>
                    </em></span>
                  </em></span> = directorio correspondiente al repositorio de
                Maven (normalmente en Unix: $HOME/.m2/repository)</p>
              </li></ul></div>
          </li><li>
            <p><span class="emphasis"><em>Ok</em></span> para crear la variable, y
            <span class="emphasis"><em>Ok</em></span> de nuevo para cerrar la ventana de
            preferencias y guardar cambios.</p>
          </li></ol></div>
      </li><li>
        <p>Instalar plugin M2Eclipse para Eclipse
        (http://m2eclipse.sonatype.org/installing-m2eclipse.html)</p>

        <p>En el men&uacute; Help &gt; Install New Software, en el campo de texto
        "Work with:" indicar que se usar&aacute; el site:
        <a class="ulink" href="http://m2eclipse.sonatype.org/sites/m2e" target="_top">
        http://m2eclipse.sonatype.org/sites/m2e</a>.
        A continuci&oacute;n eleccionar "Maven Integration for Eclipse". 
        Pulsar en siguiente y tras aceptar la licencia del plugin instalar.</p>
      </li><li>
        <p>Activa la opci&oacute;n <span class="emphasis"><em>
            <span class="emphasis"><em>
              <code class="literal">Enable Window &gt; Preferences &gt; General &gt;
              Workspace &gt; Refresh Automatically</code>
            </em></span>
          </em></span>.</p>
      </li><li>
        <p>Opcionalmente, instalar el plugin Subeclipse para trabajar sobre
        el sistema de control de versiones Subversion (SVN).</p>

        <p>Para ello en Eclipse, en el men&uacute; <span class="emphasis"><em>Help &gt; Install New
        Software</em></span>. En la ventana que se abre hacer click sobre el
        bot&oacute;n <span class="emphasis"><em>Add</em></span> que hay a la derecha de <span class="emphasis"><em>Work
        with</em></span>. Se abre un di&aacute;logo en el que se indicar&aacute; como
        nombre Subeclipse por ejemplo y en la URL indicar
        <span class="emphasis"><em>http://subclipse.tigris.org/update_1.6.x</em></span>
        guardar con <span class="emphasis"><em>OK</em></span> y la ventana anterior empezar&aacute;
        la carga de los plugins que hay disponibles. Seleccionarlos y
        seguir haciendo click en <span class="emphasis"><em>Next</em></span>. La URL
        indicada es de la versi&oacute;n actual, revisar el sitio oficial de <a class="ulink" href="http://subclipse.tigris.org/servlets/ProjectProcess?pageID=p4wYuA" target="_top">Subeclipse</a>
        para m&aacute;s informaci&oacute;n y futuras versiones.</p>
      </li><li>Para instalar el plugin STS seguir las instrucciones del punto
      "UPDATE SITE INSTALLATION" del documento <a class="ulink" href="http://dist.springsource.com/release/STS/doc/STS-installation_instructions.pdf" target="_top">Spring
      Source Tool Suite Installation Instructions</a>.</li></ul></div>

     
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e429"></a>3.2. Consola gvNIX / Roo integrada en Eclipse</h2></div></div></div>
    

    <p>El plugin o distribuci&oacute;n de STS instalado ofrece la posibilidad de
    incluir la consola de gvNIX en el propio entorno de desarrollo. Para ello
    antes hay que indicarle a Eclipse donde est&aacute; instalada la nueva versi&oacute;n de
    gvNIX.</p>

    <p>En el men&uacute; <span class="emphasis"><em>Window &gt; Preferences &gt; Spring &gt; 
    Roo Support</em></span>.
    Pulsar sobre el bot&oacute;n Add y buscar en el navegador de archivos el lugar
    donde est&aacute; instalado gvNIX. Aparecer&aacute; una pantalla similar a la
    siguiente:</p>

    <div class="figure"><a name="d4e434"></a><div class="figure-contents">
      

      <div class="mediaobject" align="center"><img src="images/preferences_roo.png" align="middle" alt="Configuraci&oacute;n del soporte gvNIX en Eclipse"></div>
    </div><p class="title"><b>Figura 3.1. Configuraci&oacute;n del soporte gvNIX en Eclipse</b></p></div><br class="figure-break">

    <p>Presionando en OK sobre las dos pantallas que abiertas ya estar&aacute;
    configurado el soporte para la linea de comandos de gvNIX. Para poder
    usarlo abrir la perspectiva de Spring con <span class="emphasis"><em>Window &gt; Open 
    Perspective &gt; Other &gt; Spring</em></span>.
    En la parte inferior de la pantalla aparecer&aacute; una
    pesta&ntilde;a llamada Roo Shell. Si no apareciese la pesta&ntilde;a, puede abrirse
    seleccionando <span class="emphasis"><em>Window &gt; Show View &gt; Roo Shell.
    </em></span></p>

    <p>Para abrir la consola pulsar en el bot&oacute;n que aparece en la parte
    superior derecha de la pesta&ntilde;a con el t&iacute;tulo <span class="emphasis"><em>Open Roo
    Shell.</em></span> Entonces seleccionar el proyecto en el que se va a
    trabajar y ya se puede empezar a ejecutar comandos. Si no se dispone
    todav&iacute;a de ning&uacute;n proyecto, en el punto siguiente se ver&aacute; como crear un
    nuevo proyecto.</p>

    <p>La ejecuci&oacute;n de comandos tambi&eacute;n se puede hacer de forma gr&aacute;fica
    pulsando en el bot&oacute;n que aparece en la parte superior derecha de la
    pesta&ntilde;a con el t&iacute;tulo Open Roo Command Wizard.</p>

    <div class="figure"><a name="d4e445"></a><div class="figure-contents">
      

      <div class="mediaobject" align="center"><img src="images/eclipse_gvNIX_shell.png" align="middle" alt="Consola gvNIX en Eclipse"></div>
    </div><p class="title"><b>Figura 3.2. Consola gvNIX en Eclipse</b></p></div><br class="figure-break">

    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Nota</h3>
      <p>Hay que tener en cuenta una peque&ntilde;a diferencia a la hora de usar
      la l&iacute;nea de comandos desde Eclipse con respecto a la linea de comandos
      de gvNIX en la consola del sistema. Mientras en una consola del sistema
      se utiliza la tecla TAB para completar los comandos, en el IDE se
      utilizar&aacute; Ctrl+Space que es el atajo por defecto usado en
      Eclipse.</p>
    </div>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="guia-desarrollo_eclipse-usasr"></a>3.3. Utilizar Eclipse como IDE</h2></div></div></div>
    

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="guia-desarrollo_eclipse-usar"></a>3.3.1. Crear proyecto gvNIX en Eclipse IDE</h3></div></div></div>
      

      <p>Crear un proyecto gvNIX desde Eclipse a trav&eacute;s del
      men&uacute;: <span class="emphasis"><em>File &gt; New &gt; Spring Roo Project</em></span>:</p>

      <div class="figure"><a name="d4e458"></a><div class="figure-contents">
        

        <div class="mediaobject" align="center"><img src="images/eclipse_new_roo_project.png" align="middle" alt="Nuevo proyecto Spring Roo con soporte gvNIX"></div>
      </div><p class="title"><b>Figura 3.3. Nuevo proyecto Spring Roo con soporte gvNIX</b></p></div><br class="figure-break">

      <p>Esta primera pantalla habr&aacute; ejecutado de forma
      autom&aacute;tica el comando de creaci&oacute;n de un nuevo proyecto:</p>

      <pre class="programlisting"><span class="bold"><strong>project --topLevelPackage com.gvnix.tenminutes</strong></span></pre>

      <p>En este punto ya se dispone de un proyecto Maven
      preparado.</p>

      <p>A continuaci&oacute;n, a&ntilde;adir el soporte para el manejo de
      la persistencia de datos a trav&eacute;s de JPA. El siguiente ejemplo muestra
      los comandos que se deben usar para configurar el soporte JPA. Recordar
      que se puede usar Ctrl+Space como ayuda a la escritura en los
      comandos:</p>

      <pre class="programlisting">roo-gvNIX&gt; <span class="bold"><strong>jpa setup --provider HIBERNATE --database HYPERSONIC_IN_MEMORY</strong></span>
Created ...
roo-gvNIX&gt;<span class="bold"><strong> entity jpa --class ~.domain.Timer --testAutomatically</strong></span> 
Created ...
~.domain.Timer roo-gvNIX&gt;<span class="bold"><strong> field string --fieldName message --notNull</strong></span>
Managed ...</pre>

      <p>El comando <span class="bold"><strong>persistence
      setup</strong></span> permite configurar la capa de acceso a datos de manera
      sencilla. El comando <span class="bold"><strong>entitiy</strong></span> sirve para
      crear una nueva entidad y <span class="bold"><strong>field</strong></span> crea
      atributos en la entidad. Estos comandos se ver&aacute;n con m&aacute;s
      detalle en la secci&oacute;n <a class="link" href="#guia-desarrollo-acceso-datos_persistencia-objetos" title="6.1. Persistencia de objetos">Persistencia
      de objetos</a> y <a class="link" href="#guia-desarrollo_gestion-entidades_definicion_crear-con-comando" title="8.1. Crear una entidad con el int&eacute;rprete de comandos">Crear
      una entidad con el int&eacute;rprete de comandos</a>, tambi&eacute;n se ver&aacute; como
      generar todas las entidades de una aplicaci&oacute;n mediante el proceso de
      ingenier&iacute;a inversa contra un esquema de BBDD existente.</p>

      <pre class="programlisting">~.domain.Timer roo-gvNIX&gt; <span class="bold"><strong>web mvc setup</strong></span>
~.domain.Timer roo-gvNIX&gt; <span class="bold"><strong>web mvc all --package ~.web</strong></span>
Created ...</pre>

      <p>Los comandos <span class="bold"><strong>web mvc</strong></span> crean la
      capa capa web que gestionaran la interacci&oacute;n del usuario con la
      aplicaci&oacute;n. Se ver&aacute;n con m&aacute;s detalle en <a class="link" href="#guia-desarrollo_web_definir-controller" title="11.1. Crear la capa web con el int&eacute;rprete de comandos">Crear la capa web con
      el int&eacute;rprete de comandos</a>.</p>

      <pre class="programlisting">~.web roo-gvNIX&gt; <span class="bold"><strong>selenium test --controller ~.web.TimerController</strong></span>
Created ...</pre>

      <p>Si se desea incluir en el proyecto los tests funcionales existe el
      comando <span class="bold"><strong>selenium test</strong></span> que generar&aacute; los
      scripts necesarios para probar la interfaz web de la aplicaci&oacute;n.
      M&aacute;s adelante se ver&aacute; como poner en marcha la aplicaci&oacute;n y como ejecutar
      estos tests.</p>

      <pre class="programlisting">~.web roo-gvNIX&gt; <span class="bold"><strong>theme install --id cit</strong></span>
~.web roo-gvNIX&gt; <span class="bold"><strong>theme set --id cit</strong></span></pre>

      <p>Mediante el comando <span class="bold"><strong>theme</strong></span>, del
      <span class="emphasis"><em>Add-on Theme Manager</em></span> propio de gvNIX, se puede
      configurar el tema visual que presentar&aacute; la aplicaci&oacute;n.</p>
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="d4e495"></a>3.3.2. Importar proyecto gvNIX en Eclipse</h3></div></div></div>
      

      <p>gvNIX/Roo permite crear proyectos desde la linea de comandos, aunque
      puede suceder que se necesite importar un proyecto ya existente en el
      IDE. Si se est&aacute; ejecutando gvNIX en la l&iacute;nea de comandos, bastar&iacute;a con
      ejecutar el comando <span class="command"><strong>perform eclipse</strong></span> para crear una
      estructura de proyecto Eclipse:</p>

      <pre class="programlisting">~.domain.PizzaOrder roo-gvNIX&gt; <span class="command"><strong>perform eclipse</strong></span>
<code class="computeroutput">[Thread-6] Warning: JAVA_HOME environment variable is not set.
[Thread-6] [INFO] Scanning for projects...
[Thread-6] [INFO] ------------------------------------------------------------------------
[Thread-6] [INFO] Building pizzashop
[Thread-6] [INFO]    task-segment: [eclipse:clean, eclipse:eclipse]
[Thread-6] [INFO] ------------------------------------------------------------------------
[Thread-6] [INFO] [eclipse:clean {execution: default-cli}]
[Thread-6] [INFO] Deleting file: .project
[Thread-6] [INFO] Deleting file: .classpath
...
...
[Thread-6] [INFO] ------------------------------------------------------------------------
[Thread-6] [INFO] BUILD SUCCESSFUL
[Thread-6] [INFO] ------------------------------------------------------------------------
[Thread-6] [INFO] Total time: 4 seconds
[Thread-6] [INFO] Finished at: Wed Jun 16 21:21:49 CEST 2010
[Thread-6] [INFO] Final Memory: 36M/330M
[Thread-6] [INFO] ------------------------------------------------------------------------</code>
~.domain.PizzaOrder roo-gvNIX&gt;</pre>

      <p>Este comando termina ejecutando el comando del
      sistema<span class="command"><strong>mvn eclipse:eclipse</strong></span> en el proyecto, por 
      lo que es indiferente el uso de cualquiera de los dos m&eacute;todos.
      Tener en cuenta que este &uacute;ltimo comando necesita tener configurado
      Maven.</p>

      <p>Ahora se puede importar en el entorno de trabajo
      mediante <span class="command"><strong>File &gt; Import &gt; General &gt; Existing Projects
      into workSpace</strong></span>. Si aparece el mensaje <span class="emphasis"><em>Turn Weaving
      Service on?</em></span>, marcar la casilla <span class="emphasis"><em>Don't ask again until
      next upgrade</em></span> y clic en <span class="emphasis"><em>Yes</em></span> (ser&aacute;
      necesario reiniciar Eclipse).</p>

      <p>Tambi&eacute;n es posible borrar la configuraci&oacute;n de
      eclipse ejecutando el comando <span class="command"><strong>mvn eclipse:clean</strong></span>
	  en una consola del sistema que tenga configurada Maven.
      Para regenerar la configuraci&oacute;n de eclipse en un solo comando usar
      <span class="command"><strong>mvn eclipse:clean eclipse:eclipse</strong></span>.</p>

      <p>Al importar un proyecto en Eclipse es importante
      comprobar que dicho proyecto tiene configuradas las caracter&iacute;sticas de
      proyecto Maven y proyecto de aspectos java. Esto aparece de forma visual en el
      proyecto mediante unas peque&ntilde;as letras M y AJ. Si no apareciesen se
      pueden a&ntilde;adir estas caracter&iacute;sticas seleccionando el proyecto y con el
      segundo bot&oacute;n del rat&oacute;n eligiendo la opci&oacute;n <span class="emphasis"><em>Configure
      </em></span>. Esto es muy importante ya que en el caso de no estar
      correctamente configurado nos aparecer&aacute;n falsos errores en el proyecto.
      </p>
    </div>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="guia-desarrollo_eclipse-pruebas-unitarias"></a>3.4. Generaci&oacute;n de pruebas de integraci&oacute;n</h2></div></div></div>
    

    <p>El comando <span class="emphasis"><em>entity</em></span> dispone de la opci&oacute;n testAutomatically
    que al ser especificada generar&aacute; los test de integraci&oacute;n para dicha entidad
    usando JUnit.</p>
    
    <p>Si los tests no fueron creados en el momento de la ejecuci&oacute;n
    del comando <span class="emphasis"><em>entity</em></span>, pueden ser generados con 
    posterioridad mediante otro comando:</p>
    
    <pre class="programlisting">
    test integration --entity ~.domain.Timer
    </pre>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="guia-desarrollo_aplicacion-base_arrancar-aplicacion-eclipse"></a>3.5. Arrancar la aplicaci&oacute;n con Eclipse</h2></div></div></div>
    

    <p>Es posible arrancar la aplicaci&oacute;n desde el propio
    Eclipse y, adem&aacute;s de permitir depurarla, permite hacer cambios en
    caliente sobre la aplicaci&oacute;n.</p>

    <p>Para ello, debemos tener la aplicaci&oacute;n importada en un
    <span class="emphasis"><em>workspace</em></span> de Eclipse y configurar el servidor d&oacute;nde
    ejecutarlo. Eclipse es capaz de gestionar distinto tipos de
    servidores, generando sus propios directorio y ficheros de
    configuraci&oacute;n.</p>

    <p>Para prepara un servidor seguir los siguiente
    pasos:</p>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="guia-desarrollo_aplicacion-base_arrancar-aplicacion-eclipse_mostrar-vista-servidores"></a>3.5.1. Mostrar la Vista de Servidores en Eclipse</h3></div></div></div>
      

      <p>Eclipse tiene una vista que permite ver los distintos servidores
      configurados y gestionarlos desde ah&iacute;. Estos son los pasos para mostrar
      la vista</p>

      <div class="orderedlist"><ol type="1"><li>
          <p>Abra la opci&oacute;n del men&uacute; <code class="literal">Window &gt; Show view &gt;
          Other..</code>..</p>
        </li><li>
          <p>Busque la vista llamada <code class="literal">Servers</code> y pulse el
          bot&oacute;n <code class="literal">Ok</code>.</p>
        </li></ol></div>
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="guia-desarrollo_aplicacion-base_arrancar-aplicacion-eclipse_crear-entorno-ejecucion"></a>3.5.2. Crear un nuevo Servidor</h3></div></div></div>
      

      <p>Se pueden definir m&uacute;ltiples entornos de ejecuci&oacute;n
      para los servidores. Esta configuraci&oacute;n incluye el tipo de servidor
      (Tomcat, Jetty, JBoss, etc..), M&aacute;quina Virtual Java (JRE 1.5, JRE 1.6,
      etc...) y la ruta a los binarios del servidor.</p>

      <p>Cabe destacar que eclipse <span class="bold"><strong>no
      usa la configuraci&oacute;n que exista en la instalaci&oacute;n del
      servidor</strong></span> en la mayor&iacute;a de los casos. Solo usa los ejecutables
      para arrancarlo con ficheros de configuraci&oacute;n que almacena en el propio
      workspace.</p>

      <p>En este caso, vamos a preparar el entorno para
      Tomcat 6 siguiendo los pasos indicados a continuaci&oacute;n:</p>

      <div class="orderedlist"><ol type="1"><li>
          <p>Dentro de la pesta&ntilde;a Servers, pinchar con el
          segundo bot&oacute;n del rat&oacute;n y seleccionar New &gt; Server.</p>
        </li><li>
          <p>Seleccionar <code class="literal">Apache Tomcat
          v6.0 Server</code> de la lista de tipos y pulsar el bot&oacute;n
          <code class="literal">Next</code>.</p>

          <p>En el caso en que no aparezca ning&uacute;n tipo de
          servidor o no aparezcan los de Apache Tomcat se ha de realizar lo
          siguiente:</p>

          <div class="itemizedlist"><ul type="disc"><li>
              <p>Ir a <code class="literal">Help &gt; Install New
              Software...</code>.</p>
            </li><li>
              <p>Desmarcar la casilla "<span class="emphasis"><em>Hide items that are
              already installed.</em></span>"</p>
            </li><li>
              <p>En "<span class="emphasis"><em>Work With</em></span>" seleccionar el sitio
              "<span class="emphasis"><em>Eclipse Web Tools Platform Repository</em></span> -
              <span class="emphasis"><em>http://download.eclipse.org/webtools/updates/</em></span>"
              (si no aparece, a&ntilde;adirlo usando el bot&oacute;n
              <code class="literal">Add...</code>.)</p>
            </li><li>
              <p>En el listado de software desplegar <code class="literal">Web Tools
              Platform Tests (WST Tests)</code> (si hay m&aacute;s de un
              <span class="emphasis"><em>WST Tests</em></span> seleccionar el de la &uacute;ltima
              versi&oacute;n).</p>
            </li><li>
              <p>Instalar (seleccion&aacute;ndolos) <code class="literal">WST Server
              tests</code> y <code class="literal">JST Server Tests</code> (si ya
              est&aacute;n instalado aparecer&aacute; su icono en gris)</p>
            </li></ul></div>
        </li><li>
          <p>Introducir un nombre para la
          configuraci&oacute;n.</p>
        </li><li>
          <p>Seleccionar el directorio donde se encuentra una
          instalaci&oacute;n de Tomcat 6. Si no se dispone de ninguna instalaci&oacute;n de
          Tomcat 6 crear un nuevo directorio, seleccionarlo y pulsar
          sobre el bot&oacute;n Download and Install ... que pasados unos segundos
          terminar&aacute; la descarga y permitir&aacute; continuar.</p>
        </li><li>
          <p>Seleccionar la m&aacute;quina virtual Java con la que
          ejecutar el servidor.</p>
        </li><li>
          <p>Pulsar el bot&oacute;n Next.</p>
        </li><li>
          <p>A&ntilde;adir las aplicaciones a ejecutar en este servidor de entre
          las disponibles.</p>
        </li></ol></div>
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="guia-desarrollo_aplicacion-base_arrancar-aplicacion-eclipse_ajustar-configuracion-server"></a>3.5.3. Ajustar la configuraci&oacute;n del Servidor</h3></div></div></div>
      

      <p>Puede ser necesario ajustar algunas opciones de la
      configuraci&oacute;n del servidor. Para poder acceder a dichas opciones hay que
      seleccionar el servidor desde la pesta&ntilde;a de servidores y, con el bot&oacute;n
      derecho del rat&oacute;n sobre &eacute;l pulsar <code class="literal">Open</code>.</p>

      <p>Desde el panel abierto podremos gestionar:</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>Datos generales del servidor.</p>
        </li><li>
          <p>Opciones de publicaci&oacute;n y seguridad.</p>
        </li><li>
          <p>TimeOuts (muy &uacute;til si se est&aacute; depurando alg&uacute;n proceso de
          arranque).</p>
        </li><li>
          <p>Puertos</p>
        </li><li>
          <p>Configuraci&oacute;n de tipos MIME.</p>
        </li><li>
          <p>Las aplicaciones/modulos a lanzar (admite m&oacute;dulos
          externos).</p>
        </li><li>
          <p>Configuraci&oacute;n de arranque del servidor.</p>

          <p>El servidor Tomcat arranca con cierta cantidad de memoria que
          no soportar mas de 4 cambios en el proyecto antes de llenarse y
          dejar de funcionar. Para evitar esto, se puede incrementar la
          cantidad de memoria con la que arranca Tomcat.</p>

        </li></ul></div>

      <div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Importante</h3>
        <p>Es muy interesante modificar los par&aacute;metros de memor&iacute;a
        con los que trabaja el servidor. Para ello:</p>

        <div class="itemizedlist"><ul type="disc"><li>
            <p>En la pantalla de opciones de la configuraci&oacute;n del 
            servidor acceder a <span class="emphasis"><em>Open launch configuration
            </em></span></p>
          </li><li>
            <p>En la nueva ventana, en la pesta&ntilde;a
            <span class="emphasis"><em>Arguments</em></span> a&ntilde;adir al final del texo que
            aparece en el apartado <span class="emphasis"><em>VM Arguments</em></span> lo
            siguiente: <code class="filename">-Xms64m -Xmx256m -XX:MaxPermSize=128m
            -XX:PermSize=128m</code></p>
          </li></ul></div>
      </div>
      
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="d4e615"></a>3.5.4. Ejecuci&oacute;n de la aplicaci&oacute;n en el Servidor</h3></div></div></div>
      

      <p>Una vez configurado el servidor, se podr&aacute; a&ntilde;adir a
      este la aplicaci&oacute;n que se desea ejecutar en &eacute;l. Se puede ejecutar m&aacute;s de
      una a la vez. En la vista Servers, pulsar con el bot&oacute;n derecho sobre el
      servidor deseado y seleccionar la opci&oacute;n <span class="emphasis"><em>Add and Remove ...
      </em></span>. En el di&aacute;logo que se abre seleccionar de la lista de la 
      izquierda la aplicaci&oacute;n y pulsar el bot&oacute;n <span class="emphasis"><em>Add</em></span>.
      Por &uacute;ltimo, cerrar el di&aacute;logo con <span class="emphasis"><em>Finish</em></span>.</p>

      <div class="figure"><a name="d4e621"></a><div class="figure-contents">
        

        <div class="mediaobject" align="center"><img src="images/eclipse_servers-addremoveapp.png" align="middle" alt="A&ntilde;adir / Eliminar aplicaciones al Servidor"></div>
      </div><p class="title"><b>Figura 3.4. A&ntilde;adir / Eliminar aplicaciones al Servidor</b></p></div><br class="figure-break">

      <p>Ya es posible arrancar el servidor y probar la aplicaci&oacute;n.</p>

      <div class="figure"><a name="d4e627"></a><div class="figure-contents">
        

        <div class="mediaobject" align="center"><img src="images/eclipse_servers.png" align="middle" alt="Vista de servidores disponibles en el workspace de Eclipse"></div>
      </div><p class="title"><b>Figura 3.5. Vista de servidores disponibles en el workspace de
        Eclipse</b></p></div><br class="figure-break">

      <p>En la imagen anterior se observa un servidor Tomcat 6 con la
      aplicaci&oacute;n <span class="emphasis"><em>tenminutes</em></span> disponible para ejecutar. Con
      los botones disponibles se puede arrancar la aplicaci&oacute;n en modo debug,
      arrancar la aplicaci&oacute;n de manera normal (bot&oacute;n verde con tri&aacute;ngulo
      blanco en el centro), arrancar en modo profile, pararlo o re-publicar
      los cambios del proyecto en el servidor.</p>

      <div class="figure"><a name="d4e634"></a><div class="figure-contents">
        

        <div class="mediaobject" align="center"><img src="images/eclipse_servers-buttons.png" align="middle" alt="Botones de la vista servidores de Eclipse"></div>
      </div><p class="title"><b>Figura 3.6. Botones de la vista servidores de Eclipse</b></p></div><br class="figure-break">

      <p>Una vez arrancado el servidor se podr&aacute; navegar por la aplicaci&oacute;n
      bien desde un navegador externo (Firefox) o bien desde un navegador
      propio que incorpora Eclipse accediendo a la direcci&oacute;n 
      <a class="ulink" href="http://localhost:8080/tenminutes" target="_top">
      http://localhost:8080/tenminutes</a>. Observar que el final de la
      direcci&oacute;n se corresponde con el nombre de la aplicaci&oacute;n proporcionado
      al crear el proyecto. Para abrir el navegador interno 
      de Eclipse utilizar <span class="emphasis"><em>Window &gt; Show view &gt; Internal Web
      Browser</em></span>.</p>

      <div class="figure"><a name="d4e642"></a><div class="figure-contents">
        

        <div class="mediaobject" align="center"><img src="images/eclipse_browser.png" align="middle" alt="Navegador interno de Eclipse"></div>
      </div><p class="title"><b>Figura 3.7. Navegador interno de Eclipse</b></p></div><br class="figure-break">

      <p>Ejecutar la apliaci&oacute;n desde Eclipse puede ser muy &uacute;til a la hora
      de hacer cambios en el proyecto, modificaciones en las vistas, en los
      objetos de aplicaci&oacute;n, bien desde el propio IDE o desde la l&iacute;nea de
      comandos de gvNIX, ya que autom&aacute;ticamente se ver&aacute;n reflejados los
      cambios en el navegador.</p>
    </div>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e648"></a>3.6. Trabajando con el c&oacute;digo de la aplicaci&oacute;n en Eclipse</h2></div></div></div>
    

    <p>Al generar un proyecto con gvNIX/Roo habr&aacute; que trabajar sobre el
    c&oacute;digo de la aplicaci&oacute;n para a&ntilde;adir m&aacute;s funcionalidades y/o modificar
    alguna de las que se han generado. A continuaci&oacute;n se explicar&aacute;n un par de
    detalles que simplificaran esta tarea usando Eclipse y el plugin STS
    instalado.</p>

    <div class="figure"><a name="d4e651"></a><div class="figure-contents">
      

      <div class="mediaobject" align="center"><img src="images/eclipse_crossreference.png" align="middle" alt="Vista de editor y Cross References en Eclipse"></div>
    </div><p class="title"><b>Figura 3.8. Vista de editor y Cross References en Eclipse</b></p></div><br class="figure-break">

    <p>En la imagen anterior se observa el editor de Eclipse con el archivo
    Timer.java que se ha generado al ejecutar los comandos
    <span class="emphasis"><em>entity</em></span> y <span class="emphasis"><em>field</em></span> anteriores. En la
    parte derecha de la captura se ve una ventana que muestra informaci&oacute;n de
    la clase Timer. Se trata de la vista <span class="emphasis"><em>Cross Reference</em></span>.
    Si no est&aacute; disponible en la perspectiva de trabajo, se puede incorporar
    desde el men&uacute; <span class="emphasis"><em>Window &gt; Show view &gt; Cross
    References</em></span>. Esta vista es similar a la vista
    <span class="emphasis"><em>Outline</em></span> que muestra los campos y m&eacute;todos declarados
    en una clase.</p>

    <p>La particularidad de la vista Cross References es que muestra los
    campos y m&eacute;todos asociados a la clase Java mediante aspectos java que se ver&aacute;n
    en el C&aacute;pitulo sobre el <a class="link" href="#guia-desarrollo_generacion-codigo" title="Cap&iacute;tulo 7. C&oacute;digo generado por gvNIX/Roo">c&oacute;digo que genera
    gvNIX/Roo</a>.</p>

    <p>Esta informaci&oacute;n tambi&eacute;n est&aacute; disponible desde un men&uacute; contextual
    accesible haciendo click con el bot&oacute;n derecho sobre la flecha que hay a la
    izquierda de la declaraci&oacute;n de la clase. El men&uacute; contextual es el
    siguiente.</p>

    <div class="figure"><a name="d4e665"></a><div class="figure-contents">
      

      <div class="mediaobject" align="center"><img src="images/eclipse_cross-contextual.png" align="middle" alt="Contextual Cross References"></div>
    </div><p class="title"><b>Figura 3.9. Contextual Cross References</b></p></div><br class="figure-break">

    <p>Haciendo click sobre una de las entradas que aparecen en la ventana
    <span class="emphasis"><em>Cross References</em></span> o en el men&uacute; contextual, se abrir&aacute;
    el fichero .aj que tiene declarado ese campo o m&eacute;todo. Por ejemplo, si se
    accede al m&eacute;todo <span class="emphasis"><em>Timer.toString()</em></span> se abrir&aacute; el
    editor con el archivo <span class="emphasis"><em>Timer_Roo_ToString.aj</em></span>.</p>

    <div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Importante</h3>
      <p>Cabe destacar que para que aparezca esta informaci&oacute;n sobre el
      c&oacute;digo asociado a una clase Java mediante aspectos java, la clase debe estar
      libre de errores de compilaci&oacute;n.</p>
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="guia-desarrollo_eclipse-modificar-codigo"></a>3.6.1. Modificaci&oacute;n del c&oacute;digo generado</h3></div></div></div>
      

      <p>Como se ha comentado, seguramente ser&aacute; necesario a&ntilde;adir nuevas
      funcionalidades o modificar algunas de las que se han generado
      autom&aacute;ticamente para adaptar el c&oacute;digo a los requisitos de la
      aplicaci&oacute;n. En estos casos hay que tener en cuenta que <span class="bold"><strong>no se debe hacer ning&uacute;n cambio sobre los aspectos java (ficheros
      aj) asociados a una clase Java</strong></span>. gvNIX/Roo ya nos lo avisa en
      la primera l&iacute;nea del archivo .aj. El motivo de esto es, que teniendo la
      consola gvNIX funcionando, o al arrancar, gvNIX/Roo volver&iacute;a a generar
      el c&oacute;digo autom&aacute;ticamente perdiendo las modificaciones que hubi&eacute;semos
      realizado.</p>

      <div class="figure"><a name="d4e680"></a><div class="figure-contents">
        

        <div class="mediaobject" align="center"><img src="images/eclipse_edicion-aj.png" align="middle" alt="Edici&oacute;n archivo Timer_Roo_ToString.aj"></div>
      </div><p class="title"><b>Figura 3.10. Edici&oacute;n archivo Timer_Roo_ToString.aj</b></p></div><br class="figure-break">

      <p>Para modificar el c&oacute;digo de un m&eacute;todo o la declaraci&oacute;n de un campo
      que se encuentre en un aspecto java, se puede mover el m&eacute;todo o el campo a
      la clase Java, del que depende el aspecto java. En el ejemplo, se mover&iacute;a a
      la clase <span class="emphasis"><em>Timer.java</em></span>. Puede realizarse cortando y
      pegando, pero Eclipse con el plugin STS ofrece una opci&oacute;n mucho m&aacute;s
      adecuada para esto.</p>

      <p>Seleccionando el nombre del m&eacute;todo a mover y a trav&eacute;s del men&uacute;
      contextual <span class="emphasis"><em>AspectJ Refactoring &gt; Push In ...</em></span>
      Eclipse se ocupar&aacute; de eliminar el c&oacute;digo del .aj y moverlo al
      .java.</p>

      <div class="figure"><a name="d4e689"></a><div class="figure-contents">
        

        <div class="mediaobject" align="center"><img src="images/eclipse_pushincontextual.png" align="middle" alt="Men&uacute; contextual AspecJ Refactoring"></div>
      </div><p class="title"><b>Figura 3.11. Men&uacute; contextual AspecJ Refactoring</b></p></div><br class="figure-break">

      <p>Una vez en el .java, se podr&aacute; hacer cuantas modificaciones se
      necesiten sin peligro de que se pierdan por la acci&oacute;n de
      gvNIX/Roo.</p>

      <p>Del mismo modo, si se necesita a&ntilde;adir nuevos m&eacute;todos o campos a la
      clase Java, se debe hacer directamente en el .java.</p>

      <div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Importante</h3>
        <p>Es interesante tener abierta la consola gvNIX para que los
        cambios realizados sobre los ficheros del proyecto disparen los
        cambios autom&aacute;ticos que realiza gvNIX/Roo.</p>
      </div>

    </div>
  </div>
</div>

    <div class="chapter" lang="es"><div class="titlepage"><div><div><h2 class="title"><a name="ejemplos"></a>Cap&iacute;tulo 4. Ejemplos gvNIX/Roo</h2></div></div></div>
  

  <p>En el fichero zip de gvNIX se incluye un directorio
  <code class="filename">samples</code> donde se puede encontrar algunos scripts que
  generan proyectos de aplicaciones de ejemplo.</p>

  <p>Para ejecutarlo puede crearse un nuevo proyecto 
  y ejecutarlo de la siguiente forma:</p>

<pre class="programlisting">
roo-gvNIX&gt; <span class="bold"><strong>script --file SCRIPT.roo</strong></span>
project ...
...
</pre>

  <p>Donde <code class="filename">SCRIPT.roo</code> es el nombre del fichero de
  ejemplo que se desea ejecutar.</p>

  <p>No todos los scripts se pueden ser en el directorio samples, pero
  todos s&iacute; pueden ser ejecutados.</p>

  <div class="variablelist"><dl><dt><span class="term">clinic.roo</span></dt><dd>
        <p>Ejemplo de una aplicaci&oacute;n de clinica veterinaria usando
        Hibernate, Registro Activo y Spring MVC</p>
      </dd><dt><span class="term">bikeshop.roo</span></dt><dd>
        <p>Ejemplo de una aplicaci&oacute;n de tienda de bicicletas usando Eclipse
        Link, DAO y JSF.</p>
      </dd><dt><span class="term">expenses.roo</span></dt><dd>
        <p>Ejemplo de una aplicaci&oacute;n de control de gastos usando Hibernate,
        Registro Activo y GWT.</p>
      </dd><dt><span class="term">multimodule.roo</span></dt><dd>
        <p>Mismo ejemplo que clinic.roo pero separando la aplicaci&oacute;n en
        tres m&oacute;dulos: core, ui y mvc.</p>
      </dd><dt><span class="term">pizzashop.roo</span></dt><dd>
        <p>Ejemplo de una aplicaci&oacute;n de venta de pizzas usando Eclipse
        Link, DAO y ofreciendo acceso remoto con JSON a trav&eacute;s de Spring
        MVC.</p>
      </dd><dt><span class="term">embedding.roo</span></dt><dd>
        <p>Ejemplo de una aplicaci&oacute;n sin persistencia con elementos web
        ricos (documentos, mapas, im&aacute;genes y videos) en Spring MVC.</p>
      </dd><dt><span class="term">vote.roo</span></dt><dd>
        <p>Ejemplo de una aplicaci&oacute;n de voto usando Hibernate, Registro
        Activo, Spring MVC y Seguridad.</p>
      </dd><dt><span class="term">wedding.roo</span></dt><dd>
        <p>Ejemplo de aplicaci&oacute;n con uso de correo electr&oacute;nico.</p>
      </dd><dt><span class="term">report.roo</span></dt><dd>
        <p>Mismo ejemplo que clinic.roo con generaci&oacute;n de informes mediante
        Jasper Reports.</p>
      </dd><dt><span class="term">theme.roo</span></dt><dd>
        <p>Mismo ejemplo que clinic.roo, pero aplicando distinto tema
        visual.</p>
      </dd><dt><span class="term">es-i18n.roo</span></dt><dd>
        <p>Mismo ejemplo que clinic.roo incluyendo la lengua
        Valenciana.</p>
      </dd><dt><span class="term">occ.roo</span></dt><dd>
        <p>Mismo ejemplo que clinic.roo a&ntilde;adiendo control de concurrencia
        sin columnas adicionales en base de datos.</p>
      </dd><dt><span class="term">menu.roo</span></dt><dd>
        <p>Mismo ejemplo que clinic.roo, pero utilizando un sistema de
        men&uacute;s gestionable desde la consola.</p>
      </dd><dt><span class="term">service.roo</span></dt><dd>
        <p>Mismo ejemplo que clinic.roo incluyendo servicios web.</p>
      </dd><dt><span class="term">configuration.roo</span></dt><dd>
        <p>Mismo ejemplo que clinic.roo con dos perfiles de configuraci&oacute;n
        distintos: uno para desarrollo y otro para producci&oacute;n.</p>
      </dd><dt><span class="term">dialog.roo</span></dt><dd>
        <p>Mismo ejemplo que clinic.roo con visualizaci&oacute;n de di&aacute;logos en
        ventana emergente y gesti&oacute;n de excepciones.</p>
      </dd><dt><span class="term">flex.roo</span></dt><dd>
        <p>Ejemplo de una aplicaci&oacute;n de agenda de personas y direcciones
        usando Hibernate, Registro Activo y Flex. El acceso a la aplicaci&oacute;n
        se debe realizar a trav&eacute;s de la siguiente direcci&oacute;n:
        http://localhost:8080/flexrocks/flexrocks_scaffold.html</p>
      </dd><dt><span class="term">binding.roo</span></dt><dd>
        <p>Mismo ejemplo que clinic.roo configurando el guardadi de nulo en
        lugar de cadenas vac&iacute;as en base de datos.</p>
      </dd><dt><span class="term">pattern.roo</span></dt><dd>
        <p>Ejemplo de una aplicaci&oacute;n aplicando distintos patrones de
        visualizaci&oacute;n de la informaci&oacute;n en pantalla de entidades y sus
        relaciones.</p>
      </dd></dl></div>

  <p>La mayor&iacute;a de esto ejemplos utilizan bases de datos en memoria por lo
  que no necesitan configuraci&oacute;n adicional.</p>
</div>
  </div>

  <div class="part" lang="es"><div class="titlepage"><div><div><h1 class="title"><a name="desarrollo"></a>Parte&nbsp;II.&nbsp;Desarrollo de aplicaciones con gvNIX</h1></div></div></div>
    

    <div class="partintro" lang="es"><div></div>
      <p>En esta secci&oacute;n se ver&aacute; paso a paso c&oacute;mo desarrollar
      una aplicaci&oacute;n web desde cero demostrando c&oacute;mo utilizar gvNIX en
      cualquier proyecto web. Algunas de las caracter&iacute;sticas de gvNIX que se
      ver&aacute;n son:</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>Creaci&oacute;n de un nuevo proyecto.</p>
        </li><li>
          <p>Configuraci&oacute;n del acceso a datos.</p>
        </li><li>
          <p>C&oacute;digo genereado autom&aacute;ticamente.</p>
        </li><li>
          <p>Gesti&oacute;n del modelo de entidades.</p>
        </li><li>
          <p>Gesti&oacute;n de la capa web.</p>
        </li></ul></div>
    </div>

    <div class="chapter" lang="es"><div class="titlepage"><div><div><h2 class="title"><a name="guia-desarrollo-crear-app"></a>Cap&iacute;tulo 5. Crear una nueva aplicaci&oacute;n</h2></div></div></div>
  

  <p>El proyecto de ejemplo que se utilizar&aacute; en esta parte
  de la documentaci&oacute;n consiste en una aplicaci&oacute;n web para la venta de pizzas, 
  <span class="bold"><strong>Pizza Shop</strong></span>.</p>

  <p>Requerimientos:</p>

  <div class="itemizedlist"><ul type="disc"><li>
      <p>Los clientes pueden hacer pedidos por la web.</p>
    </li><li>
      <p>Los empleados crean pedidos recibidos por tel&eacute;fono.</p>
    </li><li>
      <p>Las pizzas son un conjunto de ingredientes sobre una base.</p>
    </li></ul></div>

  <p>gvNIX es especialmente potente si usamos los principios
  del <span class="emphasis"><em>dise&ntilde;o dirigido por el dominio</em></span> (DDD). B&aacute;sicamente
  son un conjunto de patrones para construir aplicaciones a partir del modelo
  del dominio. En el &aacute;mbito de gvNIX destacan las siguientes dos 
  caracter&iacute;sticas:</p>

  <div class="itemizedlist"><ul type="disc"><li>
      <p><span class="bold"><strong>Dise&ntilde;o dirigido por el modelo</strong></span>.
      Representar fielmente los conceptos seleccionados del dominio del
      problema, por ejemplo utilizando UML (diagramas de clases).</p>
    </li><li>
      <p><span class="bold"><strong>Arquitectura por capas</strong></span>. Separar
      la l&oacute;gica de negocio de la l&oacute;gica de aplicaci&oacute;n (transacciones,
      seguridad, etc), de la l&oacute;gica de presentaci&oacute;n y de la l&oacute;gica de
      infraestructura (acceso a datos, acceso a servicios externos,
      etc).</p>

      <p>La arquitectura por capas es un patr&oacute;n que gvNIX se encarga de
      aplicar por nosotros, sin embargo, debemos conocer las capas generadas
      por gvNIX porque este conocimiento ser&aacute; de utilidad a la hora de hacer
      nuestros desarrollos.</p>
    </li></ul></div>

  <p>Por tanto, lo primero que se debe hacer es definir el modelo
  del dominio:</p>

  <div class="figure"><a name="d4e824"></a><div class="figure-contents">
    

    <div class="mediaobject" align="center"><img src="images/pizza.png" align="middle" alt="Pizza Shop Domain Model"></div>
  </div><p class="title"><b>Figura 5.1. Pizza Shop Domain Model</b></p></div><br class="figure-break">

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="guia-desarrollo_aplicacion-base_crear-projecto"></a>5.1. Crear un nuevo proyecto</h2></div></div></div>
    

    <p>La creaci&oacute;n de un nuevo proyecto se puede 
    realizar de dos formas, en funci&oacute;n de si se hace desde la consola
    del sistema operativo o desde el IDE. Para ello, leer las secciones
    <a class="link" href="#guia-desarrollo_eclipse-usar" title="3.3.1. Crear proyecto gvNIX en Eclipse IDE">
    Crear proyecto gvNIX en Eclipse IDE</a> para la creaci&oacute;n desde el IDE
    o <a class="link" href="#instalacion_instalacion" title="2.2. Descarga e instalaci&oacute;n de gvNIX">Descarga e instalaci&oacute;n gvNIX
    </a> para la creaci&oacute;n desde la consola del sistema.</p>

    <p>Acceder a la consola y teclear
    <span class="command"><strong>hint</strong></span> para mostrar la informaci&oacute;n del asistente 
    que cambiar&aacute; durante el proceso de desarrollo en funci&oacute;n
    del estado en el que se encuentre el proyecto:</p>

    <pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>hint</strong></span> 
<code class="computeroutput">Welcome to Roo! We hope you enjoy your stay!

Before you can use many features of Roo, you need to start a new project.

To do this, type 'project' (without the quotes) and then hit TAB.

Enter a --topLevelPackage like 'com.mycompany.projectname' (no quotes).
When you've finished completing your --topLevelPackage, press ENTER.
Your new project will then be created in the current working directory.

Note that Roo frequently allows the use of TAB, so press TAB regularly.
Once your project is created, type 'hint' and ENTER for the next suggestion.
You're also welcome to visit http://forum.springframework.org for Roo help.</code></pre>

    <p>Muestra las instrucciones para continuar y crear
    un proyecto. El proyecto ya estar&aacute; creado si se hizo desde la consola
    del IDE y se podr&aacute; pasar a la siguiente secci&oacute;n, en caso contrario teclear
    <span class="command"><strong>project</strong></span>. Pulsar la tecla TAB (tabulador) para que se 
    muestre el par&aacute;metro <em class="parameter"><code>--topLevelPackage</code></em> y definir el 
    paquete principal del proyecto, en este caso
    <span class="package">com.springsource.roo.pizzashop</span>. Tambi&eacute;n se puede
    indicar el JDK con el que se va a trabajar en el proyecto a&ntilde;adiendo el atributo
    <em class="parameter"><code>--java 6</code></em>, el n&uacute;mero 6 corresponde a la versi&oacute;n del
    JDK utilizado, en este caso JDK 1.6, si no se especifica Roo por defecto
    utiliza el JDK 1.6</p>

    <pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>project --topLevelPackage com.springsource.roo.pizzashop</strong></span>
<code class="computeroutput">Created ROOT/pom.xml
Created SRC_MAIN_RESOURCES
Created SRC_MAIN_RESOURCES/log4j.properties
Created SPRING_CONFIG_ROOT
Created SPRING_CONFIG_ROOT/applicationContext.xml</code></pre>

    <p>Una vez creado el proyecto observar que el foco
    de la consola ha cambiado, ahora se encuentra apuntando al paquete base del
    proyecto que se ha indicado al crearlo:</p>

    <pre class="programlisting">com.springsource.roo.pizzashop roo-gvNIX&gt;</pre>

    <p>Por otro lado, la estructura de directorios creada
    esta basada en las recomendaciones de Maven.</p>

    <div class="figure"><a name="d4e850"></a><div class="figure-contents">
      

      <div class="mediaobject" align="center"><img src="images/projectfolders.png" align="middle" alt="Estructura de carpetas"></div>
    </div><p class="title"><b>Figura 5.2. Estructura de carpetas</b></p></div><br class="figure-break">
  </div>
</div>

    <div class="chapter" lang="es"><div class="titlepage"><div><div><h2 class="title"><a name="guia-desarrollo-acceso-datos"></a>Cap&iacute;tulo 6. Gesti&oacute;n del acceso a datos</h2></div></div></div>
  

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="guia-desarrollo-acceso-datos_persistencia-objetos"></a>6.1. Persistencia de objetos</h2></div></div></div>
    

    <p>Trabajar en un entorno orientado a objetos con acceso
    a fuentes de datos relacionales (lo habitual en tecnolog&iacute;a Java) puede
    suponer un incremento de los tiempos de desarrollo porque se debe incluir
    la l&oacute;gica necesaria para hacer corresponder el modelo relacional de la
    base de datos, que trata con relaciones y conjuntos, con el paradigma
    orientado a objetos de las entidades del proyecto, que trata con objetos,
    atributos y asociaciones de unos con otros. Esta problem&aacute;tica es la que se
    conoce como <span class="emphasis"><em>desajuste objeto-relacional</em></span>
    (object-relational impedance mismatch).</p>

    <p>La t&eacute;cnica y herramientas <span class="emphasis"><em>ORM</em></span>
    (Object-Relational Mapping) surgen para reducir el coste de desarrollo que
    supone el desajuste objeto-relacional. Las t&eacute;cnicas de ORM permiten
    automatizar procesos que trasladan objetos a formas almacenables en tablas
    y viceversa, preservando los atributos de los objetos. Para esto se basan
    en la utilizaci&oacute;n de metadatos de correspondencia que especifican la
    informaci&oacute;n necesaria para que se pueda efectuar de forma autom&aacute;tica la
    conversi&oacute;n de datos entre el sistema relacional y el sistema orientado a
    objetos.</p>

    <p>Esta t&eacute;cnica supuso que empezaran a aparecer multitud
    de librer&iacute;as y herramientas ORM para Java. Para estandarizar esta t&eacute;cnica
    en el mundo Java y hacer nuestras aplicaciones independientes de la
    herramienta surgi&oacute; JPA (Java Persistence API), actualmente en su versi&oacute;n 2
    (<a class="ulink" href="http://jcp.org/en/jsr/detail?id=317" target="_top">JSR
    317</a>).</p>

    <p>gvNIX (herencia del n&uacute;cleo Spring Roo) fundamenta su
    interacci&oacute;n con la base de datos en un sistema de persistencia
    <span class="emphasis"><em>JPA 2</em></span>. Gracias a esto las aplicaciones desarrolladas
    con gvNIX se benefician de las mejoras de tiempos de desarrollo que
    aportan la t&eacute;cnica y herramientas ORM.</p>

    <p>Regresando a la creaci&oacute;n del nuevo proyecto, el primer
    paso es instalar y configurar el sistema de persistencia. Teclear
    <span class="command"><strong>hint</strong></span> que sugerir&aacute; los siguientes pasos a
    dar:</p>

    <pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>hint</strong></span>
Roo requires the installation of a persistence configuration,
for example, JPA or MongoDB.

For JPA, type 'jpa setup' and then hit TAB three times.
We suggest you type 'H' then TAB to complete "HIBERNATE".
After the --provider, press TAB twice for database choices.
For testing purposes, type (or TAB) HYPERSONIC_IN_MEMORY.
If you press TAB again, you'll see there are no more options.
As such, you're ready to press ENTER to execute the command.

Once JPA is installed, type 'hint' and ENTER for the next suggestion.

Similarly, for MongoDB persistence, type 'mongo setup' and ENTER.

roo-gvNIX&gt;</pre>

    <p>En el &aacute;mbito de esta documentaci&oacute;n es suficiente con
    conectar la aplicaci&oacute;n con una base de datos que no necesita ning&uacute;n 
    servidor instalado como Hypersonic e Hibernate como implementaci&oacute;n del
    sistema de persistencia:</p>

    <pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>jpa setup --provider HIBERNATE --database HYPERSONIC_PERSISTENT</strong></span>
Created SPRING_CONFIG_ROOT/database.properties
Updated SPRING_CONFIG_ROOT/applicationContext.xml
Created SRC_MAIN_RESOURCES/META-INF/persistence.xml
Updated ROOT/pom.xml [added dependencies org.hsqldb:hsqldb:1.8.0.10,
org.hibernate:hibernate-core:3.6.9.Final,
org.hibernate:hibernate-entitymanager:3.6.9.Final,
org.hibernate.javax.persistence:hibernate-jpa-2.0-api:1.0.1.Final,
commons-collections:commons-collections:3.2.1,
org.hibernate:hibernate-validator:4.2.0.Final,
javax.validation:validation-api:1.0.0.GA, cglib:cglib-nodep:2.2.2,
javax.transaction:jta:1.1,
org.springframework:spring-jdbc:${spring.version},
org.springframework:spring-orm:${spring.version},
commons-pool:commons-pool:1.5.6, commons-dbcp:commons-dbcp:1.3]
roo-gvNIX&gt;</pre>

    <div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Aviso</h3>
      <p>Este tipo de bases de datos no es la mejor opci&oacute;n
      para un entorno de producci&oacute;n, utilizarla s&oacute;lo para entornos de
      desarrollo, demostraciones y formaci&oacute;n.</p>
    </div>

    <div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Aviso</h3>
      <p>Con la ingenier&iacute;a directa, es decir, la creaci&oacute;n
      de entidades y campos mediante los comandos de la consola, se configura
      el sistema de persistencia para crear la base de datos cada vez 
      que se arranca la aplicaci&oacute;n. Por eso, los datos de la demo se perder&aacute;n cada
      vez que se inicie la aplicaci&oacute;n. Esto no es as&iacute; cuando se utiliza la
      ingenier&iacute;a inversa a partir de un esquema de base de datos ya
      existente.</p>

      <p>Este comportamiento se puede cambiar en la 
      configuraci&oacute;n del sistema de persistencia:
      <code class="filename">src/main/resources/META-INF/persistence.xml</code>.
      Consultar la secci&oacute;n <a class="link" href="#guia-desarrollo_gestion-entidades_enlazar-base-datos-existente_regeneracion-bbdd" title="8.5.6. Regeneraci&oacute;n de la Base de datos en cada arranque.">enlazar
      base de datos existente</a> para aprender c&oacute;mo cambiar el
      comportamiento por defecto.</p>
    </div>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="guia-desarrollo_gestion-acceso-datos"></a>6.2. Configurar la conexi&oacute;n con la base de datos</h2></div></div></div>
    

    <p>En cualquier punto del ciclo de vida de una aplicaci&oacute;n
    puede surgir la necesidad de cambiar de base de datos (distinta tecnolog&iacute;a
    de bases de datos, cambio de la clave de acceso, cambio del equipo donde
    se encuentra la base de datos, etc), para estos casos gvNIX ofrece una
    serie de comandos que simplificar&aacute;n la actualizaci&oacute;n de la configuraci&oacute;n
    de acceso a la base de datos:</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p><span class="command"><strong>jpa setup</strong></span></p>
      </li><li>
        <p><span class="command"><strong>database properties</strong></span></p>
      </li></ul></div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="d4e891"></a>6.2.1. jpa setup</h3></div></div></div>
      

      <p>Crea o actualiza la configuraci&oacute;n del acceso a datos
      (base de datos y el proveedor de persistencia o ORM). Entre los par&aacute;metros
      requeridos est&aacute;n la herramienta ORM y la base de datos a utilizar.</p>

      <p>Los par&aacute;metros obligatorios que requiere este comando son:</p>

      <div class="variablelist"><dl><dt><span class="term">--provider</span></dt><dd>
            <p>Identificador de la herramienta ORM. Los
            valores posibles son:</p>

            <div class="variablelist"><dl><dt><span class="term">DATANUCLEUS</span></dt><dd>
                  <p><a class="ulink" href="http://www.datanucleus.org/" target="_top">Data
                  Nucleus</a></p>
                </dd><dt><span class="term">ECLIPSELINK</span></dt><dd>
                  <p><a class="ulink" href="http://www.eclipse.org/eclipselink/" target="_top">EclipseLink</a></p>
                </dd><dt><span class="term">HIBERNATE</span></dt><dd>
                  <p><a class="ulink" href="http://www.hibernate.org/" target="_top">Hibernate</a></p>
                </dd><dt><span class="term">OPENJPA</span></dt><dd>
                  <p><a class="ulink" href="http://openjpa.apache.org/" target="_top">OpenJPA</a></p>
                </dd></dl></div>
          </dd><dt><span class="term">--database</span></dt><dd>
            <p>Identificador de la base de datos. Los valores
            posibles son:</p>

            <div class="itemizedlist"><ul type="disc"><li>
                <p>ORACLE<span class="emphasis"><em>. Debido a que los drivers JDBC no est&aacute;n
                disponibles en ning&uacute;n repositorio Maven, en caso de utilizar
                Oracle habr&aacute; que instalar manualmente el driver
                JDBC.</em></span></p>
              </li><li>
                <p>MSSQL.</p>
              </li><li>
                <p>MYSQL.</p>
              </li><li>
                <p>POSTGRES.</p>
              </li><li>
                <p>SYBASE.</p>
              </li><li>
                <p>DB2<span class="emphasis"><em>. Debido a que los drivers JDBC no est&aacute;n
                disponibles en ning&uacute;n repositorio Maven, en caso de utilizar
                DB2 habr&aacute; que instalar manualmente el driver
                JDBC.</em></span></p>
              </li><li>
                <p>DERBY.</p>
              </li><li>
                <p>GOOGLE_APP_ENGINE.</p>
              </li><li>
                <p>H2_IN_MEMORY.</p>
              </li><li>
                <p>HYPERSONIC_IN_MEMORY.</p>
              </li><li>
                <p>HYPERSONIC_PERSISTENT.</p>
              </li><li>
                <p>FIREBIRD.</p>
              </li><li>
                <p>DATABASE_DOT_COM.</p>
              </li></ul></div>
          </dd></dl></div>
      
      <div class="variablelist"><p>Los par&aacute;metros opcionales que permite este comando son:</p><dl><dt><span class="term">--applicationId</span></dt><dd>
            <p>Identificaci&oacute;n de aplicaci&oacute;n en Google App
            Engine (s&oacute;lo utilizado para esta base de datos).</p>
          </dd><dt><span class="term">--databaseName</span></dt><dd>
            <p>Nombre de la base de datos con la que conectar.
            </p>
          </dd><dt><span class="term">--hostName</span></dt><dd>
            <p>El nombre DNS o la direcci&oacute;n IP del ordenador en el que se
            encuentra la base de datos a utilizar.</p>
          </dd><dt><span class="term">--jndiDataSource</span></dt><dd>
            <p>Fuente de datos JNDI a utilizar.</p>
          </dd><dt><span class="term">--password</span></dt><dd>
            <p>Contrase&ntilde;a del usuario para la conexi&oacute;n
            con la base de datos.</p>
          </dd><dt><span class="term">--persistenceUnit</span></dt><dd>
            <p>Nombre de la unidad de persistencia a utilizar en el fichero
            persistence.xml.</p>
          </dd><dt><span class="term">--transactionManager</span></dt><dd>
            <p>Nombre del gestor de transacciones a utilizar.</p>
          </dd><dt><span class="term">--userName</span></dt><dd>
            <p>Nombre del usuario para la conexi&oacute;n
            con la base de datos.</p>
          </dd></dl></div>

      <p>Dependiendo del tipo de base de datos pueden ser
      necesarios unos u otros par&aacute;metros. Se recomienda usar el completado
      de comandos con <span class="emphasis"><em>TAB</em></span> (en la consola del sistema)
      o <span class="emphasis"><em>CTRL+SPACE</em></span> (en el IDE)
      para que se indique lo que hace falta en funci&oacute;n del
      contexto. Cuando el autocompletado no proporciona m&aacute;s opciones para
      un comando, se recomienda escribir los caracteres
      <span class="emphasis"><em>--</em></span> e ir auto completando para que aparezcan
      los par&aacute;metros opcionales.</p>
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="d4e992"></a>6.2.2. database properties</h3></div></div></div>
      

      <p>Permite la consulta, eliminaci&oacute;n, actualizaci&oacute;n y
      creaci&oacute;n de las propiedades de conexi&oacute;n con la base de datos (a diferencia
      del comando anterior que configura el sistema de persitencia en su
      totalidad). Estas propiedades se almacenan el fichero
      <code class="filename">src/main/resources/META-INF/spring/database.properties</code>
      de la aplicaci&oacute;n.</p>

      <p>Se dispone del siguiente grupo de comandos:</p>

      <div class="variablelist"><dl><dt><span class="term">database properties list</span></dt><dd>
            <p>Lista las propiedades de conexi&oacute;n con la
            base de datos.</p>
          </dd><dt><span class="term">database properties remove</span></dt><dd>
            <p>Elimina una propiedad de la configuraci&oacute;n.
            Requiere un &uacute;nico par&aacute;metro <em class="parameter"><code>--key</code></em> para
            especificar la clave a eliminar.</p>
          </dd><dt><span class="term">database properties set</span></dt><dd>
            <p>Crea o actualiza una propiedad en la
            configuraci&oacute;n. Requiere un par&aacute;metro <em class="parameter"><code>--key</code></em>
            con el nombre de la propiedad y un <em class="parameter"><code>--value</code></em>
            con el valor a establecer.</p>
          </dd></dl></div>
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="d4e1013"></a>6.2.3. Ejemplo: Conectar con PostgreSQL</h3></div></div></div>
      

      <p>En este ejemplo se va a configurar la conexi&oacute;n a un
      servidor PostgreSQL situado en una m&aacute;quina en de la red local. Los datos de
      conexi&oacute;n de ejemplo son:</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>Servidor de base de datos:
          <code class="literal">dbserver</code></p>
        </li><li>
          <p>Puerto de conexi&oacute;n:
          <code class="literal">5438</code></p>
        </li><li>
          <p>Nombre de la base de datos: <code class="literal">my_db</code></p>
        </li><li>
          <p>Nombre de usuario de la base de datos:
          <code class="literal">user1</code></p>
        </li><li>
          <p>Contrase&ntilde;a del usuario:
          <code class="literal">1234</code></p>
        </li></ul></div>

      <p>Recordar que estos comando se pueden
      ejecutar en cualquier momento y tantas veces como se desee.</p>

      <p>Los pasos a seguir para la configuraci&oacute;n son:</p>

      <div class="orderedlist"><ol type="1"><li>
          <p>Usar el comando <span class="command"><strong>persistence
          setup</strong></span> con los par&aacute;metros que disponemos:</p>

          <pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>jpa setup --provider HIBERNATE --database POSTGRES --databaseName my_db
          			 --userName user1 --password 1234 --hostName dbserver</strong></span>
Created SPRING_CONFIG_ROOT/database.properties
Please update your database details in 
 src/main/resources/META-INF/spring/database.properties.
Updated SPRING_CONFIG_ROOT/applicationContext.xml
Created SRC_MAIN_RESOURCES/META-INF/persistence.xml
Updated ROOT/pom.xml [added dependencies postgresql:postgresql:9.1-901.jdbc3,
org.hibernate:hibernate-core:3.6.9.Final,
org.hibernate:hibernate-entitymanager:3.6.9.Final,
org.hibernate.javax.persistence:hibernate-jpa-2.0-api:1.0.1.Final,
commons-collections:commons-collections:3.2.1,
org.hibernate:hibernate-validator:4.2.0.Final,
javax.validation:validation-api:1.0.0.GA, cglib:cglib-nodep:2.2.2,
javax.transaction:jta:1.1,
org.springframework:spring-jdbc:${spring.version}, 
org.springframework:spring-orm:${spring.version}, commons-pool:commons-pool:1.5.6,
commons-dbcp:commons-dbcp:1.3]
roo-gvNIX&gt; </pre>
        </li><li>
          <p>Comprobar como ha quedado la configuraci&oacute;n de la
          conexi&oacute;n. Para ello usar el comando <span class="command"><strong>database properties
          list</strong></span>:</p>

          <pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>database properties list</strong></span>
database.driverClassName = org.postgresql.Driver
database.password = 1234
database.url = jdbc:postgresql://dbserver:5432/my_db
database.username = user1
roo-gvNIX&gt; </pre>

          <p>Observar que lo &uacute;nico que falta es configurar el
          puerto de la base de datos en la propiedad
          <code class="literal">database.url</code>. Observar que el puerto
          configurado autom&aacute;ticamente es el puerto por defecto de la base de
          datos, sin embargo en este ejemplo el servidor de base de datos
          utiliza uno distinto.</p>
        </li><li>
          <p>Configurar la URL de conexi&oacute;n al servidor
          correctamente usando el comando <span class="command"><strong>database properties
          set</strong></span>:</p>

          <pre class="programlisting">
roo-gvNIX&gt; <span class="command"><strong>database properties set --key database.url --value 
				jdbc:postgresql://dbserver:5438/my_db </strong></span>
Updated SPRING_CONFIG_ROOT/database.properties
roo-gvNIX&gt; </pre>
        </li><li>
          <p>Volver a comprobar el estado de los par&aacute;metros
          con el comando <span class="command"><strong>database properties list</strong></span>:</p>

          <pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>database properties list</strong></span>
database.driverClassName = org.postgresql.Driver
database.password = 1234
database.url = jdbc:postgresql://dbserver:5438/my_db
database.username = user1
roo-gvNIX&gt; </pre>
        </li></ol></div>

      <p>Una vez hecho, la siguiente vez que se arranque la
      aplicaci&oacute;n usar&aacute; la nueva conexi&oacute;n de base de datos configurada.</p>
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="guia-desarrollo_acceso-datos_actualizacion-esquema"></a>6.2.4. Actualizaci&oacute;n autom&aacute;tica del esquema</h3></div></div></div>
      

      <p>Al crear las entidades y los campos desde la consola
      mediante los comandos de ingenier&iacute;a directa, en el arranque de la 
	  aplicaci&oacute;n se crea autom&aacute;ticamente el esquema de base
	  de datos que se corresponde con el modelo de entidades. 
      Esto no es as&iacute; cuando se realiza la ingenier&iacute;a inversa a partir
      de un esquema de base de datos ya existente.</p>

      <p><span class="emphasis"><em>Si se desea cambiar este
      comportamiento para, por ejemplo, que los datos almacenados
      no desaparezca en cada arranque seguir los siguientes pasos</em></span>:</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>Editar el archivo
          <code class="filename">src/main/resources/META-INF/persistence.xml</code></p>
        </li><li>
          <p>Cambiar el valor de la propiedad
          <span class="emphasis"><em>hibernate.hbm2ddl.auto</em></span>:</p>

          <p>Existen cinco valores <span class="emphasis"><em>validate, update, create,
          create-drop y none</em></span>. Estos valores deben utilizarse
          con precauci&ntilde;&oacute;n por el peligr" puede suponer para
          la integridad de la BBDD.</p>

          <div class="itemizedlist"><ul type="circle"><li>
              <p><span class="emphasis"><em>validate</em></span>: valida que el modelo de objetos
              y el modelo relacional de base de datos son equivalentes. En caso
              de no ser iguales no se permitir&aacute; el arranque de la aplicaci&oacute;n.</p>
            </li><li>
              <p><span class="emphasis"><em>update</em></span>: actualiza el esquema al
              arrancar la aplicaci&oacute;n. Esto es, modificar&aacute; los elementos del modelo
              relacional de base de datos que no se correspondan con el modelo
              de objetos.</p>
            </li><li>
              <p><span class="emphasis"><em>create</em></span>: crea el esquema en el arranque
              de la aplicaci&oacute;n destruyendo la informaci&oacute;n existente.</p>
            </li><li>
              <p><span class="emphasis"><em>create-drop</em></span>: hace un
              <span class="emphasis"><em>drop</em></span> de las tablas al parar la
              aplicaci&oacute;n y en el arranque las crea.</p>
            </li><li>
              <p>none: no hace absolutamente ninguna validaci&oacute;n ni
              modificaci&oacute;n del esquema.</p>
            </li></ul></div>
        </li></ul></div>
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="guia-desarrollo_gestion-acceso-datos_multiples-fuentes-datos"></a>6.2.5. M&uacute;ltiples fuentes de datos</h3></div></div></div>
      

      <p>La conexi&oacute;n con distintas bases de datos est&aacute; soportada, aunque su
      configuraci&oacute;n no se genera autom&aacute;ticamente. Distinguir de la conexi&oacute;n
      con distintos esquemas de la misma base de datos que est&aacute; tanto soportado
      como contemplado por la generaci&oacute;n autom&aacute;tica que realiza la ingenier&iacute;a
      inversa.</p>
      
      <p>A continuaci&oacute;n se muestran los pasos a seguir para configurar la
      conexi&oacute;n con distintas bases de datos en una misma aplicaci&oacute;n mediante el
      proveedor de persistencia Hibernate:</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>En <span class="emphasis"><em>src/main/resources/META-INF/persistence.xml</em></span>
          incluir la siguiente configuraci&oacute;n reemplazando los puntos suspensivos por
          los valores adecuados para la nueva conexi&oacute;n de base de datos:</p>
          
          <pre class="programlisting">
		    &lt;persistence-unit name="persistenceUnit2" transaction-type="RESOURCE_LOCAL"&gt;
		        &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;
		        &lt;properties&gt;
		            &lt;property name="hibernate.dialect" value="..."/&gt;
		            &lt;property name="hibernate.hbm2ddl.auto" value="..."/&gt;
		            &lt;property name="hibernate.ejb.naming_strategy" value="..."/&gt;
		            &lt;property name="hibernate.connection.charSet" value="..."/&gt;
		        &lt;/properties&gt;
		    &lt;/persistence-unit&gt;
		  </pre>
        </li><li>
          <p>En <span class="emphasis"><em>src/main/resources/META-INF/spring/applicationContext.xml</em></span>
          incluir la siguiente configuraci&oacute;n reemplazando los puntos suspensivos por
          los valores adecuados para la nueva conexi&oacute;n de base de datos:</p>
          
          <pre class="programlisting">
		    &lt;bean class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close" 
		    		id="dataSource2"&gt;
		        &lt;property name="driverClassName" value="..."/&gt;
		        &lt;property name="url" value="..."/&gt;
		        &lt;property name="username" value="..."/&gt;
		        &lt;property name="password" value="..."/&gt;
		        &lt;property name="testOnBorrow" value="..."/&gt;
		        &lt;property name="testOnReturn" value="..."/&gt;
		        &lt;property name="testWhileIdle" value="..."/&gt;
		        &lt;property name="timeBetweenEvictionRunsMillis" value="..."/&gt;
		        &lt;property name="numTestsPerEvictionRun" value="..."/&gt;
		        &lt;property name="minEvictableIdleTimeMillis" value="..."/&gt;
		        &lt;property name="validationQuery" value="..."/&gt;
		 	&lt;/bean&gt;
		    &lt;bean class="org.springframework.orm.jpa.JpaTransactionManager" 
		    		id="transactionManager2"&gt;
		        &lt;property name="entityManagerFactory" ref="entityManagerFactory2"/&gt;
		    &lt;/bean&gt;
		    &lt;tx:annotation-driven mode="aspectj" transaction-manager="transactionManager2"/&gt;
		    &lt;bean class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean" 
		    		id="entityManagerFactory2"&gt;
		        &lt;property name="persistenceUnitName" value="persistenceUnit2" /&gt;
		        &lt;property name="dataSource" ref="dataSource2"/&gt;
		    &lt;/bean&gt;
		  </pre>
        </li><li>
          <p>En la clase Java de la entidad, por ejemplo,
          <span class="emphasis"><em>src/main/java/.../domain/Entidad.java</em></span> hacer un push-in de
          la propiedad <span class="emphasis"><em>entityManager</em></span> y a&ntilde;adirle la siguiente
          anotaci&oacute;n haciendo referencia a la nueva conexi&oacute;n configurada:</p>
          
          <pre class="programlisting">
		    @PersistenceContext(unitName="persistenceUnit2")
		    transient EntityManager entityManager;
		  </pre>
		  
		  <p>De esta forma, para cada entidad de datos se
		  puede asociar la conexi&oacute;n de base de datos que se desee.</p>
		</li></ul></div>

    </div>
  </div>
</div>

    <div class="chapter" lang="es"><div class="titlepage"><div><div><h2 class="title"><a name="guia-desarrollo_generacion-codigo"></a>Cap&iacute;tulo 7. C&oacute;digo generado por gvNIX/Roo</h2></div></div></div>
  

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e1109"></a>7.1. Clases Java y ficheros AJ</h2></div></div></div>
    

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="d4e1111"></a>7.1.1. Archivos Java</h3></div></div></div>
      

      <p>Por lo general, la norma que sigue gvNIX/Roo es mantener la clase
      Java, el archivo .java, lo m&aacute;s sencillo posible y por ello, muchas
      veces, nos podemos encontrar con que el archivo .java est&aacute; pr&aacute;cticamente vacio.
      Contiene poco m&aacute;s que la declaraci&oacute;n de la clase y anotaciones asociadas
      a la misma. El resto del c&oacute;digo, campos y m&eacute;todos se declaran en sus
      aspectos java de los que vamos a hablar a continuaci&oacute;n.</p>
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="d4e1114"></a>7.1.2. Archivos AJ</h3></div></div></div>
      

      <p>Asociados a una clase java aparecen ciertos ficheros con nombre
      *_Roo_*.aj y *_gvNIX_*aj. Se trata de aspectos java que no son m&aacute;s que porciones de c&oacute;digo
      que al compilar el proyecto, se asocian como c&oacute;digo de la propia clase
      Java a la que est&aacute;n vinculadas.</p>
    </div>
  </div>
</div>

    <div class="chapter" lang="es"><div class="titlepage"><div><div><h2 class="title"><a name="guia-desarrollo_gestion-entidades"></a>Cap&iacute;tulo 8. Gesti&oacute;n de entidades</h2></div></div></div>
  

	<p>El acceso a datos de una aplicaci&oacute;n contiene la infraestructura necesaria para obtener y
	almacenar la informaci&oacute;n en, por ejemplo, una base de datos.
	Este acceso se puede estructurar en una sola capa en la que las entidades definen tanto
	el modelo de los datos, como sus m&eacute;todos de interacci&oacute;n con la base de datos y la l&oacute;gica
	de negocio utilizando entonces un modelo llamado <span class="emphasis"><em>Registro Activo</em></span>. 
	Existen otros casos m&aacute;s cl&aacute;sicos como la estructuraci&oacute;n en una capa de entidades, otra
	de acceso a datos (DAO) y una &uacute;ltima de servicios con la l&oacute;gica de negocio; todo ello 
	llamado <span class="emphasis"><em>Servicios y Repositorios</em></span>.
	Este cap&iacute;tulo se centrar&aacute; en la generaci&oacute;n de la capa de entidades ya que es el m&eacute;todo
	que se utiliza habitualmente en las aplicaciones desarrolladas con gvNIX y para el cual
	ha a&ntilde;adido la mayor&iacute;a de sus nuevas funcionalidades.
	</p>


  <p>Las entidades del modelo del dominio son uno de los
  elementos m&aacute;s importantes del framework. En Java una entidad se corresponde con una clase,
  definida en un archivo <code class="filename">.java</code>.</p>

  <p>Adem&aacute;s de la l&oacute;gica de negocio, cada clase contiene una serie de
  anotaciones de clase y de atributos que forman parte de la metainformaci&oacute;n
  que permite a gvNIX realizar acciones autom&aacute;ticas.</p>

  <div class="example"><a name="d4e1125"></a><p class="title"><b>Ejemplo 8.1. Una clase Java</b></p><div class="example-contents">
    

    <div class="programlistingco"><pre class="programlisting">                                                                                         <span class="co" id="ex.annot.class">(1)</span>
@RooJavaBean
@RooToString
@RooJpaActiveRecord
public class Entity1 {

        @Size(max = 20)                                                                  <span class="co" id="ex.annot.attri">(2)</span>
        @NotNull
        private String name;

        @Size(max = 20)
        private String apellidos;
}</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p>(1)</p></td><td valign="top" align="left">
          <p>Anotaci&oacute;n de clase</p>
        </td></tr><tr><td width="5%" valign="top" align="left"><p>(2)</p></td><td valign="top" align="left">
          <p>Anotaci&oacute;n de atributo</p>
        </td></tr></table></div></div>
  </div></div><br class="example-break">

  <p>El framework a&ntilde;adir&aacute; todos los m&eacute;todos est&aacute;ndar necesarios para
  completar la definici&oacute;n de entidad, como los de persistencia (almacenamiento
  y recuperaci&oacute;n), gets/sets y m&eacute;todos auxiliares como toString.
  Como se vi&oacute; en la secci&oacute;n de generaci&oacute;n de c&oacute;digo se
  crear&aacute;n una serie de archivos <code class="filename">.aj</code> que en tiempo de
  compilaci&oacute;n se incluyen en la clase de forma transparente.</p>

  <p>Si por alg&uacute;n motivo es necesario <span class="emphasis"><em>personalizar
  el comportamiento</em></span> de alguno de los <span class="emphasis"><em>m&eacute;todos est&aacute;ndar que
  se generan</em></span>, simplemente hay que <span class="emphasis"><em>definirlos en la
  clase java</em></span>. Cuando el framework detecta el cambio actualiza el
  fichero <code class="filename">aj</code> correspondiente para eliminar esta
  definici&oacute;n.</p>

  <p>Existen dos formas de crear una entidad:</p>

  <div class="orderedlist"><ol type="1"><li>
      <p>Usando el int&eacute;rprete de comandos.</p>
    </li><li>
      <p>Usando el IDE de desarrollo.</p>
    </li></ol></div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="guia-desarrollo_gestion-entidades_definicion_crear-con-comando"></a>8.1. Crear una entidad con el int&eacute;rprete de
    comandos</h2></div></div></div>
    

    <p>Desde el int&eacute;rprete de comandos se puede crear
    entidades de forma sencilla con los comandos: <span class="command"><strong>entity</strong></span> y
    <span class="command"><strong>field</strong></span>.</p>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="guia-desarrollo_gestion-entidades_definicion_crear-con-comando_entity"></a>8.1.1. Comando entity</h3></div></div></div>
      

      <p>Este comando crea una nueva entidad en el
      proyecto. Requiere como m&iacute;nimo definir el par&aacute;metro
      <em class="parameter"><code>--class</code></em> para especificar el nombre y el paquete
      de la nueva clase. En este par&aacute;metro se puede utilizar el car&aacute;cter
      <code class="literal">~</code> como abreviatura del paquete base del
      proyecto.</p>

      <p>Entre los par&aacute;metros obligatorios se encuentran
      :</p>

      <div class="variablelist"><dl><dt><span class="term">--class</span></dt><dd>
            <p>Nombre de la clase java para la entidad
            (incluido su paquete) (recordar que se puede usar el
            <code class="literal">~</code> para especificar el paquete base de la
            aplicaci&oacute;n).</p>
          </dd></dl></div>

      <p>Entre los principales par&aacute;metros opcionales 
      (notar que hay m&aacute;s) se encuentran:</p>

      <div class="variablelist"><dl><dt><span class="term">--activeRecord</span></dt><dd>
            <p>Generar los m&eacute;todos de creaci&oacute;n, 
            lectura, actualizaci&oacute;n y borrado (CRUD) para esta
            entidad. Esto implica el uso de un patr&oacute;n de entidades
            del tipo registro activo.</p>
          </dd><dt><span class="term">--entityName</span></dt><dd>
            <p>Nombre a usar para la
            entidad. Diferenciar del par&aacute;metro <span class="emphasis"><em>tabla
            </em></span> que define el nombre de su tabla asociada.
            </p>
          </dd><dt><span class="term">--identifierType</span></dt><dd>
            <p>Permite definir el tipo (clase java) de
            identificador (clave primaria) que usar&aacute; esta entidad.</p>
          </dd><dt><span class="term">--identifierField</span></dt><dd>
            <p>Nombre del <span class="emphasis"><em>campo en la
            entidad</em></span> (no en BBDD) que se usar&aacute; para el
            identificador.</p>
          </dd><dt><span class="term">--identifierColumn</span></dt><dd>
            <p>Nombre de la <span class="emphasis"><em>columna de la
            BBDD</em></span> donde almacenar el valor de clave primaria.</p>
          </dd><dt><span class="term">--persistenceUnit</span></dt><dd>
            <p>Unidad de persistencia a utilizar
            para gestionar la interacci&oacute;n de la entidad con la
            base de datos. Como cada unidad de persistencia puede
            estar asociada a una base de datos distinta, es la forma
            de definir que una entidad se encuentra almacenada en
            otra base de datos.</p>
          </dd><dt><span class="term">--schema</span></dt><dd>
            <p>Esquema de base de datos donde
            se encontrar&aacute; la tabla asociada con la entidad.</p>
          </dd><dt><span class="term">--table</span></dt><dd>
            <p>Nombre de la <span class="emphasis"><em>tabla de la
            BBDD</em></span> donde almacenar los datos para esta
            entidad.</p>
          </dd><dt><span class="term">--testAutomatically</span></dt><dd>
            <p>Genera los test unitarios para esta entidad
            usando JUnit.</p>
          </dd><dt><span class="term">--versionColumn</span></dt><dd>
            <p>Nombre de la columna en base de datos
            que se comporta como campo de control de concurrencia
            optimista basado en n&uacute;mero de versi&oacute;n.</p>
          </dd><dt><span class="term">--versionType</span></dt><dd>
            <p>Tipo de la columna de base de datos
            que se comporta como campo de control de concurrencia
            optimista basado en n&uacute;mero de versi&oacute;n.</p>
          </dd></dl></div>

      <p>El resto de las opciones podemos verlas con el
      autocompletado del comando escribiendo <span class="emphasis"><em>--</em></span>, 
      en la documentaci&oacute;n oficial de Roo o 
      usando el comando <span class="command"><strong>help entity</strong></span>.</p>

      <div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Eliminar y modificar entidades</h3>
        

        <p>La consola no se utiliza para eliminar o modificar
        las entidades. Esto se debe realizar usando el IDE. Para m&aacute;s
        informaci&oacute;n ver la secci&oacute;n <a class="link" href="#guia-desarrollo_gestion-entidades_definicion_modificar-modelo" title="8.3. Modificar una entidad">Modificar
        una entidad</a>.</p>
      </div>
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="guia-desarrollo_gestion-entidades_definicion_crear-con-comando_field"></a>8.1.2. Comando field</h3></div></div></div>
      

      <p>No existe un comando <span class="command"><strong>field</strong></span>
      propiamente dicho, sino que es el nombre de un grupo de comandos que permiten
      a&ntilde;adir campos a una entidad. Los comandos finales se forman con el formato
      <span class="command"><strong>field {tipo}</strong></span> donde <em class="parameter"><code>{tipo}</code></em> es
      el tipo de dato que va almacenar. As&iacute; tenemos los siguientes:</p>

      <div class="variablelist"><dl><dt><span class="term">field string</span></dt><dd>
            <p>Crea un campo de tipo cadena
            alfanum&eacute;rica.</p>
          </dd><dt><span class="term">field boolean</span></dt><dd>
            <p>Crea un campo de tipo booleano
            (valores cierto o falso).</p>
          </dd><dt><span class="term">field date</span></dt><dd>
            <p>Crea un campo de tipo fecha.</p>
          </dd><dt><span class="term">field email template</span></dt><dd>
            <p>Crea un campo con una plantilla preparada para almacenar
            direcciones de correo electr&oacute;nico.</p>
          </dd><dt><span class="term">field embedded</span></dt><dd>
            <p>A&ntilde;ade un campo del tipo <span class="emphasis"><em>@Embedded</em></span>
            </p>
          </dd><dt><span class="term">field enum</span></dt><dd>
            <p>Crea un campo de tipo enumerado. El tipo enumerado
            debe haber sido creado previamente con el comando 
            <span class="emphasis"><em>enum type</em></span>.</p>
          </dd><dt><span class="term">field file</span></dt><dd>
            <p>Crea un campo de tipo fichero.</p>
          </dd><dt><span class="term">field number</span></dt><dd>
            <p>Crea un campo de tipo num&eacute;rico (es posible especificarle el
            tipo mediante el par&aacute;metro <em class="parameter"><code>--type</code></em>).</p>
          </dd><dt><span class="term">field reference</span></dt><dd>
            <p>Crea un campo que ser&aacute; una referencia a otra entidad.</p>
          </dd><dt><span class="term">field set</span></dt><dd>
            <p>Crea un campo que devolver&aacute; una lista de elementos de una
            entidad relacionados con este elemento.</p>
          </dd><dt><span class="term">field other</span></dt><dd>
            <p>Crea un campo de otro tipo no registrado.</p>
          </dd></dl></div>

      <p>Cada uno de estos comandos admiten bastantes par&aacute;metros que
      permiten definir m&uacute;ltiples comportamientos especiales, algunos aplicables a todos los comandos 
      y otros espec&iacute;ficos solo para algunos de ellos. Entre los generales que aplicar
      a la mayor&iacute;a podemos encontrar los siguientes:</p>

      <div class="variablelist"><dl><dt><span class="term">--class</span></dt><dd>
            <p>Clase entidad dondecrear el campo.
            Admite el uso de <code class="literal">~</code> para identificar al 
            paquete base del proyecto y tiene autocompletado. No es
            necesario de especificar si acabamos de crear una entidad.</p>
          </dd><dt><span class="term">--column</span></dt><dd>
            <p>Nombre de la columna en BBDD donde se
            almacenar&aacute; el valor.</p>
          </dd><dt><span class="term">--fieldName</span></dt><dd>
            <p>Nombre del campo que vamos a generar.</p>
          </dd><dt><span class="term">--notNull y --nullRequired</span></dt><dd>
            <p>Especifica el comportamiento de campo ante
            los valores nulos.</p>
          </dd><dt><span class="term">--regexp</span></dt><dd>
            <p>Permite definir una expresi&oacute;n regular
            que debe cumplir el valor que se establezca en este campo.</p>
          </dd><dt><span class="term">--sizeMax y --sizeMin</span></dt><dd>
            <p>Limitaciones de tama&ntilde;o.</p>
          </dd><dt><span class="term">--transient</span></dt><dd>
            <p>Indica que el campo no tiene asociada
            ninguna columna en la base de datos, es decir, no se almacena
            ni obtiene de ella.</p>
          </dd><dt><span class="term">--unique</span></dt><dd>
            <p>Indica que el campo tiene la restricci&oacute;n
            de unicidad para los valores que puede almacenar.</p>
          </dd></dl></div>

      <p>Existen m&aacute;s opciones dependiendo del tipo de dato,
      para m&aacute;s informaci&oacute;n ver la ayuda de la consola o acceder a la documentaci&oacute;n
      oficial de Roo en 
      <a class="ulink" href="http://static.springsource.org/spring-roo/reference/html/" target="_top">
      http://static.springsource.org/spring-roo/reference/html/</a></p>

      <div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Enlazar modelo de entidades con base de datos
        existente</h3>
        

        <p>Notar que el par&aacute;metro <span class="command"><strong>--column</strong></span>
        permiten que en tiempo de creaci&oacute;n podemos indicar que la entidad sea
        persistente sobre un modelo relacional creado con anterioridad.</p>
      </div>

      <div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Eliminar y modificar campos</h3>
        

        <p>No se pueden eliminar o modificar los campos desde
        l&iacute;nea de comandos. Esto se debe realizar usando el IDE. Para m&aacute;s
        informaci&oacute;n ver la secci&oacute;n <a class="link" href="#guia-desarrollo_gestion-entidades_definicion_modificar-modelo" title="8.3. Modificar una entidad">Modificar
        una entidad</a>.</p>
      </div>
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="guia-desarrollo_gestion-entidades_definicion_crear-con-comando_field_ejemplos"></a>8.1.3. Proyecto ejemplo</h3></div></div></div>
      

      <p>Crear el modelo de dominio de la aplicaci&oacute;n
      de venta de pizzas con la siguiente secuencia de comandos
      a partir del mismo ejemplo iniciado en cap&iacute;tulos anteriores:</p>

      <div class="orderedlist"><ol type="1"><li>
          <p>Topping:</p>

          <pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>entity jpa --class ~.domain.Topping --testAutomatically</strong></span>
~.domain.Topping roo-gvNIX&gt; <span class="command"><strong>field string --fieldName name --notNull --sizeMin 2</strong></span>
                </pre>
        </li><li>
          <p>Base:</p>

          <pre class="programlisting">~.domain.Topping roo-gvNIX&gt; <span class="command"><strong>entity jpa --class ~.domain.Base --testAutomatically</strong></span>
~.domain.Base roo-gvNIX&gt; <span class="command"><strong>field string --fieldName name --notNull --sizeMin 2</strong></span>
                </pre>
        </li><li>
          <p>Pizza:</p>

          <pre class="programlisting">~.domain.Base roo-gvNIX&gt; <span class="command"><strong>entity jpa --class ~.domain.Pizza --testAutomatically</strong></span>
~.domain.Pizza roo-gvNIX&gt; <span class="command"><strong>field string --fieldName name --notNull --sizeMin 2 
		--comment "Nombre de la pizza" --column pizza_nombre --regexp [A-Za-z0-9].*</strong></span>
~.domain.Pizza roo-gvNIX&gt; <span class="command"><strong>field number --fieldName price --type java.lang.Float</strong></span>
~.domain.Pizza roo-gvNIX&gt; <span class="command"><strong>field set --fieldName toppings --type ~.domain.Topping</strong></span>
~.domain.Pizza roo-gvNIX&gt; <span class="command"><strong>field reference --fieldName base --type ~.domain.Base</strong></span>
                </pre>

          <p>Esta secuencia de comandos genera la siguiente
          clase Java:</p>

          <div class="programlistingco"><pre class="programlisting">
@RooJavaBean
@RooToString
@RooJpaActiveRecord
public class Pizza {

    @NotNull
    @Column(name = "pizza_nombre")
    @Size(min = 2)
    @Pattern(regexp = "[A-Za-z0-9].*")                                                   <span class="co" id="ex.regexp">(1)</span>
    private String name;

    private Float price;

    @ManyToMany(cascade = CascadeType.ALL)
    private Set&lt;Topping&gt; toppings =                                                      <span class="co" id="ex.set">(2)</span>
      new HashSet&lt;Topping&gt;();

    @ManyToOne(targetEntity = Base.class)
    @JoinColumn
    private Base base;                                                                   <span class="co" id="ex.entity">(3)</span>
}</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p>(1)</p></td><td valign="top" align="left">
                <p>Validaci&oacute;n del texto</p>
              </td></tr><tr><td width="5%" valign="top" align="left"><p>(2)</p></td><td valign="top" align="left">
                <p>Asociaci&oacute;n con un conjunto de
                entidades</p>
              </td></tr><tr><td width="5%" valign="top" align="left"><p>(3)</p></td><td valign="top" align="left">
                <p>Asociaci&oacute;n con otra entidad</p>
              </td></tr></table></div></div>
        </li><li>
          <p>PizzaOrder:</p>

          <pre class="programlisting">~.domain.Pizza roo-gvNIX&gt;<span class="command"><strong>entity jpa --class ~.domain.PizzaOrder --testAutomatically</strong></span>
~.domain.PizzaOrder roo-gvNIX&gt;<span class="command"><strong>field string --fieldName name --notNull --sizeMin 2</strong></span>
~.domain.PizzaOrder roo-gvNIX&gt;<span class="command"><strong>field string --fieldName address --notNull --sizeMax 30</strong></span>
~.domain.PizzaOrder roo-gvNIX&gt;<span class="command"><strong>field number --fieldName total --type java.lang.Float</strong></span>
~.domain.PizzaOrder roo-gvNIX&gt;<span class="command"><strong>field date --fieldName deliveryDate --type java.util.Date</strong></span>
~.domain.PizzaOrder roo-gvNIX&gt;<span class="command"><strong>field set --fieldName pizzas --type ~.domain.Pizza</strong></span>
                </pre>
        </li></ol></div>

      <p>En este punto, se ha completado la versi&oacute;n inicial del modelo del
      dominio</p>
    </div>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="guia-desarrollo_gestion-entidades_definicion_crear-a-mano"></a>8.2. Crear una entidad con un IDE</h2></div></div></div>
    

    <p>Como se ha visto en el punto anterior, el c&oacute;digo Java
    generado no tiene ning&uacute;n elemento particular del framework, por lo que crear
    el modelo del dominio con cualquier IDE consiste en codificar las
    clases Java con las anotaciones que permiten a la consola monitorizar y generar
    el c&oacute;digo.</p>

    <p>Es importante destacar que el objetivo de utilizar anotaciones
    es permitir que el proyecto se pueda gestionar codificando las clases
    con cualquier IDE. Entonces al arrancar la consola se generar&aacute; toda la 
    infraestructura necesaria para la persistencia, validaci&oacute;n, etc</p>

    <p>Entre las anotaciones que se pueden utilizar en la
    codificaci&oacute;n del modelo de entidades, se pueden destacar:</p>

    <div class="variablelist"><dl><dt><span class="term">@RooJavaBean</span></dt><dd>
          <p>Anotaci&oacute;n que implica la generaci&oacute;n de los
          getter/setter que falten para acceder/modificar los valores de
          las propiedades. Si alguno ya estuviese generado, no se
          volver&aacute; a generar.</p>
        </dd><dt><span class="term">@RooToString</span></dt><dd>
          <p>Anotaci&oacute;n que implica la generaci&oacute;n del
          m&eacute;todo <code class="methodname">toString()</code> para esta
          clase. Este m&eacute;todo se genera a partir de las propiedades de la
          clase.</p>
        </dd><dt><span class="term">@RooJpaActiveRecord</span></dt><dd>
          <p>Anotaci&oacute;n que identifica esta clase como
          persistente, es decir, la marca como una entidad. Esta anotaci&oacute;n
          genera todos lo m&eacute;todos de persistencia necesarios
          para crear, leer, actualizar y borrar (CRUD) la
          entidad siguiendo un patr&oacute;n de registro activo.</p>
        </dd></dl></div>

    <div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Importante</h3>
      <p>Notar que para usar las anotaciones hay que importar sus
      clases:</p>

<pre class="programlisting">import org.springframework.roo.addon.javabean.RooJavaBean;
import org.springframework.roo.addon.jpa.activerecord.RooJpaActiveRecord;
import org.springframework.roo.addon.tostring.RooToString;</pre>
    </div>

    <p>Consultar la <a class="ulink" href="http://static.springsource.org/spring-roo/reference/html/" target="_top">
    documentaci&oacute;n oficial de Roo</a> 
    para un detalle exhaustivo de las anotaciones.</p>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="guia-desarrollo_gestion-entidades_definicion_modificar-modelo"></a>8.3. Modificar una entidad</h2></div></div></div>
    

    <p>Si se desea a&ntilde;adir un atributo a una entidad existente
    puede hacerse desde la consola. Cuando se crea o modifica una entidad,
    la consola se situa en el contexto de dicha entidad.
    Por eso en el ejemplo anterior, al a&ntilde;adir campos tras crear
    la entidad PizzaOrder, no es necesario especificar en
    cada comando la entidad sobre la que se est&aacute;n incluyendo.</p>

    <div class="variablelist"><dl><dt><span class="term">A&ntilde;adir un atributo</span></dt><dd>
          <p>Para a&ntilde;adir un nuevo campo deberemos usar el
          mismo comando <span class="bold"><strong>field</strong></span> indicando sobre
          que entidad queremos trabajar mediante el par&aacute;metro
          <span class="emphasis"><em>--class.</em></span></p><pre class="programlisting"><span class="command"><strong>field string --fieldName refCode --notNull --sizeMin 2 --class ~.domain.Pizza</strong></span>
~.domain.Pizza roo-gvNIX&gt; </pre><p>Notar que tras ejecutar el
          comando <span class="emphasis"><em>field</em></span> indicando el par&aacute;metro
          <span class="emphasis"><em>--class</em></span> la consola cambia al contexto de la
          entidad Pizza y por tanto si se sigue ejecutando el comando field
          sin indicar <span class="emphasis"><em>--class</em></span> los campos se a&ntilde;adir&aacute;n a
          esta entidad.</p>

          <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Nota</h3>
            <p>Es posible situarse en el contexto de una entidad (o
            de cualquier clase del proyecto) mediante el comando <span class="bold"><strong>focus</strong></span> indicando el par&aacute;metro
            <span class="emphasis"><em>--class</em></span>.</p>

            <pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>focus --class ~.domain.PizzaOrder</strong></span>
~.domain.PizzaOrder roo-gvNIX&gt;</pre>
          </div>
        </dd></dl></div>

    <p>A diferencia de la creaci&oacute;n de entidades, la
    modificaci&oacute;n del modelo del dominio debe realizarse modificando
    la clase Java de la entidad, por ejemplo, mediante un IDE de 
    desarrollo.</p>

    <div class="variablelist"><dl><dt><span class="term">Eliminar una entidad</span></dt><dd>
          <p>Borrar el fichero <code class="filename">.java</code> de
          que define la entidad y autom&aacute;ticamente se detectar&aacute; el cambio y se
          eliminar&aacute;n todos los elementos relacionados: ficheros
          <code class="filename">{entidad}_*.aj</code>, controladores asociados,
          elementos de men&uacute;, etc.</p>
        </dd><dt><span class="term">Eliminar un atributo</span></dt><dd>
          <p>Borrar el atributo de la clase Java y todos los
          componentes relacionados <code class="filename">{entidad}_*.aj</code>
          ser&aacute;n actualizados autom&aacute;ticamente.</p>
        </dd><dt><span class="term">Modificar un atributo</span></dt><dd>
          <p>Modificar el atributo deseado en la clase Java y
          se actualizar&aacute;n todos los ficheros <code class="filename">{entidad}_*.aj</code>
          relacionados para contemplar los cambios.</p>
        </dd></dl></div>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="guia-desarrollo_gestion-entidades_definicion_identificadores-compuestos"></a>8.4. Identificadores compuestos</h2></div></div></div>
    

    <p>En el caso de necesitar que alguna de las entidades tenga
    definida una clave primaria compuesta de varios campos se debe hacer de
    la siguiente forma.</p>

    <pre class="programlisting"><span class="command"><strong>entity jpa --class ~.domain.Entity --identifierType ~.domain.EntityPK</strong></span></pre>

    <p>De esta forma se genera una clase <span class="emphasis"><em>EntityPK</em></span>
    sobre la que definir los campos que conformar&aacute;n el identificador compuesto y
    que se corresponder&aacute;n en el modelo relacional de base de datos con una clave primaria compuesta.
    La entidad usar&aacute; la la clase que representa la clave compuesta, en el ejemplo:
    <span class="emphasis"><em>Entity</em></span>.</p>

    <pre class="programlisting"><span class="command"><strong>field number --fieldName campo1 --type java.lang.Long</strong></span>
...
<span class="command"><strong>field string --fieldName campo2</strong></span>
...</pre>

    <p>Se obtendr&aacute; una entidad en la que el tipo del campo identificador es
    un objeto con distintos campos. Este mecanismo es el mismo que se emplea
    al realizar la <a class="link" href="#guia-desarrollo_entidades-dbre_clave_compuesta" title="8.6.4.2. Claves primarias compuestas">ingenier&iacute;a
    inversa</a> de una BBDD en el caso de que se encuentre una estructura
    de este tipo, es decir, una clave primaria compuesta.</p>

    <p>Otra forma de hacer lo mismo ser&iacute;a definir primero la clase que
    servir&aacute; de identificador (en el ejemplo <span class="emphasis"><em>EntityPK</em></span>) y
    luego definir la entidad indicando que el identificador es del tipo de la
    clase que hemos creado previamente.</p>

    <pre class="programlisting"><span class="command"><strong>embeddable --class ~.domain.Entity2PK</strong></span>
...
<span class="command"><strong>field number --fieldName campo1 --type java.lang.Long</strong></span>
...
<span class="command"><strong>field string --fieldName campo2</strong></span>
...
<span class="command"><strong>entity jpa --class ~.domain.Entity2 --identifierType ~.domain.EntityPK2</strong></span>
...
</pre>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="guia-desarrollo_gestion-entidades_enlazar-base-datos-existente"></a>8.5. Definir caracter&iacute;sticas espec&iacute;ficas para el modelo relacional</h2></div></div></div>
    

    <p>Una vez construido el modelo de entidades de la aplicaci&oacute;n
    mediante ingenier&iacute;a directa, tal y como se ha visto hasta ahora, al arrancar la aplicaci&oacute;n
    se crear&aacute; autom&aacute;ticamente el modelo relacional de base de datos a partir del modelo de entidades.
    Puede ocurrir que se desee que el modelo relacional de base de datos tenga
    algunas caracter&iacute;sticas espec&iacute;ficas, en estos casos se pueden modificar las clases Java y
    plasmar las caracter&iacute;sticas espec&iacute;ficas deseadas. Observar que todas las caracter&iacute;sticas
    espec&iacute;ficas que se van a adaptar modificando la clase Java de las entidades pueden ser definidas
    en la definici&oacute;n inicial realizada con los comandos <span class="emphasis"><em>entity</em></span> y
    <span class="emphasis"><em>field</em></span>.</p>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="guia-desarrollo_gestion-entidades_enlazar-base-datos-existente_tablas"></a>8.5.1. Definir un nombre de tabla</h3></div></div></div>
      

      <p>Con la anotaci&oacute;n de clase 
      <code class="classname">@RooJpaActiveRecord(..., table = "table_name")</code>
      se puede definir el nombre de la tabla donde se guardar&aacute; la informaci&oacute;n
      asociada con la entidad.</p>

      <div class="example"><a name="d4e1461"></a><p class="title"><b>Ejemplo 8.2. Uso de la anotaci&oacute;n</b></p><div class="example-contents">
        

        <pre class="programlisting">
@RooJavaBean
@RooToString
@RooJpaActiveRecord(table = "entity_1")
public class Entity1 {

    private String field1;
}</pre>
      </div></div><br class="example-break">
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="guia-desarrollo_gestion-entidades_enlazar-base-datos-existente_columnas"></a>8.5.2. Definir un nombre de columna</h3></div></div></div>
      

      <p>Existen varias anotaciones que permiten definir la correspondencia
      entre atributos de una entidad y las columnas de la tabla.</p>

      <p>Las m&aacute;s importantes son:</p>

      <div class="variablelist"><dl><dt><span class="term"><code class="classname"><a class="ulink" href="http://docs.oracle.com/javaee/6/docs/api/javax/persistence/Column.html" target="_top">@Column</a></code></span></dt><dd>
            <p>Indica el nombre de la columna de la base de datos en donde se almacenar&aacute; el
            valor del atributo. Si se omite esta anotaci&oacute;n se aplicar&aacute; una convenci&oacute;n 
            por la que el nombre de la columna ser&aacute; el mismo que el del atributo de la clase.</p>
          </dd><dt><span class="term"><code class="classname"><a class="ulink" href="http://docs.oracle.com/javaee/6/docs/api/javax/persistence/Transient.html" target="_top">@Transient</a></code></span></dt><dd>
            <p>Indica que el atributo de la clase Java no tiene
            representaci&oacute;n en la tabla (no ser&aacute; cargado ni almacenado).</p>
          </dd><dt><span class="term"><code class="classname"><a class="ulink" href="http://docs.oracle.com/javaee/6/docs/api/javax/persistence/JoinColumn.html" target="_top">@JoinColumn</a></code>,
          <code class="classname"><a class="ulink" href="http://docs.oracle.com/javaee/6/docs/api/javax/persistence/JoinColumns.html" target="_top">@JoinColumns</a></code>,
          <code class="classname"><a class="ulink" href="http://docs.oracle.com/javaee/6/docs/api/javax/persistence/OneToOne.html" target="_top">@OneToOne</a></code>,
          <code class="classname"><a class="ulink" href="http://docs.oracle.com/javaee/6/docs/api/javax/persistence/ManyToOne.html" target="_top">@ManyToOne</a></code></span></dt><dd>
            <p>Define la correspondencia de una asociaci&oacute;n
            <span class="emphasis"><em>N-1.</em></span></p>
          </dd><dt><span class="term"><code class="classname"><a class="ulink" href="http://docs.oracle.com/javaee/6/docs/api/javax/persistence/JoinTable.html" target="_top">@JoinTable</a></code>,
          <code class="classname"><a class="ulink" href="http://docs.oracle.com/javaee/6/docs/api/javax/persistence/OneToMany.html" target="_top">@OneToMany</a></code>,
          <code class="classname"><a class="ulink" href="http://docs.oracle.com/javaee/6/docs/api/javax/persistence/ManyToMany.html" target="_top">@ManyToMany</a></code>,
          <code class="classname"><a class="ulink" href="http://docs.oracle.com/javaee/6/docs/api/javax/persistence/OrderBy.html" target="_top">@OrderBy</a></code></span></dt><dd>
            <p>Define la correspondencia de una asociaci&oacute;n
            <span class="emphasis"><em>1-N</em></span> o <span class="emphasis"><em>N-M.</em></span></p>
          </dd></dl></div>

      <div class="example"><a name="d4e1508"></a><p class="title"><b>Ejemplo 8.3. Uso de las anotaciones</b></p><div class="example-contents">
        

        <div class="programlistingco"><pre class="programlisting">
@RooJavaBean
@RooToString
@RooJpaActiveRecord(name = "ENT1")
public class Entity1 {

    private String field1;
                                                                                         <span class="co" id="ex.annot.field">(1)</span>
    @Transient
    private String tmpInfo;
                                                                                         <span class="co" id="ex.annot.trans">(2)</span>
    @Column(name="ORDER_COST", precision=12, scale=2)
    private BigDecimal cost;                                                             <span class="co" id="ex.annot.preci">(3)</span>

    @ManyToOne(targetEntity = Customer.class)
    @JoinColumn(name = "CUSTOMER_ID")                                                    <span class="co" id="ex.annot.many">(4)</span>
    private Customer customer;                                                           <span class="co" id="ex.annot.join">(5)</span>

    @OneToMany(cascade = CascadeType.ALL, mappedBy = "entity1")
    private Set&lt;Price&gt; prices = new java.util.HashSet&lt;Price&gt;();                          <span class="co" id="ex.annot.one">(6)</span>
}</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p>(1)</p></td><td valign="top" align="left">
              <p>Este campo se cargar&aacute; y almacenar&aacute; en la columna
              <code class="literal">field1</code> de la tabla
              <code class="literal">ENT1</code></p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p>(2)</p></td><td valign="top" align="left">
              <p>Este campo no se tendr&aacute; en cuenta en la carga y guardado
              de la base de datos.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p>(3)</p></td><td valign="top" align="left">
              <p>Este campo num&eacute;rico se cargar&aacute; y almacenar&aacute; en la columna
              <code class="literal">ORDER_COST</code> de la tabla
              <code class="literal">ENT1</code>, usando los valores de
              <span class="emphasis"><em>precisi&oacute;n</em></span> y <span class="emphasis"><em>escala</em></span>
              especificados.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p>(4)</p></td><td valign="top" align="left">
              <p>Declara que la propiedad tiene origen en una relaci&oacute;n
              <span class="emphasis"><em>n-1</em></span>, con la entidad
              <code class="classname">Customer</code>. La tabla relacionada y sus
              columnas se obtendr&aacute;n de las declaraciones que se hayan hecho en
              dicha entidad.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p>(5)</p></td><td valign="top" align="left">
              <p>Especifica que la columna de clave ajena en la tabla
              <code class="literal">ENT1</code> para esta relaci&oacute;n (con
              <code class="classname">Customer</code>) es
              <code class="literal">CUSTOMER_ID</code></p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p>(6)</p></td><td valign="top" align="left">
              <p>Declara que el campo <code class="literal">prices</code> es una
              relaci&oacute;n <span class="emphasis"><em>1-n</em></span> con la entidad
              <code class="literal">Price</code>. Tambi&eacute;n declara que los cambios
              (actualizaci&oacute;n, borrado, creaci&oacute;n, ...) de
              <code class="literal">Entity1</code> se aplican en cascada sobre
              <code class="literal">Price</code>. El campo (propiedad en la clase java)
              que estable la clave ajena en <code class="literal">Price</code> se llama
              <code class="literal">entity1</code>.</p>
            </td></tr></table></div></div>
      </div></div><br class="example-break">
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="d4e1550"></a>8.5.3. Campos calculados</h3></div></div></div>
      

      <p>Los campos <span class="emphasis"><em>@Transient</em></span> son de utildad cuando
      necesitamos que en el Objeto de la entidad se almacene o se calcule
      alg&uacute;n dato y que este no se tenga en cuenta al guardar (sentencias
      insert o update) la instancia en la BBDD. Por ejemplo, una entidad
      Persona puede tener la siguiente declaraci&oacute;n de campos:</p>

      <pre class="programlisting">public class Persona {

    private String name;
    private String lastName;

    <span class="bold"><strong>@Transient</strong></span>
    private String fullName;
}</pre>

      <p>Con esta declaraci&oacute;n existe la posibildad de guardar
      temporalemente en el campo <span class="emphasis"><em>fullName</em></span> la
      concatenaci&oacute;n de <span class="emphasis"><em>name</em></span> y
      <span class="emphasis"><em>lastName</em></span>, por motivos de simplicidad, y sin tener
      que modificar la estructura de la tabla de la BBDD para ello.</p>

      <p>Usando Hibernate como proveedor de persistencia, existe
      una anotaci&oacute;n que puede ser &uacute;til para que un registro dado se calcule de manera autom&aacute;tica
      haciendo una cosulta sobre la BBDD. Se trata de la anotaci&oacute;n
      <span class="emphasis"><em>org.hibernate.annotations.Formula</em></span>.</p>

      <p><span class="emphasis"><em>@Formula</em></span> tiene como atributo una cadena que
      se usa como sentencia HQL. Esta se ejecuta cada vez que se carga el
      registro de la BBDD y el resultado se almacena en el campo con esta
      anotaci&oacute;n. Siguiendo con el ejemplo anterior, se podr&iacute;a tener lo siguiente:</p>

      <pre class="programlisting">public class Persona {

    private String name;
    private String lastName;

    <span class="bold"><strong>@Formula("(SELECT name || ' ' || lastName from persona)")</strong></span>
    private String fullName;
}</pre>

      <p>En el ejemplo cuando se carga una instancia de la entidad persona
      se ejecutar&aacute; la consulta definida y en el campo fullName estar&aacute;
      disponible el resultado de la consulta. La cosulta puede ser tan
      compleja como sea necesario, incluso incluir subconsultas. El campo
      anotado con <span class="emphasis"><em>@Formula</em></span> es tratado como solo
      lectura y, por tanto, no se tendr&aacute; en cuenta en las operaciones de
      escritura de la BBDD.</p>

      <p>Otra forma de calcular valores, sin el uso de campos de la BBDD,
      consiste en declarar un m&eacute;todo en la entidad que realice las operaciones
      necesarias para devolver el valor calculado. De esta forma, se podr&aacute;
      acceder al c&aacute;lculo sin tener que declarar un campo (con sus respectivos
      get/set).</p>
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="guia-desarrollo_gestion-entidades_enlazar-base-datos-existente_clave-primaria"></a>8.5.4. Clave primaria</h3></div></div></div>
      

      <p>Por defecto, una clave primaria se representa en la clase java
      como una propiedad con nombre <span class="emphasis"><em>id</em></span>
      y tipo <code class="classname">java.lang.Long</code>.
      A continuaci&oacute;n se muestra un ejemplo de c&oacute;mo se pueden cambiar distintas
      caracter&iacute;sticas.</p>

      <p>Modificar la anotaci&oacute;n @RooJpaActiveRecord
      para ajustar el nombre y el tipo de la columna que hace
      de clave primaria en la tabla o el nombre de la propiedad
      identificadora en la clase.</p>

      <div class="example"><a name="d4e1575"></a><p class="title"><b>Ejemplo 8.4. Uso de las anotaciones</b></p><div class="example-contents">
        

        <pre class="programlisting">
@RooJavaBean
@RooToString
@RooJpaActiveRecord(identifierField="ent1Id", 
        identifierType=Long.class, identifierColumn="ENT_ID")
public class Entity1 {

    private String field1;

}</pre>
      </div></div><br class="example-break">
      
       <p>Observar que todas estas caracter&iacute;sticas se pueden
       especificar en el momento de la creaci&oacute;n de la entidad
       mediante el comando <span class="emphasis"><em>entity</em></span>.</p>

       <p>Si se utiliza Hibernate como proveedor ORM, usar&aacute; la
       secuencia <span class="emphasis"><em>hibernate_sequence</em></span> para obtener
       de forma incremental el identificador al crear un nuevo registro en la entidad.
       Por tanto, esta secuencia debe existir en la BBDD sobre la que
       se ejecuta la aplicaci&oacute;n, de lo contrario se producir&aacute; un error al
       no poder obtener el siguiente valor de la sequencia antes de crear
       un nuevo registro. Por defecto, todas las entidades utilizar&aacute;n la misma secuencia para
       obtener los identificadores de los registros que se vayan creando.</p>

       <p>Si se necesita especificar una sequencia distinta para generar
       los identificador para cada Entidad se puede utilizar el atributo
       <span class="emphasis"><em>--sequenceName</em></span> del comando <span class="emphasis"><em>entity</em></span>.
       Si la entidad ya fue creada con anterioridad y no se desea volver a crearla
       mediante el comando con la nueva caracter&iacute;stica, 
       modificar la anotaci&oacute;n @RooJpaActiveRecord de la siguiente forma:</p>

          <pre class="programlisting">
@RooJavaBean
@RooToString
@RooJpaActiveRecord(sequenceName="ent1_seq_generator")
public class Entity1 {

    private String field1;

}</pre>

       <p>Como se ha comentado, las secuencias que se usan
       en las Entidades han de existir en la BBDD. Se deber&aacute;n crear
       mediante la sintaxis propia de la BBDD o bien delegarlo
       en Hibernate modificando la propiedad del archivo
       <span class="emphasis"><em>persistence.xml</em></span>,
       <span class="emphasis"><em>hibernate.hbm2ddl.auto</em></span> con valor
       <span class="emphasis"><em>update</em></span> de forma que, al arrancar la aplicaci&oacute;n,
       crear&aacute; las secuencias necesarias. <span class="bold"><strong>Consultar
       con el administrador de BBDD si se permite la creaci&oacute;n de nuevas
       estructuras.</strong></span>.</p>

       <p>Cuando se usa una secuencia como identificador, antes de
       insertar un nuevo registro, el ORM consulta el valor de
       la secuencia que debe asiganarle. Esto implica una cosulta por cada
       inserci&oacute;n, con el consecuente sobrecoste. Hibernate, por defecto,
       intenta evitar este sobrecoste reservando un conjunto de valores de la
       secuencia la primera vez que se usa tras arrancar la aplicaci&oacute;n (por
       defecto reserva los siguientes 50). Mientras no consuma estos
       valores, no volver&aacute; a solicitar el siguiente valor de la secuencia.
       Para m&aacute;s informaci&oacute;n sobre la optimizaci&oacute;n de generadores de
       secuencia consultar la <a class="ulink" href="http://docs.jboss.org/hibernate/core/3.3/reference/en/html/mapping.html#mapping-declaration-id-enhanced-optimizers" target="_top">documentaci&oacute;n
       de Hibernate</a>. Es posible modificar este comportamiento 
       haciendo push-in de la propiedad id y a&ntilde;adiendo 
       a la anotaci&oacute;n <span class="emphasis"><em>@SequenceGenerator</em></span> el atributo
       <span class="emphasis"><em>allocationSize = 1.</em></span></p>

    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="guia-desarrollo_gestion-entidades_enlazar-base-datos-existente_campo-control-optimista"></a>8.5.5. Campo para el control de concurrencia optimista.</h3></div></div></div>
      

      <p>En la ingenier&iacute;a directa, por defecto, para cada entidad 
      se genera un campo de control de concurrencia
      optimista con nombre <code class="literal">version</code> y de tipo
      <code class="classname">java.lang.Integer</code></p>
      
	<p>El control por versi&oacute;n utiliza n&uacute;meros de versi&oacute;n, o sellos de fecha
	(timestamps), para detectar actualizaciones en conflicto y prevenir la
	p&eacute;rdida de actualizaciones. Cuando 2 usuarios actualizan el mismo registro de
	forma simult&aacute;nea, sin control de concurrencia, los cambios del segundo usuario
	en actualizar sobreescriben los datos actualizados por el primer, dando la
	sensaci&oacute;n al primer usuario que sus datos se perdieron o nunca existieron.</p>
	
	<p>En el control de concurrencia por versi&oacute;n hay una columna <span class="emphasis"><em>Version</em></span> en la
	tabla de base de datos que se mapea a un atributo de la entidad anotado con
	<span class="emphasis"><em>@Version</em></span>. Al hacer update o delete se a&ntilde;ade al WHERE la clave primaria
	y la comparaci&oacute;n de versi&oacute;n, <span class="emphasis"><em>si version != VERSION_DB</em></span> no se actualiza nada.
	</p>
	
	<p>Observar que todas estas caracter&iacute;sticas se pueden especificar en el 
	momento de la creaci&oacute;n de la entidad mediante el comando entity.
	Para ajustarlo posteriormente existen otras opciones:</p>

      <div class="orderedlist"><ol type="1"><li>
          <p>Configurar la anotaci&oacute;n @RooJpaActiveRecord para ajustar el nombre del
          campo, el nombre de la columna y el tipo de datos.</p>

          <pre class="programlisting">
@RooJavaBean
@RooToString
@RooJpaActiveRecord(versionField="version", 
        versionType=Long.class, versionColumn="ENT_ID")
public class Entity1 {

    private String field1;

}</pre>
        </li><li>
          <p>Otro ejemplo desactivando el control de concurrencia
          optimista:</p>

          <pre class="programlisting">
@RooJavaBean
@RooToString
@RooJpaActiveRecord(versionField="")
public class Entity1 {

    private String field1;

}</pre>
        </li></ol></div>
      
      <p>Mas adelante se ver&aacute;n otros mecanismos para realizar un
      control de concurrencia optimista. Para m&aacute;s informaci&oacute;n
      consultar el comando <span class="command"><strong><a class="link" href="#apendice-comandos_addon-persistence_occchecksum_occ-checksum-set" title="26.1.1.&nbsp;occ checksum set">
      occ checksum set</a></strong></span>.</p>
          
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="guia-desarrollo_gestion-entidades_enlazar-base-datos-existente_regeneracion-bbdd"></a>8.5.6. Regeneraci&oacute;n de la Base de datos en cada
      arranque.</h3></div></div></div>
      

      <p>Recordar que por defecto, en la ingenier&iacute;a directa, 
      la configuraci&oacute;n que se genera
      <span class="bold"><strong>reconstruye la base de datos en cada ejecuci&oacute;n de
      la aplicaci&oacute;n</strong></span>. Si se desea modificar este comportamiento
      consultar la secci&oacute;n 
      <a class="link" href="#guia-desarrollo_acceso-datos_actualizacion-esquema" title="6.2.4. Actualizaci&oacute;n autom&aacute;tica del esquema">
      Actualizaci&oacute;n autom&aacute;tica del esquema</a>
      .</p>
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="d4e1621"></a>8.5.7. Creaci&oacute;n de una nueva entidad sin comandos</h3></div></div></div>
      
      
      <p>En el ejemplo que se est&aacute; siguiendo a lo largo de la documentaci&oacute;n,
      se puede definir una nueva entidad <span class="emphasis"><em>Repartidor</em></span>
      creando la siguiente clase Java. Tambi&eacute;n se puede realizar
      su creaci&oacute;n mediante los comandos <span class="emphasis"><em>entity</em></span> y 
      <span class="emphasis"><em>field</em></span>.</p>

      <pre class="programlisting">package com.springsource.roo.pizzashop.domain;

import org.springframework.roo.addon.javabean.RooJavaBean;
import org.springframework.roo.addon.jpa.activerecord.RooJpaActiveRecord;
import org.springframework.roo.addon.tostring.RooToString;

@RooJavaBean
@RooToString
@RooJpaActiveRecord
public class Repartidor {

        private String name;
}</pre>

      <p>Observar que al salvar la clase Java con las anotaciones correspondientes,
      en la consola aparecen mensajes informando de la creaci&oacute;n de distintos ficheros
      de aspectos java (*.aj). A continuaci&oacute;n, se puede generar los test de integraci&oacute;n
      para la nueva entidad y definir una relaci&oacute;n entre PizzaOrder y el Repartidor del pedido.</p>

      <pre class="programlisting"><span class="command"><strong>test integration --entity ~.domain.Repartidor</strong></span>
...
<span class="command"><strong>field reference --class ~.domain.PizzaOrder --fieldName repartidor
		--type ~.domain.Repartidor</strong></span>
...</pre>

      <p>Finalmente, lanzar los test de integraci&oacute;n para confirmar que
      todo se ha generado y funciona correctamente.</p>

      <pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>perform tests
</strong></span>...
[INFO] BUILD SUCCESSFUL</pre>
    </div>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="guia-desarrollo_gestion-entidades_ingenieria-inversa"></a>8.6. Ingenier&iacute;a inversa de entidades</h2></div></div></div>
    

    <p>El framework permite realizar una ingenier&iacute;a inversa
    multiesquema e incremental de un modelo relacional de base de datos existente,
    de forma que bas&aacute;ndose en la metainformaci&oacute;n recopilada de la BBDD se generar&aacute;n todas 
    las entidades con sus respectivos campos de manera autom&aacute;tica.
    El encargado de esta funcionalidad es el
    Add-on <span class="emphasis"><em>Database Reverse Engineering</em></span> disponible
    en el framework de forma autom&aacute;tica.</p>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="guia-desarrollo_ingenieria-inversa_instalacion"></a>8.6.1. Instalaci&oacute;n del driver JDBC</h3></div></div></div>
      

      <p>El Add-on DBRE soporta las principales bases de datos
      relacionales del mercado (MySQL, MS SQL, PostgreSQL, Oracle, ...).
      El driver a necesario ser&aacute; detecta y se ofrecer&aacute;
      su descargar e instalaci&oacute;n autom&aacute;tica la primera vez que lo requiera
      alguno de los comandos <span class="emphasis"><em>database introspect</em></span> o
      <span class="emphasis"><em>database reverse engineer.</em></span></p>

      <div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Aviso</h3>
          <p>Si se est&aacute; trabajando en el entorno de la CITMA, antes de seguir
          adelante es recomendable a&ntilde;adir el repositorio Maven de la CITMA
          al pom.xml del proyecto. En la <a class="link" href="#recetas-repositorio_maven" title="25.1. Repositorios Maven">secci&oacute;n de recetas</a> existe un
          ejemplo de como hacerlo.</p>
        </div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Aviso</h3>
          <p>Si se lanza este comando con la configuraci&oacute;n actual del
          proyecto que usa HYPERSONIC_PERSISTENT como BBDD indicar&aacute; que no
          hay driver disponible para HSQLDB.</p>
        </div><p>Por ejemplo, si se ejecuta la ingenier&iacute;a inversa en un proyecto con
        PostgreSQL configurado como sistema de base de datos:
        
        </p><pre class="programlisting">roo-gvNIX&gt; <span class="bold"><strong>database introspect --schema unable-to-obtain-connection</strong></span>
Located add-on that may offer this JDBC driver
1 found, sorted by rank; T = trusted developer; R = Roo 1.2 compatible
ID T R DESCRIPTION -------------------------------------------------------------
01 Y Y 9.1.0.901_0001 Postgres #jdbcdriver...
--------------------------------------------------------------------------------
[HINT] use 'addon info id --searchResultId ..' to see details about a search result
[HINT] use 'addon install id --searchResultId ..' to install a specific search result, or
[HINT] use 'addon install bundle --bundleSymbolicName TAB' to install a specific
		add-on version
JDBC driver not available for 'org.postgresql.Driver'</pre><p>Esta
      salida del comando <span class="emphasis"><em>database
      introspect</em></span> informa que hay disponible un driver para el
      soporte de DBRE y sugiere qu&eacute; hacer a continuaci&oacute;n (lineas que
      empiezan con [HINT]).</p>

      <p>Se puede obtener m&aacute;s informaci&oacute;n sobre el driver mediante:</p>

      <pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>addon info id --searchResultId 01</strong></span>
Name.........: Spring Roo - Wrapping - postgresql-jdbc3
BSN..........: org.springframework.roo.wrapping.postgresql-jdbc3
Version......: 9.1.0.901_0001 [available versions: 9.0.801.0001,
               9.1.0.901_0001]
Roo Version..: 1.2
Ranking......: 0.0
JAR Size.....: 513073 bytes
PGP Signature: 0xEC67B395 signed by Alan Stewart (stewarta@vmware.com)
OBR URL......: http://spring-roo-repository.springsource.org/repository.xml</pre>

      <p>Donde se est&aacute; pidiendo m&aacute;s informaci&oacute;n
      (--searchResultId) del Add-on 01 que ha devuelto el comando
      anterior.</p>

      <p>Para instalarlo usar el id del Add-on o bien su
      nombre simb&oacute;lico.</p><pre class="programlisting"><span class="command"><strong>addon install id --searchResultId 01</strong></span></pre>

      <p>o</p>

      <pre class="programlisting"><span class="command"><strong>addon install bundle
      		--bundleSymbolicName org.springframework.roo.wrapping.postgresql-jdbc3</strong></span></pre>

      <p>Al instante estar&aacute; disponible el driver JDBC y se podr&aacute; empezar
      a usar los comandos <span class="emphasis"><em>database introspect</em></span> y
      <span class="emphasis"><em>database reverse.</em></span></p>

    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="d4e1666"></a>8.6.2. Comandos de la ingenier&iacute;a inversa</h3></div></div></div>
      

      <p>DBRE ofrece dos comandos: <span class="emphasis"><em>database introspect</em></span>
      o <span class="emphasis"><em>database reverse engineer.</em></span></p>

      <pre class="programlisting"><span class="command"><strong>database introspect --schema</strong></span> &lt;nombre del esquema&gt;
      		--file &lt;nombre del fichero&gt; --enableViews</pre>

      <p>El comando mostrar&aacute; la estructura de la BBDD en formato XML.
      Es obligatorio indicar el esquema, para ello
      presionado la tecla TAB se mostrar&aacute; la lista de esquemas de la
      BBDD. Algunas BBDD no usan el concepto de esquema, MySQL entre ellas,
      aun as&iacute; la opci&oacute;n --schema es necesaria y por ello el asistente
      mostrar&aacute; como esquema "no-schema-required". La opci&oacute;n --file indica que
      guarde la informaci&oacute;n tambi&eacute;n en un fichero determinado y --enableViews
      especifica que tambi&eacute;n debe obtener informaci&oacute;n sobre las vistas.</p>

      <pre class="programlisting"><span class="command"><strong>database reverse engineer --schema</strong></span>
      		--package --testAutomatically --enableViews --includeTables
      		--excludeTables --includeNonPortableAttributes</pre>

      <p>Este comando crea las entidades JPA del proyecto
      representando las tablas y columnas de la BBDD. Al igual que antes
      --schema es obligatorio. Se debe usar --package para indicar el nombre
      del paquete del proyecto donde crear las clases Java, como convenci&oacute;n
      se recomienda utilizar el subpaquete domain dentro del paquete base, 
      ese decir, <span class="emphasis"><em>~.domain</em></span>.</p>

      <p>Podemos indicar tambi&eacute;n que se generen autom&aacute;ticamente los test de
      integraci&oacute;n para cada una de las nuevas entidades creadas con
      --testAutomatically.</p>

      <p>Si se especifica la opci&oacute;n --enableViews en este comando, se crearan
      entidades JPA que representen las vistas que se encuentren en la
      introspecci&oacute;n de la BBDD.</p>

      <p>Se pueden filtrar las tablas que se van a considerar en la
      operaci&oacute;n. --includeTables indicar&aacute; cuales son las tablas que deben
      ser tenidas en cuenta. Se pueden indicar uno o varios nombres de
      tabla, si se indican m&aacute;s de uno, se deber&aacute;n especificar separadas por
      espacios y todas ellas entre comillas dobles.
      Se permite el uso de * para hacer matching de uno o varios
      caracteres en la b&uacute;squeda o el uso de ? para indicar un &uacute;nico caracter.
      De manera opuesta --excludeTables indica qu&eacute; tablas no han de ser
      tenidas en cuenta durante la ingenier&iacute;a inversa y admite el mismo uso de
      * y ?. Las exclusiones de tablas son requeridas especialmente en aquellas
      ocasiones en las que tablas incluidas en la ingenier&iacute;a inversa tienen
      relaciones con otras tablas no incluidas, por lo que estas segundas deber&aacute;n
      excluirse. Un ejemplo:</p>

      <pre class="programlisting">database reverse engineer --schema no-schema-required
      		--package ~.domain --includeTables "foo* bar?"</pre>

      <p>Con este comando se generar&iacute;an las entidades de aquellas tablas de
      la BBDD que tengan como nombre foo&lt;cualquier cosa&gt; y bar&lt;otro
      caracter m&aacute;s&gt;, por ejemplo 'foo_tabla_cool' y 'bars'.</p>

      <div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Aviso</h3>
        <p>Al excluir tablas, adem&aacute;s de evitar que se creen las entidades
        de estas tablas se evita tambi&eacute;n que se creen las asociaciones y
        relaciones en otras entidades. Esto se hace para evitar problemas de
        compilaci&oacute;n en el c&oacute;digo del proyecto.</p>
      </div>

      <p>Como DBRE ofrece ingenier&iacute;a inversa incremental, se puede ejecutar
      este comando tantas veces como sea necesario y de esta forma se
      mantendr&aacute; todas las entidades JPA de manera autom&aacute;tica.</p>

      <p>El par&aacute;metro <span class="bold"><strong>--includeNonPortableAttributes</strong></span> puede ser de
      utilidad. En versiones anteriores de la funcionalidad de ingenier&iacute;a
      inversa de BBDD este par&aacute;metro no exist&iacute;a y, por defecto, cuando se
      generaban las entidades se inclu&iacute;a en las anotaciones JPA un atributo
      que romp&iacute;a la portabilidad del c&oacute;digo Java para trabajar con BBDD
      distintas a la de origen. El atributo en cuesti&oacute;n es
      <span class="emphasis"><em>columnDefinition</em></span> en la anotaci&oacute;n <span class="emphasis"><em>@Column</em></span>,
      que sirve para indicar el tipo de
      dato usado para crear la columna en la BBDD. Este atributo se utiliza en
      dos fases: cuando se delega en JPA la creaci&oacute;n de las tablas de la BBDD
      (propiedad <span class="emphasis"><em>hibernate.hbm2ddl.auto</em></span> con valor
      <span class="emphasis"><em>create</em></span> de Hibernate), de esta forma se indica el
      tipo de dato f&iacute;sico utilizado en la BBDD y tambi&eacute;n se utiliza en la fase
      de validaci&oacute;n del esquema de BBDD en el arranque de la aplicaci&oacute;n
      (propiedad <span class="emphasis"><em>hibernate.hbm2ddl.auto</em></span> con valor
      <span class="emphasis"><em>validate</em></span>), que comprueba que las entidades del
      proyecto cumplen con el esquema de BBDD y por tanto son
      compatibles.</p>

      <p>Por tanto hay que tener en cuenta este detalle al hacer la
      ingenier&iacute;a inversa de la BBDD. Si se va a seguir trabajando con la mismo
      BBDD, se puede optar por requerir que se incluyan los atributos
      "no portables" en la generaci&oacute;n de las entidades. Por contra, si la
      aplicaci&oacute;n se va a ejecutar en distintas bases de datos, es mejor no incluir
      estos atributos y no usar este par&aacute;metro del comando <span class="emphasis"><em>database
      reverse engineer</em></span>.</p>

      <div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Importante</h3>
        <p>Cuando se utiliza el Add-on de ingenier&iacute;a inversa se
        modifica el fichero META-INF/persistence.xml cambiando el valor de la
        propiedad <span class="emphasis"><em>hibernate.hbm2ddl.auto</em></span> por el de
        <span class="emphasis"><em>none</em></span> para evitar poner en peligro la
        integridad de la BBDD a la que se est&aacute; conectando desde el proyecto.
        Si se ha utilizado la opci&oacute;n --includeNonPortableAttributes
        el valor de esta propiedad ser&aacute;
        <span class="emphasis"><em>validate</em></span> de modo que en el arranque de la aplicaci&oacute;n
        se realizar&aacute; la fase de validaci&oacute;n del esquema.</p>
      </div>
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="d4e1701"></a>8.6.3. Anotaci&oacute;n @RooDbManaged</h3></div></div></div>
      

      <p>Tal y como se ha comentado en la secci&oacute;n <a class="link" href="#guia-desarrollo_gestion-entidades_definicion_crear-a-mano" title="8.2. Crear una entidad con un IDE">Crear
      una entidad con un IDE</a> se hace uso de una serie de anotaciones
      Java para que el framework gestione el c&oacute;digo del proyecto. A las anotaciones
      descritas anteriormente se suma ahora la anotaci&oacute;n @RooDbManaged que se
      a&ntilde;ade a todas las entidades creadas durante el proceso de ingenier&iacute;a
      inversa.</p>

      <pre class="programlisting">@RooJavaBean
@RooToString
<span class="command"><strong>@RooDbManaged</strong></span>(automaticallyDelete = true)
@RooJpaActiveRecord
public class Pizza {
}</pre>

      <p>El atributo <span class="emphasis"><em>automaticallyDelete</em></span> que acompa&ntilde;a
      a la anotaci&oacute;n y que toma el valor <span class="emphasis"><em>true</em></span> indica
      que se debe eliminar la entidad en el caso de que la tabla de la
      BBDD a la cual hace referencia sea eliminada. Si el atributo toma el
      valor <span class="emphasis"><em>false</em></span> la entidad no se eliminar&aacute; en caso de que la tabla
      desaparezca de la BBDD.</p>
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="d4e1711"></a>8.6.4. Soporte de funcionalidades JPA 2.0</h3></div></div></div>
      

      <p>El Add-on DBRE crea y mantiene claves primarias simples,
      claves primarias compuestas, relaciones entre entidades,
      restricciones tama&ntilde;o, gesti&oacute;n de valores nulos, etc. A continuaci&oacute;n,
      se ver&aacute; como realiza la gesti&oacute;n de algunos de estos elementos.</p>

      <div class="section" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="d4e1714"></a>8.6.4.1. Claves primarias simples</h4></div></div></div>
        

        <p>Para el caso de claves primarias simples DBRE genera un campo
        identificador en el aspecto java de la entidad marcado con la anotaci&oacute;n @Id
        de forma similar a como se hace al ejecutar el comando
        <span class="emphasis"><em>entity</em></span>.</p>
      </div>

      <div class="section" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="guia-desarrollo_entidades-dbre_clave_compuesta"></a>8.6.4.2. Claves primarias compuestas</h4></div></div></div>
        

        <p>En este caso DBRE utiliza una soluci&oacute;n m&aacute;s elaborada. Crea una
        clase Java que representa la clave primaria anot&aacute;ndola con
        @RooIdentifier(dbManaged = true) y a&ntilde;ade el atributo "identifierType"
        con el nombre de la clase del identificador a la anotaci&oacute;n @RooJpaActiveRecord
        en la clase de la entidad. Por ejemplo:</p>

        <pre class="programlisting">@RooJavaBean
@RooToString
@RooDbManaged(automaticallyDelete = true)
@RooJpaActiveRecord(identifierType = LineItemPK.class, table = "line_item",
		schema = "order")
public class LineItem {
}</pre>

        <pre class="programlisting">@RooIdentifier(dbManaged = true)
public class LineItemPK {
}</pre>

        <p>En el aspecto java de la entidad LineItem existir&aacute; un campo anotado con
        @EmbeddedId del tipo LineItemPK:</p>

        <pre class="programlisting">privileged aspect LineItem_Roo_Jpa_ActiveRecord {
    
    declare @type: LineItem: @Entity;
    
    declare @type: LineItem: @Table(name = "line_item", schema = "order");
    
    @PersistenceContext
    transient EntityManager LineItem.entityManager;
    
    @EmbeddedId
    private LineItemPK LineItem.id;
    
    public LineItemPK LineItem.getId() {
        return this.id;
    }
    
    public void LineItem.setId(LineItemPK id) {
        this.id = id;
    }

    ...
}</pre>

        <p>Y en el aspecto java de la clase que representa la clave compuesta
        estar&aacute;n los campos de la clave primaria con la anotaci&oacute;n
        @Embeddable:</p>

        <pre class="programlisting">privileged aspect LineItemPK_Roo_Identifier {
    
    declare @type: LineItemPK: @Embeddable;
    
    @Column(name = "line_item_id", nullable = false)
    private BigDecimal LineItemPK.lineItemId;
    
    @Column(name = "order_id", nullable = false)
    private BigDecimal LineItemPK.orderId;
    
    public LineItemPK.new(BigDecimal lineItemId, BigDecimal orderId) {
        super();
        this.lineItemId = lineItemId;
        this.orderId = orderId;
    }

    private LineItemPK.new() {
        super();
    }

    ...
}</pre>
      </div>
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="d4e1727"></a>8.6.5. Ingenier&iacute;a inversa multi esquema</h3></div></div></div>
      

      <p>La ingenier&iacute;a inversa proporcionada por el framework
      ofrece soporte para la conexi&oacute;n con m&uacute;ltiples esquemas de la
      misma base de datos de forma autom&aacute;tica.</p>
      
      <p>El opci&oacute;n <span class="emphasis"><em>--schema</em></span> de los comandos
      de la ingenier&iacute;a inversa permiten especificar una lista de esquemas
      separados por espacios y englobados todos ellos por dobles comillas.</p>
      
      <p>La ingenier&iacute;a inversa tambi&eacute;n se puede hacer de
      distintas fuentes de datos utilizando para ello la documentaci&oacute;n
      de la secci&oacute;n <a class="link" href="#guia-desarrollo_gestion-acceso-datos_multiples-fuentes-datos" title="6.2.5. M&uacute;ltiples fuentes de datos">
      M&uacute;ltiples fuentes de datos</a>.</p>

      <p></p>
    </div>
    
    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="d4e1735"></a>8.6.6. Ingenier&iacute;a inversa incremental</h3></div></div></div>
      

      <p>La ingenier&iacute;a inversa proporcionada por el framework
      permite ejecutarse todas las veces que sea necesario de forma
      que se pueden modificar las caracter&iacute;sticas y elementos
      incluidos en ingenier&iacute;as inversas anteriores.</p>
      
      <p>Si al ahcer una ingenier&iacute;a inversa no se incluy&oacute;
      alguna tabla que posteriormente se ha visto necesario,
      basta con volver a ejecutar el comando de ingenier&iacute;a
      inversa incluyendo la nueva tabla. Todas las modificaciones
      realizadas sobre las entidades que ya exist&iacute;an no se perder&aacute;n.</p>

      <p></p>
    </div>

  </div>

</div>
    
    <div class="chapter" lang="es"><div class="titlepage"><div><div><h2 class="title"><a name="guia-desarrollo_entidades-buscadores"></a>Cap&iacute;tulo 9. Buscadores de entidades</h2></div></div></div>
         
  	

	<p>En la secci&oacute;n de recetas se puede encontrar
	informaci&oacute;n adicional para <a class="link" href="#recetas-finders-multitud-campos" title="25.2. Desarrollo de buscadores con gran cantidad de campos">
	desarrollar buscadores con gran cantidad de campos</a> y tambi&eacute;n para hacer los
	<a class="link" href="#recetas-finders-modificar" title="25.3. Campos opcionales en los buscadores">campos opcionales en los buscadores</a>
	.</p>

	<div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="guia-desarrollo_entidades-buscadores-descripcion"></a>9.1. Descripci&oacute;n</h2></div></div></div>
	   
	
	   <p>El framework permite generar buscadores sobre cualquier
	   entidad del modelo de la aplicaci&oacute;n mediante el comando <a class="ulink" href="http://static.springsource.org/spring-roo/reference/html-single/index.html#command-index-finder-add" target="_top">
	   finder add</a>. El comando espera el nombre del buscador a generar
	   en un formato determinado. Para conocer el formato se puede utilizar como ayuda
	   el comando  <a class="ulink" href="http://static.springsource.org/spring-roo/reference/html-single/index.html#command-index-finder-list" target="_top">
	   finder list</a>.</p>
	   
	   <p>En los siguientes puntos se muestra un ejemplo de como elegir y generar un buscador
	   sobre una de las entidades del proyecto del script de ejemplo <span class="emphasis"><em>clinic.roo</em></span>
	   que viene incluido con el framework. Se utilizar&aacute; la entidad Owner para
	   generar un buscador sobre ella.</p>
	
	</div>
	
	<div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="guia-desarrollo_entidades-buscadores-listado"></a>9.2. Listar buscadores</h2></div></div></div>
	   
	
	   <p>Ejecutar el comando finder list sobre la entidad Owner</p>
	
	   <pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>finder list --class ~.domain.Owner --depth 2 --filter LastName</strong></span>
		...
		findOwnersByLastNameLikeAndCityLike(String lastName, String city)
		...</pre>
	
	   <p>En el comando se indica la entidad sobre la que se desea consultar
	   sus buscadores con <span class="emphasis"><em>--class</em></span>. El resto de par&aacute;metros son
	   opcionales. El par&aacute;metro <span class="emphasis"><em>--depth</em></span> indica el nivel de profundidad
	   a tener en cuenta, es decir la cantidad de propiedades a combinar en el buscador.
	   Debido a la enorme cantidad de combinaciones de propiedades que puede existir
	   para una entidad, est&aacute; limitado a un m&aacute;ximo de 3. El par&aacute;metro
	   <span class="emphasis"><em>--filter</em></span> aplica un filtro de forma que solo se
	   mostrar&aacute;n los posibles buscadores que contengan la cadena indicada.</p>
	
	   <p>El comando devuelve una lista de resultados con todos los
	   posibles buscadores que coinciden con los t&eacute;rminos de b&uacute;squeda, de entre ellos
	   se va a escoger findOwnersByLastNameLikeAndCityLike que genera un buscador para la
	   entidad Owners cuyo <span class="emphasis"><em>lastName</em></span> y <span class="emphasis"><em>city</em></span>
	   contenga la cadena que se le pase como par&aacute;metro respectivamente,
	   ambas utilizando para ello el operador <span class="emphasis"><em>like</em></span>.</p>
	   
	   <p>Consultar la documentaci&oacute;n del comando <a class="ulink" href="http://static.springsource.org/spring-roo/reference/html-single/index.html#command-index-finder-list" target="_top">
	   finder list</a> para m&aacute;s informaci&oacute;n.</p>
	</div>
	
	<div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="guia-desarrollo_entidades-buscadores-crear"></a>9.3. Creaci&oacute;n de un buscador</h2></div></div></div>
	   
	   
	   <p>Es importante resaltar que no es necesario utilizar
	   el comando <span class="emphasis"><em>finder list</em></span> antes de utilizar el
	   comando <span class="emphasis"><em>finder add</em></span>. Una vez conocida la nomenclatura
	   utilizada para definir los buscadores no es complicado definir directamente
	   el nombre del buscador deseado. A continuaci&oacute;n, se muestra
	   una peque&ntilde;a gu&iacute;a con el formato que sigue la definici&oacute;n del nombre
	   de un buscador:</p>
	   
	   <pre class="programlisting">findEntitiesByPropertyFilterOperator</pre>
	   
	   <div class="itemizedlist"><ul type="disc"><li>
			<p>Entities: Nombre de la entidad sobre la que
			generar el buscador. Su nombre debe ser escrito en plural, utilizando
			para su pluralizaci&oacute;n las normas del lenguage Ingl&eacute;s. Por ejemplo, la
			entidad <span class="emphasis"><em>Entity</em></span> tomar&aacute; como plural
			<span class="emphasis"><em>Entities</em></span>.</p>
		</li><li>
	    	<p>La porci&oacute;n del buscador <span class="emphasis"><em>PropertyFilter</em></span>
	    	puede repetirse tantas veces como propiedades se desee a&ntilde;adir al filtro
	    	siempre y cuando se utilice un <span class="emphasis"><em>Operator</em></span> para
	    	separar el filtro sobre una propiedad y el siguiente.</p>
		    
		    <div class="itemizedlist"><ul type="circle"><li>
					<p>Property: Nombre de la propiedad de la entidad
					a incluir como filtro en el buscador. Debe tener el mismo nombre que
					la propiedad definida en la entidad, pero comenzando por may&uacute;scula.
					</p>
		   		</li><li>
					<p>Filter: Tipo de filtro a aplicar sobre la propiedad
					anterior de entre los siguientes posibles valores en funci&oacute;n del tipo
					de dato de la propiedad.</p>
		
				    <div class="itemizedlist"><ul type="square"><li>
							<p>Cadenas (String, ...): Equals, IsNotNull, IsNull,
							Like, NotEquals.</p>
						</li><li>
							<p>Num&eacute;ricos (Float, Integer, Long, ...): Between,
							Equals, GreaterThan, GreaterThanEquals, IsNotNull, IsNull, LessThan,
							LessThanEquals, NotEquals.</p>
						</li><li>
							<p>Fechas (Date, Calendar, ...): Between, Equals, GreaterThan,
							GreaterThanEquals, IsNotNull, IsNull, LessThan, LessThanEquals, NotEquals.</p>
						</li><li>
							<p>Booleanos (Boolean, ...): Not.</p>
						</li><li>
							<p>Enumerados (Enum, ...): No aplica. El filtro ya viene
							definido por el valor de la enumeraci&oacute;n que se le proporcionar&aacute; al buscador
							para esta propiedad.</p>
						</li><li>
							<p>Relaci&oacute;n simple con otra entidad (Pet, Vet, ...):
							No aplica. El filtro ya viene definido por la entidad que se le proporcionar&aacute; al
							buscador para esta propiedad.</p>
						</li><li>
							<p>Relaciones m&uacute;ltiples (Set, ...): No aplica. El filtro ya
							viene definido por la lista de valores que se le proporcionar&aacute; al buscador
							para esta propiedad.</p>
						</li></ul></div>
				</li><li>
					<p>Operator: And o Or. Es el operador que se utilizar&aacute; para relacionar
					el filtro sobre una propiedad y el siguiente.</p>
				</li></ul></div>
	     </li></ul></div>
	
		<p>Algunos ejemplos ser&iacute;an: findOwnersByFirstNameLike,
		findPetsByWeightGreaterThan, findVetsByBirthDayBetween, findPetsBySendRemindersNot,
		findPetsByType, findVisitsByPet, findOwnersByPets,
		findOwnersByTelephoneIsNotNullAndBirthDayEquals, 
		findPetsByWeightLessThanEqualsOrTypeOrSendRemindersNot.</p>
		   
		<p>Al ejecutar el comando <span class="emphasis"><em>finder add</em></span> con el
		nombre del buscador deseado se generar&aacute; el buscador en la capa de las entidades,
		pero no se generar&aacute; todav&iacute;a ning&uacute;n c&oacute;digo en la capa de la vista.</p>
	
		<pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>finder add --class ~.domain.Owner
	   		--finderName findOwnersByLastNameLikeAndCityLike</strong></span>
		Updated SRC_MAIN_JAVA/com/springsource/petclinic/domain/Owner.java
		Created SRC_MAIN_JAVA/com/springsource/petclinic/domain/Owner_Roo_Finder.aj
		</pre>
		
		<p>Consultar la documentaci&oacute;n del comando <a class="ulink" href="http://static.springsource.org/spring-roo/reference/html-single/index.html#command-index-finder-add" target="_top">
		finder add</a> para m&aacute;s informaci&oacute;n.</p>
	</div>
	
	<div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="guia-desarrollo_entidades-buscadores-codigo-generado"></a>9.4. C&oacute;digo generado</h2></div></div></div>
	   
	   
		<p>La ejecuci&oacute;n del comando <span class="emphasis"><em>finder add</em></span>
		desencadenar&aacute; la modificaci&oacute;n de una anotaci&oacute;n en la clase Java de la entidad
		especificada.</p>
		
		<pre class="programlisting">...
		@RooJpaActiveRecord(<span class="command"><strong>finders = { "findOwnersByLastNameLikeAndCityLike" }</strong></span>)
		public class Owner extends AbstractPerson {
		}
		</pre>
		
		<p>La aparici&oacute;n del atributo <span class="emphasis"><em>finders</em></span>
		en la anotaci&oacute;n <span class="emphasis"><em>RooJpaActiveRecord</em></span> de la entidad
		provocar&aacute; la generaci&oacute;n del aspecto Java correspondiente
		que implementar&aacute; el buscador solicitado.</p>
	
		<pre class="programlisting">privileged aspect Owner_Roo_Finder {
		
		 public static TypedQuery&lt;Owner&gt; Owner.findOwnersByLastNameLikeAndCityLike(
		 		String lastName, String city) {
		     if (lastName == null || lastName.length() == 0)
		     		throw new IllegalArgumentException("The lastName argument is required");
		     lastName = lastName.replace('*', '%');
		     if (lastName.charAt(0) != '%') {
		         lastName = "%" + lastName;
		     }
		     if (lastName.charAt(lastName.length() - 1) != '%') {
		         lastName = lastName + "%";
		     }
		     if (city == null || city.length() == 0) throw new IllegalArgumentException(
		     		"The city argument is required");
		     city = city.replace('*', '%');
		     if (city.charAt(0) != '%') {
		         city = "%" + city;
		     }
		     if (city.charAt(city.length() - 1) != '%') {
		         city = city + "%";
		     }
		     EntityManager em = Owner.entityManager();
		     TypedQuery&lt;Owner&gt; q = em.createQuery("SELECT o FROM Owner AS o WHERE " + 
		     		"LOWER(o.lastName) LIKE LOWER(:lastName) AND LOWER(o.city) LIKE LOWER(:city)",
		     		Owner.class);
		     q.setParameter("lastName", lastName);
		     q.setParameter("city", city);
		     return q;
		 }
		}</pre>
	   
	</div>
	
</div>
    
    <div class="chapter" lang="es"><div class="titlepage"><div><div><h2 class="title"><a name="guia-desarrollo_aplicacion-base_test"></a>Cap&iacute;tulo 10. Pruebas de integraci&oacute;n</h2></div></div></div>

	
	
	<div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="guia-desarrollo_aplicacion-base_test-integracion"></a>10.1. Creaci&oacute;n de pruebas de integraci&oacute;n</h2></div></div></div>
		
		
		<p>En la creaci&oacute;n de entidades, al especificar el
		par&aacute;metro <span class="command"><strong>--testAutomatically</strong></span> se generan
		autom&aacute;ticamente las pruebas de integraci&oacute;n que permitir&aacute;n
		validar el buen funcionamiento del c&oacute;digo de persistencia
		de la entidad.</p>
		
		<p>Si no se solicit&oacute; la generaci&oacute;n de las pruebas
		de integraci&oacute;n en el momento de la creaci&oacute;n de una entidad,
		se pueden generar posteriormente con el comando
		<span class="emphasis"><em>test integration</em></span>.</p>
		
		<p>Para ejecutar los test utilizar el comando <span class="command"><strong>perform
		tests</strong></span>:</p>

		<pre class="programlisting">~.domain.PizzaOrder roo-gvNIX&gt; <span class="command"><strong>perform test</strong></span>
		<code class="computeroutput">[Thread-4] [INFO] Scanning for projects...
		[Thread-4] [INFO] ------------------------------------------------------------------------
		[Thread-4] [INFO] Building pizzashop
		[Thread-4] [INFO]    task-segment: [test]
		[Thread-4] [INFO] ------------------------------------------------------------------------
		[Thread-4] [INFO] [aspectj:compile {execution: default}]
		...
		...
		[Thread-4] -------------------------------------------------------
		[Thread-4]  T E S T Soo&gt; 
		[Thread-4] -------------------------------------------------------
		[Thread-4] Running com.springsource.roo.pizzashop.domain.PizzaOrderIntegrationTest
		[Thread-4] Tests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 4.389 sec
		[Thread-4] Running com.springsource.roo.pizzashop.domain.ToppingIntegrationTest
		[Thread-4] Tests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.174 sec
		[Thread-4] Running com.springsource.roo.pizzashop.domain.PizzaIntegrationTest
		[Thread-4] Tests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.145 sec
		[Thread-4] Running com.springsource.roo.pizzashop.domain.BaseIntegrationTest
		[Thread-4] Tests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.137 sec
		[Thread-4] zzaOrder roo-gvNIX&gt; 
		[Thread-4] Results :roo-gvNIX&gt; 
		[Thread-4] zzaOrder roo-gvNIX&gt; 
		[Thread-4] Tests run: 36, Failures: 0, Errors: 0, Skipped: 0
		[Thread-4] zzaOrder roo-gvNIX&gt; 
		[Thread-4] [INFO] ------------------------------------------------------------------------
		[Thread-4] [INFO] BUILD SUCCESSFUL
		[Thread-4] [INFO] ------------------------------------------------------------------------
		[Thread-4] [INFO] Total time: 17 seconds
		[Thread-4] [INFO] Finished at: Wed Jun 16 21:10:22 CEST 2010
		[Thread-4] [INFO] Final Memory: 45M/299M
		[Thread-4] [INFO] ------------------------------------------------------------------------</code>
		~.domain.PizzaOrder roo-gvNIX&gt;</pre>
 	</div>
 </div>

    <div class="chapter" lang="es"><div class="titlepage"><div><div><h2 class="title"><a name="guia-desarrollo_capa-web"></a>Cap&iacute;tulo 11. Gesti&oacute;n de la capa web</h2></div></div></div>
  

  <p>La capa web de la aplicaci&oacute;n contiene la infraestructura
  necesaria para gestionar las peticiones HTTP y visualizar cierta informaci&oacute;n
  al usuario como respuesta. Actualmente esta capa puede
  desarrollarse con <a class="ulink" href="http:///spring/docs/3.0.x/spring-framework-reference/html/mvc.html" target="_top">Spring
  MVC</a>, 
  <a class="ulink" href="http://code.google.com/webtoolkit/" target="_top">GWT</a>,
  <a class="ulink" href="http://www.adobe.com/es/products/flex.html" target="_top">Flex</a>,
  <a class="ulink" href="http://javaserverfaces.java.net/" target="_top">JSF</a> y
  <a class="ulink" href="https://vaadin.com/" target="_top">Vaadin</a>.
  Cada una de estas tecnolog&iacute;as est&aacute; integrada a distinto nivel con la
  generaci&oacute;n de c&oacute;digo del framework por lo que cada una de ellas ofrecer&aacute;
  ciertas caracter&iacute;sticas. Este cap&iacute;tulo se centrar&aacute; en la 
  generaci&oacute;n de la capa web con Spring MVC ya que se trata de la tecnolog&iacute;a
  m&aacute;s evolucionada dentro de la generaci&oacute;n de c&oacute;digo del framework y para
  la que gvNIX ha a&ntilde;adido la mayor&iacute;a de sus nuevas funcionalidades.</p>

  <p>La gesti&oacute;n de peticiones en Spring MVC se basa en los
  controladores, clases en las que, mediante anotaciones, se definen los
  m&eacute;todos que atienden peticiones HTTP.</p>

  <p>Un controlador es una clase Java anotada con
  <code class="classname">@Controller</code> a la que le llegan las peticiones que
  realiza el usuario v&iacute;a el navegador web. Identifica las URLs que atiende
  mediante la anotaci&oacute;n <code class="classname">@RequestMapping</code>. Esta &uacute;ltima
  anotaci&oacute;n se puede usar tanto en la clase como en los m&eacute;todos del
  controlador.</p>

  <p>Actualmente se pueden generar autom&aacute;ticamente los
  controladores necesarios para gestionar los objetos de la aplicaci&oacute;n: crear,
  leer, actualizar, borrar y buscar (CRUDS).</p>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="guia-desarrollo_web_definir-controller"></a>11.1. Crear la capa web con el int&eacute;rprete de
    comandos</h2></div></div></div>
    

    <p>Desde el int&eacute;rprete de comandos se puede crear la capa
    web en Spring MVC de forma sencilla, con los comandos siguientes:</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p><span class="command"><strong>web mvc setup</strong></span></p>
      </li><li>
        <p><span class="command"><strong>web mvc scaffold</strong></span></p>
      </li><li>
        <p><span class="command"><strong>web mvc all</strong></span></p>
      </li><li>
        <p><span class="command"><strong>web mvc controller</strong></span></p>
      </li></ul></div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="guia-desarrollo_web_definir-controller_comandos_controller-setup"></a>11.1.1. web mvc setup</h3></div></div></div>
      
      
      <p>Este comando crea toda la configuraci&oacute;n
      necesaria para el funcionamiento de Spring MVC en el proyecto.
      Esto implica varios ficheros de configuraci&oacute;n preparados para
      su correcto funcionamiento en el proyecto actual, recursos gr&aacute;ficos,
      hojas de estilo, soporte multidioma, p&aacute;ginas iniciales, tags, men&uacute;, etc.
      </p>
	</div>
	
    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="guia-desarrollo_web_definir-controller_comandos_controller-scaffold"></a>11.1.2. web mvc scaffold</h3></div></div></div>
      

      <p>Este comando crea un controlador con el CRUD
      (creaci&oacute;n, lectura, actualizaci&oacute;n y borrado)
      de la entidad especificada. No hay restricciones para crear varios controladores
      para la misma entidad.</p>

      <p>Este comando, adem&aacute;s de generar el controlador,
      genera tambi&eacute;n las vistas para la creaci&oacute;n, visualizaci&oacute;n, listado y
      actualizaci&oacute;n de los registros de la entidad y toda la
      configuraci&oacute;n necesaria para que las peticiones del usuario lleguen al
      controlador y se visualize al usuario la respuesta (p&aacute;gina)
      correspondiente.</p>

      <p>Las URL de las peticiones que acepta el Controller
      generado siguen el convenio <a class="ulink" href="http://en.wikipedia.org/wiki/Representational_State_Transfer" target="_top">RESTful</a>
      (<a class="ulink" href="http://es.wikipedia.org/wiki/Representational_State_Transfer" target="_top">en
      espa&ntilde;ol</a>). Toda la l&oacute;gica se genera en un fichero
      <code class="filename">*_Roo_*.aj</code> asociado al controller, de forma que la
      clase Java queda limpia de los m&eacute;todos generados autom&aacute;ticamente.</p>

      <p>Los par&aacute;metros obligatorios para este comando son:</p>

      <div class="variablelist"><dl><dt><span class="term">--class</span></dt><dd>
            <p>Nombre de la clase java para el controller
            (incluido su paquete). Recordar que se puede usar el
            <code class="literal">~</code> para especificar el paquete base de la
            aplicaci&oacute;n. Por convenci&oacute;n, estas clases se suelen
            emplazar en el paquete <code class="literal">~.web</code> y con el
            formato <code class="literal">EntidadController</code>.</p>
          </dd></dl></div>

      <p>Los par&aacute;metros opcionales para este comando son:</p>

      <div class="variablelist"><dl><dt><span class="term">--backingType</span></dt><dd>
            <p>Nombre de la clase Entidad que manejar&aacute; el
            controlador. Si no se especifica este par&aacute;metro, se tomar&aacute;
            como valor la clase en la cual se encuentre el contexto de la
            consola.</p>
          </dd><dt><span class="term">--path</span></dt><dd>
            <p>Ruta base para la generaci&oacute;n de la URL para
            las peticiones basadas en RESTful.</p>
          </dd><dt><span class="term">--disallowedOperations</span></dt><dd>
            <p>Lista de operaciones, separada por comas, de
            las operaciones NO permitidas en este controller. Los elementos de
            esta lista deben estar entre estos: <code class="literal">create update
            delete</code>.</p>
          </dd></dl></div>
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="guia-desarrollo_web_definir-controller_comandos_controller-scafold"></a>11.1.3. web mvc all</h3></div></div></div>
      

      <p>Este comando ejecuta un <a class="link" href="#guia-desarrollo_web_definir-controller_comandos_controller-scaffold" title="11.1.2. web mvc scaffold">web
      mvc scaffold</a> para cada una de las entidades registradas en la
      aplicaci&oacute;n.</p>

      <p>Los par&aacute;metros para este comando son:</p>

      <div class="variablelist"><dl><dt><span class="term">--package</span></dt><dd>
            <p>Nombre del paquete donde se generar&aacute;n los
            controladores. Por convenci&oacute;n, se suele
            utilizar el nombre de paquete <code class="literal">~.web</code>.</p>
          </dd></dl></div>
      

      <p>Un ejemplo:</p>

      <pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>web mvc setup</strong></span>
roo-gvNIX&gt; <span class="command"><strong>web mvc all --package ~.web</strong></span></pre>

    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="guia-desarrollo_web_definir-controller_comandos_controller-class"></a>11.1.4. web mvc controller</h3></div></div></div>
      

      <p>Este comando permite crear un controlador de uso general
      no vinculado a ninguna entidad. Servir&aacute; para realizar implementaciones
      a medida.</p>

      <p>Los par&aacute;metros para este comando son:</p>

      <div class="variablelist"><dl><dt><span class="term">--class</span></dt><dd>
            <p>Nombre de la clase java para el controlador
            (incluido su paquete). Recordar que se puede usar el
            <code class="literal">~</code> para especificar el paquete base de la
            aplicaci&oacute;n.Por convenci&oacute;n, estas clases se suelen
            emplazar en el paquete <code class="literal">~.web</code>.</p>
          </dd><dt><span class="term">--preferredMapping</span></dt><dd>
            <p>Permite definir la ruta de la petici&oacute;n para este
            controller.</p>
          </dd></dl></div>

      <p>Un ejemplo:</p>

      <pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>web mvc setup</strong></span>
roo-gvNIX&gt; <span class="command"><strong>web mvc controller --class ~.web.MyController</strong></span></pre>

      <p>Genera una clase como esta:</p>

      <pre class="programlisting">@RequestMapping("/my/**")
@Controller
public class MyController {

    @RequestMapping
    public void get(ModelMap modelMap, HttpServletRequest request, 
    		HttpServletResponse response) {
    }

    @RequestMapping(method = RequestMethod.POST, value = "{id}")
    public void post(@PathVariable Long id, ModelMap modelMap, HttpServletRequest request,
    		HttpServletResponse response) {
    }

    @RequestMapping
    public String index() {
        return "my/index";
    }
}</pre>

      <p>En este ejemplo la clase atender&aacute; cualquier petici&oacute;n
      cuya URL comience por <code class="filename">{URLBase}/my</code> definido por la
      anotaci&oacute;n <code class="classname">@RequestMapping</code> asociada a la clase.
      El m&eacute;todo receptor, tal cual est&aacute;n definidas las anotaciones
      <code class="classname">@RequestMapping</code> en los m&eacute;todos, cumplir&aacute;n las siguientes
      reglas:</p>

      <div class="orderedlist"><ol type="1"><li>
          <p>Las peticiones de tipo POST con una petici&oacute;n cuya URL cumpla
          <code class="filename">{URLBase}/myController/{entero}</code> entrar&aacute;n por el
          m&eacute;todo <code class="methodname">post</code> de la clase.</p>
        </li><li>
          <p>Las peticiones a <code class="filename">{URLBase}/my/index</code>
          se atender&aacute;n en el m&eacute;todo <code class="methodname">index</code> que mostrar&aacute;
          la vista <code class="filename">my/index</code>.</p>
        </li><li>
          <p>El resto de peticiones ser&aacute;n atendidas en el m&eacute;todo
          <code class="methodname">get</code> de la clase.</p>
        </li></ol></div>

      <p>Para m&aacute;s informaci&oacute;n sobre la anotaci&oacute;n
      <code class="classname">@RequestMapping</code> ver la documentaci&oacute;n de <a class="ulink" href="http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/mvc.html#mvc-ann-requestmapping" target="_top">Spring
      MVC</a>.</p>

      <p>Este comando, adem&aacute;s, generar&aacute; la vista la vista
      <code class="filename">WEB-INF/views/my/index.jspx</code>, a&ntilde;adir&aacute; una entrada de
      men&uacute; para ella y actualizar&aacute; el fichero
      <code class="filename">WEB-INF/i18n/application.properties</code> con entradas de
      internacionalizaci&oacute;n.</p>
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="guia-desarrollo_capa-web_crear-comando"></a>11.1.5. Proyecto ejemplo</h3></div></div></div>
      

      <p>Continuando con el proyecto del tutorial, la capa
      web de la aplicaci&oacute;n de venta de pizzas se crear&aacute; con la siguiente
      secuencia de comandos:</p>

      <pre class="programlisting">~.domain.PizzaOrder roo-gvNIX&gt; <span class="command"><strong>web mvc setup</strong></span>
~.domain.PizzaOrder roo-gvNIX&gt; <span class="command"><strong>web mvc all --package ~.web</strong></span></pre>

    </div>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="guia-desarrollo_web_definir-controller_a-mano"></a>11.2. Crear la capa web con un IDE</h2></div></div></div>
    

    <p>Para que una clase <code class="literal">Java</code> sea un
    controlador de Spring MVC debe estar anotada con la anotaci&oacute;n
    <code class="classname">@Controller</code> y a&ntilde;adir la anotaci&oacute;n <a class="ulink" href="http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/mvc.html#mvc-ann-requestmapping" target="_top">
    <code class="classname">@RequestMapping</code></a>
    como convenga para definir la correspondencia entre una URL y
    los m&eacute;todos del controlador. Los controladores pueden ser a medida,
    para realizar las operaciones espec&iacute;ficas
    o se pueden crear controladores para la gesti&oacute;n del CRUD
    (creaci&oacute;n, lectura, actualizaci&oacute;n y borrado) de las entidades.</p>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="guia-desarrollo_web_definir-controller_a-mano_propio"></a>11.2.1. Controlador a medida</h3></div></div></div>
      

      <p>Para crear un controlador a medida, adem&aacute;s de generar la clase con la
      anotaciones pertinentes, se debe tener en cuenta las siguientes
      cuestiones:</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>Si se utiliza una vista, crearla dentro de
          <code class="filename">WEB-INF/views/{path}</code> junto con un fichero
          <code class="filename">WEB-INF/views/{path}/views.xml</code> de configuraci&oacute;n
          del <code class="literal">Tiles</code>.</p>
        </li><li>
          <p>Si se utilizan cadenas de literales susceptibles de
          internacionalizaci&oacute;n, darlas de alta en los ficheros
          <code class="filename">WEB-INF/i18n/*.properties</code> para los idiomas
          disponibles.</p>
        </li></ul></div>
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="guia-desarrollo_web_definir-controller_a-mano_automatico"></a>11.2.2. Controlador CRUD</h3></div></div></div>
      

      <p>Se puede crear un controlador en Spring MVC
      que realice de forma autom&aacute;tica la creaci&oacute;n, lectura, actualizaci&oacute;n y borrado
      de registros de la entidad. Estas clases tienen el siguiente aspecto:</p>

<pre class="programlisting">@RequestMapping("/bases")
@Controller
@RooWebScaffold(path = "bases", formBackingObject = Base.class)
public class BaseController {
}</pre>
      
      <p>Estas clases contienen, adem&aacute;s de las anotaciones ya
      explicadas, la anotaci&oacute;n <code class="classname">@RooWebScaffold</code> que
      admite los siguientes atributos obligatorios:</p>

      <div class="variablelist"><div class="variablelist"><p>Y tambi&eacute;n admite los siguientes atributos opcionales:</p><dl></dl></div><dl><dt><span class="term">path</span></dt><dd>
            <p>Ruta base del controlador. Debe coincidir con
            la ruta de la anotaci&oacute;n <code class="classname">@RequestMapping</code> de
            la clase. Tambi&eacute;n se usar&aacute; como ruta base para crear las vistas
            autom&aacute;ticas a partir de <code class="filename">WEB-INF/views/</code> en la
            aplicaci&oacute;n.</p>
          </dd><dt><span class="term">formBackingObject</span></dt><dd>
            <p>Objeto que maneja el controlador. Debe ser una
            clase java anotada como entidad.</p>
          </dd><dt><span class="term">update, delete y create</span></dt><dd>
            <p>Define si deben permitirse estas operaciones en el
            controlador. Por defecto <code class="literal">true</code>.</p>
          </dd><dt><span class="term">populateMethods</span></dt><dd>
            <p>Indica si deben generarse los m&eacute;todos encargados de
            publicar las listas de valores que sean necesarias en las vistas.
            Por defecto <code class="literal">True</code>.</p>
          </dd></dl></div>

      <p>Cuando el framework detecte la anotaci&oacute;n realizar&aacute;
      las siguientes operaciones:</p>

      <div class="orderedlist"><ol type="1"><li>
          <p>Crear&aacute; un fichero *_Roo_Controller.aj donde
          generar&aacute; todos los m&eacute;todos para gestionar las peticiones que lleguen
          al controller.</p>
        </li><li>
          <p>A&ntilde;adir&aacute; las vistas necesarias en
          <code class="filename">WEB-INF/views/{nombre_controller}</code> para
          gestionar las acciones configuradas en la anotaci&oacute;n
          (creaci&oacute;n, actualizaci&oacute;n y/o borrado).</p>
        </li><li>
          <p>A&ntilde;adir&aacute; las entradas de men&uacute; necesarias.</p>
        </li><li>
          <p>A&ntilde;adir&aacute; en el fichero
          <code class="filename">WEB-INF/i18n/application.properties</code> las
          entradas multidioma necesarias.</p>
        </li></ol></div>
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="d4e2023"></a>11.2.3. C&oacute;digo generado en las vistas de la capa web</h3></div></div></div>
      

      <p>Cuando se genera capa web de la
      aplicaci&oacute;n lo hace generando ficheros jspx y tagx. Los ficheros jspx no
      son m&aacute;s que JSPs que tienen un formato XML v&aacute;lido.
      A su vez las jspx hacen uso de tags de las librer&iacute;as JSTL,
      Spring Framework y otras que se gener&aacute;n tambi&eacute;n como parte de la
      aplicaci&oacute;n ubicadas en WEB-INF/tags.</p>

      <p>Ya que es una buena pr&aacute;ctica la reutilizaci&oacute;n de c&oacute;digo o de
      componentes de la vista web, se utiliza el motor de plantillas <a class="ulink" href="http://tiles.apache.org/" target="_top">Apache Tiles</a>. Este motor de
      plantillas permite definir fragmentos que pueden ser integrados en una
      p&aacute;gina completa en tiempo de ejecuci&oacute;n, facilitando el desarrollo de la
      capa de presentaci&oacute;n de una forma consistente en toda la
      aplicaci&oacute;n.</p>

      <div class="section" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="d4e2028"></a>11.2.3.1. Estructura de archivos de las vistas en la capa web</h4></div></div></div>
        

        <p>En el proyecto de ejemplo PizzaShop, se habr&aacute; creado hasta el
        momento la estructura de directorios y archivos que se puede ver en la
        siguiente imagen:</p>

        <div class="figure"><a name="d4e2031"></a><div class="figure-contents">
          

          <div class="mediaobject" align="center"><img src="images/webinf-tree.png" align="middle" alt="Estructura archivos Pizza Shop"></div>
        </div><p class="title"><b>Figura 11.1. Estructura archivos Pizza Shop</b></p></div><br class="figure-break">

        <p>De todas las carpetas anteriores el desarrollo se centrar&aacute; en
        <span class="emphasis"><em>layouts, tags y views</em></span>.</p>
      </div>

      <div class="section" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="guia-desarrollo_web_tiles"></a>11.2.3.2. Motor de plantillas: Tiles</h4></div></div></div>
        

        <p>Dentro de <span class="emphasis"><em>views</em></span> hay varios ficheros jspx y
        varias carpetas. Entre los ficheros se encuentra
        <span class="emphasis"><em>views.xml</em></span>. Este fichero establece la
        configuraci&oacute;n de vistas que Tiles deber&aacute; generar. Tiles se basa en que
        todas las vistas de una aplicaci&oacute;n web son similares, tienen el mismo
        dise&ntilde;o y estructura, pero cada p&aacute;gina est&aacute; compuesta de distintos
        trozos que conforman el contenido pero siempre colocados de la misma
        forma. Al mismo tiempo permite modificar ciertos aspectos del
        dise&ntilde;o para adaptarlos a las necesidades de una vista concreta. Por
        ejemplo, es com&uacute;n que una p&aacute;gina web tenga una cabecera, donde se
        puede ver el t&iacute;tulo de la misma, un men&uacute; con las distintas secciones
        que hay en el site, un pie de p&aacute;gina y una parte principal con el
        contenido. Tiles nos brinda la posibilidad de especificar que una
        disposici&oacute;n de la p&aacute;gina contiene estos cuatro bloques, pero por
        contra en alguna secci&oacute;n o situaci&oacute;n (por ejemplo: el usuario de la
        web est&aacute; o no logado en la aplicaci&oacute;n) se desea que el men&uacute; no se
        muestre.</p>

          <pre class="programlisting">&lt;definition name="index" extends="default"&gt;
  &lt;put-attribute name="body" value="/WEB-INF/views/index.jspx" /&gt;
&lt;/definition&gt;</pre>

        <p>El c&oacute;digo anterior, extraido de <span class="emphasis"><em>view.xml</em></span>,
        define una vista llamada <span class="emphasis"><em>index</em></span> que se basa en,
        extiende de, otra vista <span class="emphasis"><em>default</em></span> y a la que se le
        pasa como atributo <span class="emphasis"><em>body</em></span> la p&aacute;gina definida por el
        fichero <span class="emphasis"><em>index.jspx.</em></span> La definici&oacute;n de la vista
        <span class="emphasis"><em>default</em></span> ayudar&aacute; a entender esta otra.
        <span class="emphasis"><em>default</em></span> se define en el fichero
        <span class="emphasis"><em>WEB-INF/layouts/layouts.xml</em></span>.</p>

        <pre class="programlisting">&lt;definition name="default" template="/WEB-INF/layouts/default.jspx"&gt;
  &lt;put-attribute name="header" value="/WEB-INF/views/header.jspx" /&gt;
  &lt;put-attribute name="menu" value="/WEB-INF/views/menu.jspx" /&gt;
  &lt;put-attribute name="footer" value="/WEB-INF/views/footer.jspx" /&gt;
&lt;/definition&gt;</pre>

        <p>En la definici&oacute;n de esta vista se indica que la plantilla
        (<span class="emphasis"><em>template</em></span>) que va a dibujar est&aacute; parte de la
        web est&aacute; programada en la JSP <span class="emphasis"><em>default.jspx</em></span>.
        Adem&aacute;s, aqu&iacute; ya se observan otros fragmentos que van a definir la
        composici&oacute;n de la vista: la cabecera
        (<span class="emphasis"><em>header</em></span>), men&uacute; (<span class="emphasis"><em>menu</em></span>)
        y pie de p&aacute;gina
        (<span class="emphasis"><em>footer</em></span>), los cuales ser&aacute;n dibujados por las
        respectivas p&aacute;ginas jspx. Volviendo a la definici&oacute;n de la vista
        <span class="emphasis"><em>index</em></span> del fragmento de c&oacute;digo anterior,
        se observa c&oacute;mo uniendo los atributos
        de las dos definiciones se obtiene que la vista
        <span class="emphasis"><em>index</em></span> se compone de los cuatro fragmentos que
        comentados anteriormente: cabecera, men&uacute;, pie de p&aacute;gina y
        cuerpo. As&iacute; pues, es sencillo definir una nueva vista con esta
        misma estructura simplemente indicando que el contenido principal, el
        cuerpo, viene definido por otra JSP cualquiera.</p>

        <p>Como aclaraci&oacute;n, se puede analizar el contenido del fichero
        <span class="emphasis"><em>default.jspx</em></span>:</p>

        <pre class="programlisting">&lt;html xmlns:jsp="http://java.sun.com/JSP/Page"
 xmlns:c="http://java.sun.com/jsp/jstl/core" 
 xmlns:tiles="http://tiles.apache.org/tags-tiles"
 xmlns:spring="http://www.springframework.org/tags" 
 xmlns:util="urn:jsptagdir:/WEB-INF/tags/util" &gt;  

  &lt;jsp:output doctype-root-element="HTML" doctype-system="about:legacy-compat" /&gt;

  &lt;jsp:directive.page contentType="text/html;charset=UTF-8" /&gt;  
  &lt;jsp:directive.page pageEncoding="UTF-8" /&gt; 

  &lt;head&gt;
    &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;
    &lt;meta http-equiv="X-UA-Compatible" content="IE=8" /&gt;

    <span class="bold"><strong>&lt;util:load-scripts /&gt;</strong></span>

    <span class="bold"><strong>&lt;spring:message code="application_name" var="app_name" htmlEscape="false"/&gt;</strong></span>
    &lt;title&gt;&lt;spring:message code="welcome_h3" arguments="${app_name}" /&gt;&lt;/title&gt;
  &lt;/head&gt;

  &lt;body class="tundra spring"&gt;
    &lt;div id="wrapper"&gt;
      <span class="bold"><strong>&lt;tiles:insertAttribute name="header" ignore="true" /&gt;</strong></span>
      &lt;tiles:insertAttribute name="menu" ignore="true" /&gt;   
      &lt;div id="main"&gt;
        <span class="bold"><strong>&lt;tiles:insertAttribute name="body"/&gt;</strong></span> 
        &lt;tiles:insertAttribute name="footer" ignore="true"/&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

        <p>En el fragmento de c&oacute;digo anterior aparecen etiquetas de HTML y
        algunas otras etiquetas resaltadas en negrita. <span class="bold"><strong>&lt;util:load-scripts /&gt;</strong></span> es una etiqueta
        definida dentro del proyecto, luego se ver&aacute; su
        finalidad. Las etiquetas <span class="bold"><strong>&lt;spring:message
        .../&gt; </strong></span>son de Spring Framework y sirven para mostrar
        texto traducido a los distintos idiomas soportados por la
        aplicaci&oacute;n. Por &uacute;ltimo las etiquetas <span class="bold"><strong>&lt;tiles:insertAttribute ... ignore="true"
        /&gt;</strong></span> son propias de Tiles y permiten
        insertar en esa posici&oacute;n de la p&aacute;gina JSP el contenido del fichero
        que se ha especificado en la definici&oacute;n de las vistas como par&aacute;metro
        (<span class="emphasis"><em>head, menu, body, footer</em></span>). Cabe destacar el
        atributo <span class="emphasis"><em>ignore</em></span> que acompa&ntilde;a a alguna de estas
        etiquetas. El atributo <span class="emphasis"><em>ignore</em></span> con valor
        <span class="emphasis"><em>true</em></span> indica que, si el bloque que debe insertarse
        en el lugar de esa etiqueta no est&aacute; establecido en la definici&oacute;n de la
        vista, lo ignore y siga con el dibujado del resto de la p&aacute;gina, por
        contra, en ausencia de este atributo o con valor
        <span class="emphasis"><em>false</em></span>, al dibujar la p&aacute;gina, si el bloque a
        insertar no est&aacute; definido, se producir&iacute;a una excepci&oacute;n en tiempo de
        ejecuci&oacute;n y por tanto no se dibujar&iacute;a la p&aacute;gina.</p>

        <p>Con esto ya se conoce el funcionamiento del motor de plantillas
        usado en el framework, a continuaci&oacute;n se ver&aacute; el resto de directorios y
        ficheros que componen la capa web de la aplicaci&oacute;n.</p>
      </div>

      <div class="section" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="d4e2079"></a>11.2.3.3. Vistas CRUD (Create, Read, Update, Delete)</h4></div></div></div>
        

        <p>Observando las carpetas contenidas en la carpeta views,
        se puede observar que hay una carpeta por cada una de las entidades de la
        l&oacute;gica de negocio. Cada una de estas carpetas contiene las p&aacute;ginas JSP
        que dibujar&aacute;n las vistas para las operaciones de Creaci&oacute;n (Create),
        Lectura (Read), Modificaci&oacute;n (Update) y Borrado (Delete). Tomando como
        ejemplo la entidad <span class="emphasis"><em>bases</em></span>:</p>

        <pre class="programlisting">bases
|-- create.jspx
|-- list.jspx
|-- show.jspx
|-- update.jspx
`-- views.xml</pre>

        <p>Cabe destacar que tambi&eacute;n existe un archivo
        <span class="emphasis"><em>views.xml</em></span>. Tambi&eacute;n se trata de un archivo de
        definiciones de vistas. Mirando su contendo se observa que define
        varias vistas que se basan en <span class="emphasis"><em>default</em></span> tal y como se
        ha comentado anteriormente pero cada una de ellas define un
        <span class="emphasis"><em>body</em></span> con una JSP distinta.</p>

        <p>Parece bastante evidente cual es el cometido de cada una de las
        JSP:</p>

        <div class="itemizedlist"><ul type="disc"><li>
            <p><span class="emphasis"><em>create.jspx</em></span> muestra el formulario de
            creaci&oacute;n de un nuevo registro de la entidad Base,</p>
          </li><li>
            <p><span class="emphasis"><em>list.jspx</em></span> muestra el listado de todas
            las bases de pizza existentes,</p>
          </li><li>
            <p><span class="emphasis"><em>show.jspx</em></span> mostrar&aacute; la informaci&oacute;n
            detallada de la base de pizza seleccionada</p>
          </li><li>
            <p>y por &uacute;ltimo <span class="emphasis"><em>update.jspx</em></span> muestra el
            formulario de actualizaci&oacute;n del registro.</p>
          </li></ul></div>

        <p>No hay una JSP dedicada al borrado de registros porque ya se
        incluye un bot&oacute;n para el borrado de un registro tanto en <span class="emphasis"><em>show</em></span>
        como en <span class="emphasis"><em>list</em></span>.</p>
      </div>

      <div class="section" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="d4e2105"></a>11.2.3.4. Componentes de las JSP de las vistas CRUD</h4></div></div></div>
        

        <p>Se van a analizar los componentes que forman las vistas CRUD del
        proyecto.</p>

        <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Nota</h3>
          <p>Se listan algunos componentes que pueden aparecer en cada vista
          aunque cada uno de estos componentes puede no aparecer, aparecer varias veces
          o aparecer otros distintos dependiendo de los campos a informar.</p>
        </div>

        <p><span class="bold"><strong>create.jspx</strong></span></p>

        <pre class="programlisting">&lt;form:create&gt;
  &lt;field:input/&gt;
  &lt;field:datetime/&gt;
  &lt;field:select/&gt;
&lt;/form:create&gt;
&lt;form:dependency/&gt;</pre>

        <p><span class="emphasis"><em>&lt;form:create/&gt;</em></span> define un formulario
        en el que los campos vienen definidos por las etiquetas
        <span class="emphasis"><em>&lt;field:xxxx/&gt;</em></span>. Las etiquetas <span class="emphasis"><em>form</em></span>
        generan el c&oacute;digo HTML correspondiente a la infraestructura de un formulario
        de creaci&oacute;n siguiendo la definici&oacute;n RESTful. Las etiquetas
        <span class="emphasis"><em>field</em></span> generan el c&oacute;digo HTML necesario para mostrar campos
        de texto, introducci&oacute;n de fechas o desplegables de selecci&oacute;n. En este caso cada
        campo puede utilizar una etiqueta distinta en funci&oacute;n del tipo de datos que
        contenga y la forma en la que se desee presentar su informaci&oacute;n en pantalla.</p>

        <p><span class="bold"><strong>list.jspx</strong></span></p>

        <pre class="programlisting">&lt;page:list&gt;
  &lt;table:table&gt;
    &lt;table:column/&gt;
  &lt;/table:table&gt;
&lt;/page:list&gt;</pre>

        <p><span class="emphasis"><em>&lt;table:table/&gt;</em></span> y
        <span class="emphasis"><em>&lt;page:list/&gt;</em></span> generar&aacute;n el HTML de una p&aacute;gina y
        una tabla donde las distintas columnas ser&aacute;n los campos indicados
        a trav&eacute;s de la etiqueta
        <span class="emphasis"><em>&lt;table:column/&gt;</em></span> y en cada fila se emplazar&aacute;
        cada uno de los registros de la entidad paginados. Puesto que esta p&aacute;gina
        solo proporciona la visualizaci&oacute;n de los valores de cada campo sin edici&oacute;n, no es
        necesario especificar distintos tipos de columna para cada campo.</p>

        <p><span class="bold"><strong>show.jspx</strong></span></p>

        <pre class="programlisting">&lt;page:show&gt;
  &lt;field:display/&gt;
&lt;/page:show&gt;</pre>

        <p>Muestra los campos de un registro concreto de la entidad 
        en formato texto en la que cada campo se representa mediante la etiqueta
        <span class="emphasis"><em>&lt;field:display/&gt;</em></span>. Esta p&aacute;gina tambi&eacute;n solo proporciona
        visualizaci&oacute;n de valores, por lo que tampoco es
        necesario especificar distintos tipos de columna para cada campo.</p>

        <p><span class="bold"><strong>update.jspx</strong></span></p>

        <pre class="programlisting">&lt;form:update&gt;
  &lt;field:input/&gt;
  &lt;field:datetime/&gt;
  &lt;field:select/&gt;
&lt;/form:update&gt;</pre>

        <p>Se comporta de forma muy parecida a la p&aacute;gina <span class="emphasis"><em>create.jspx</em></span>
        pero esta p&aacute;gina permite la actualizaci&oacute;n de los datos de un registro.
        Las etiquetas <span class="emphasis"><em>field</em></span> que aparecen sirven en este caso para la modificaci&oacute;n
        de un registro y son ex&aacute;ctamente las mismas que en el caso del alta de un nuevo
        registro.</p>
      </div>
    </div>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e2136"></a>11.3. Visualizaci&oacute;n de entidades en la capa web</h2></div></div></div>
    

    <p>Con los componentes &lt;field:display/&gt;, &lt;table:column/&gt; y
    &lt;field:.../&gt; se consigue mostrar datos de las entidades de
    la aplicaci&oacute;n, es decir, en el proyecto PizzaShop de ejemplo, tomando
    la definici&oacute;n de la p&aacute;gina jspx de listado de como la entidad PizzaOrder:</p>

    <pre class="programlisting">&lt;field:display <span class="bold"><strong>field="pizzas"</strong></span> 
		id="s_com_disid_roo_pizzashop_domain_<span class="bold"><strong>PizzaOrder</strong></span>_pizzas" object="${pizzaorder}"
		z="WSxjsiiEWhA5vo8ecxRoox5EjKA="/&gt;</pre>

    <p>En la p&aacute;gina se mostrar&aacute; informaci&oacute;n de las Pizzas ligadas a un
    PizzaOrder. El framework utilizar&aacute; para la visualizaci&oacute;n en la
    capa web de estos objetos relacionados los llamados
    <span class="bold"><strong>Converters</strong></span>. Los Converters son
    clases java que, como su nombre indica, convierten un objeto dado en otro.
    En este caso particular de los Converters, el framework los utiliza para convertir un objeto
    del modelo (cada Pizza) en una cadena de forma que sea legible para un humano.</p>

    <p>Este mecanismo est&aacute; implementado en la clase java
    <span class="emphasis"><em>ApplicationConversionServiceFactoryBean.java</em></span> que
    se puede encontrar en el mismo paquete donde est&aacute;n los controladores de la
    aplicaci&oacute;n. Esta clase la genera el framework de manera autom&aacute;tica al generar la
    capa web. Tal y como se ha comentado en el apartado de <a class="link" href="#guia-desarrollo_generacion-codigo" title="Cap&iacute;tulo 7. C&oacute;digo generado por gvNIX/Roo">generaci&oacute;n de c&oacute;digo</a>,
    asociado al
    <span class="emphasis"><em>ApplicationConversionServiceFactoryBean.java</em></span> existe
    un Aspecto Java (fichero aj) con la declaraci&oacute;n de los Converters y un m&eacute;todo que los
    registra para que est&eacute;n disponibles a la hora de "convertir" una entidad
    del modelo a la cadena que se mostrara en p&aacute;gina.</p>

    <p>Si la cadena que se visualiza en la p&aacute;gina web no muestra la informaci&oacute;n
    deseada para una entidad, se puede modificar el Converter de esa entidad y
    adaptarlo a sus requerimientos. En la secci&oacute;n sobre modificaci&oacute;n de c&oacute;digo se
    explica como hacerlo.</p>
  </div>

</div>
    
    <div class="chapter" lang="es"><div class="titlepage"><div><div><h2 class="title"><a name="guia-desarrollo_capa-web-buscadores"></a>Cap&iacute;tulo 12. Buscadores en la capa web</h2></div></div></div>
         
	
	
	<p>En la secci&oacute;n de recetas se puede encontrar
	informaci&oacute;n adicional para <a class="link" href="#recetas-finders-multitud-campos" title="25.2. Desarrollo de buscadores con gran cantidad de campos">
	desarrollar buscadores con gran cantidad de campos</a> y tambi&eacute;n para hacer los
	<a class="link" href="#recetas-finders-modificar" title="25.3. Campos opcionales en los buscadores">campos opcionales en los buscadores</a>
	.</p>
	
	<div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="guia-desarrollo_capa-web-buscadores-descripcion"></a>12.1. Descripci&oacute;n</h2></div></div></div>
		
		
		<p>Si est&aacute; definida la capa web con Spring MVC, se
		podr&aacute; generar el c&oacute;digo necesario en el controlador y la p&aacute;gina
		jspx con el formulario que invocar&aacute; a uno de los buscadores que
		se encuentren definidos en la capa de entidades.</p>
	</div>
	   
	<div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="guia-desarrollo_capa-web-buscadores-crear"></a>12.2. Creaci&oacute;n de buscadores</h2></div></div></div>
		
		
		<p>Al ejecutar el comando <span class="emphasis"><em>web mvc finder add</em></span>
		indicando la entidad que contiene alg&uacute;n buscador definido a nivel de entidad y el
		controlador encargado de gestionar dicha entidad, se generar&aacute; el buscador en la
		capa de vista.</p>
	
		<pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>web mvc finder add --formBackingType ~.domain.Owner
				--class ~.web.OwnerController</strong></span>
Upd SRC_MAIN_JAVA/com/springsource/petclinic/web/OwnerController.java
Upd SRC_MAIN_WEBAPP/WEB-INF/views/owners/views.xml
Upd SRC_MAIN_WEBAPP/WEB-INF/i18n/application.properties
Cre SRC_MAIN_JAVA/com/springsource/petclinic/web/OwnerController_Roo_Controller_Finder.aj
Cre SRC_MAIN_WEBAPP/WEB-INF/views/owners/findOwnersByLastNameLikeAndCityLike.jspx
Upd SRC_MAIN_WEBAPP/WEB-INF/views/menu.jspx</pre>

		<p>Consultar la documentaci&oacute;n del comando <a class="ulink" href="http://static.springsource.org/spring-roo/reference/html-single/index.html#command-index-web-mvc-finder-add" target="_top">
		web mvc finder add</a> para m&aacute;s informaci&oacute;n.</p>
	</div>
	
	<div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="guia-desarrollo_capa-web-buscadores-codigo-generado"></a>12.3. C&oacute;digo generado</h2></div></div></div>
		
		
		<p>La ejecuci&oacute;n del comando <span class="emphasis"><em>web mvc finder add</em></span>
		desencadenar&aacute; la inclusi&oacute;n de una anotaci&oacute;n en la clase Java del controlador
		especificado.</p>
		
		<pre class="programlisting">...
		@RooWebFinder
		public class OwnerController {
		}</pre>
		
		<p>La aparici&oacute;n de la anotaci&oacute;n <span class="emphasis"><em>RooWebFinder</em></span>
		en el controlador provocar&aacute; la generaci&oacute;n del aspecto Java correspondiente
		que implementar&aacute; la parte web de los buscadores definidos en su entidad
		relacionada. </p>
	
		<pre class="programlisting">privileged aspect OwnerController_Roo_Controller_Finder {
	
		    @RequestMapping(params = { "find=ByLastNameLikeAndCityLike", "form" },
		    		method = RequestMethod.GET)
		    public String OwnerController.findOwnersByLastNameLikeAndCityLikeForm(
		    		Model uiModel) {
		        return "owners/findOwnersByLastNameLikeAndCityLike";
		    }
		
		    @RequestMapping(params = "find=ByLastNameLikeAndCityLike",
		    		method = RequestMethod.GET)
		    public String OwnerController.findOwnersByLastNameLikeAndCityLike(
		    		@RequestParam("lastName") String lastName,
		    		@RequestParam("city") String city, Model uiModel) {
		        uiModel.addAttribute("owners", 
		        		Owner.findOwnersByLastNameLikeAndCityLike(lastName, city).getResultList());
		        return "owners/list";
		    }
		}</pre>
	
		<p>Se generar&aacute; tambi&eacute;n la p&aacute;gina jspx correspondiente
		y los recursos adicionales necesarios para su visualizaci&oacute;n.</p>
	
	</div>

</div>
    
    <div class="chapter" lang="es"><div class="titlepage"><div><div><h2 class="title"><a name="guia-desarrollo_capa-web-arranque-pruebas"></a>Cap&iacute;tulo 13. Arranque y pruebas de la aplicaci&oacute;n web</h2></div></div></div>
  

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="guia-desarrollo_aplicacion-base_test-funcional"></a>13.1. Pruebas funcionales</h2></div></div></div>
    

    <p>Una vez creada la capa web es posible generar
    autom&aacute;ticamente un conjunto de pruebas funcionales que
    permitir&aacute;n realizar pruebas de aceptaci&oacute;n de la aplicaci&oacute;n.</p>

    <p>La creaci&oacute;n de las pruebas funcionales se realizan a trav&eacute;s del comando
    <span class="command"><strong>selenium test</strong></span></p>

    <p>En el siguiente ejemplo se est&aacute; generando las pruebas funcionales para
    el controlador de la entidad <span class="emphasis"><em>Pizza</em></span>:</p>
    
    <pre class="programlisting">selenium test --controller ~.web.PizzaController</pre>
    
    <p>Los test generados estar&aacute;n en <span class="emphasis"><em>src/main/webapp/selenium</em></span>.
    La opci&oacute;n <span class="emphasis"><em>--controller</em></span> especifica la clase
    controladora para la que se desea generar el test. Existen dos par&aacute;metros opcionales,
    uno es <span class="emphasis"><em>--serverUrl</em></span> que permite indicar la direcci&oacute;n
    base de la aplicaci&oacute;n sobre la que deben ejecutarse los tests y el otro es
    <span class="emphasis"><em>--name</em></span> que permite dar un nombre espec&iacute;fico al test.
    Habitualmente, no ser&aacute; necesario especificar estos par&aacute;metros opcionales.</p>
    
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="guia-desarrollo_aplicacion-base_arrancar-aplicacion"></a>13.2. Arrancar la aplicaci&oacute;n web</h2></div></div></div>
    

    <p>Desde que se cre&oacute; la capa web, ya era posible poner en
    marcha la aplicaci&oacute;n y visualizarla en un navegador web. La puesta en marcha
    de la aplicaci&oacute;n se puede realizar de dos formas distintas.</p>
    
    <p>Si la consola del framework se est&aacute; ejecutando desde un
    Eclipse o un STS, consultar la secci&oacute;n de la documentaci&oacute;n
    <a class="link" href="#guia-desarrollo_aplicacion-base_arrancar-aplicacion-eclipse" title="3.5. Arrancar la aplicaci&oacute;n con Eclipse">
    Arrancar la aplicaci&oacute;n con Eclipse</a> en la que se explica tanto la instalaci&oacute;n
    de un servidor en el IDE como el modo de arrancar la aplicaci&oacute;n.</p>
    
    <p>Si la consola del framework se est&aacute; ejecutando desde 
    la consola del sistema, salir de la consola del framework con el comando
    <span class="command"><strong>quit</strong></span> y ejecutar
    la orden <span class="command"><strong>mvn tomcat:run</strong></span>. Observar que en la consola del
    sistema debe estar configurado y por lo tanto disponible la herramienta Maven.</p>

    <p>Para poder ver en funcionamiento la aplicaci&oacute;n se debe acceder a la
    direcci&oacute;n: <code class="uri">http://localhost:8080/pizzashop</code> con un navegador
    web.</p>

  </div>
  

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="guia-desarrollo_aplicacion-base_ejecutar-tests-funcionales"></a>13.3. Ejecutar los tests funcionales</h2></div></div></div>
    

	<p>Para lanzar las pruebas, la aplicaci&oacute;n debe estar en marcha 
	y entonces pueden ejecutarse 
	utilizando el plugin M2Eclipse de STS o Eclipse. Para ello, seleccionar la opci&oacute;n
	<span class="command"><strong>Run As &gt; Maven build ...</strong></span> del men&uacute; contextual del proyecto o del men&uacute; superior e
	introducir como <span class="command"><strong>Goals</strong></span> el valor <span class="command"><strong>selenium:selenese</strong></span>.
	Darle un nombre a esta
	configuraci&oacute;n y a partir de entonces utilizar esta configuraci&oacute;n guardada para ejecutar
	los test funcionales mediante el bot&oacute;n <span class="command"><strong>Run As...</strong></span>.</p>
	
    <p>Tambi&eacute;n es posible lanzar las pruebas
    funcionales con la orden <span class="command"><strong>mvn selenium:selenese</strong></span> desde
    la consola del sistema.</p>
	
	<p>De este modo se ejecutar&aacute; el conjunto de tests sobre una nueva instancia del navegador
	FireFox (obviamente, es necesario tener instalado dicho navegador en la m&aacute;quina).</p>
	
	<p>Los resultados de los tests se guardar&aacute;n en
	<span class="emphasis"><em>target/selenium.html</em></span> en formato HTML.</p>
	</div>
</div>
  </div>

  <div class="part" lang="es"><div class="titlepage"><div><div><h1 class="title"><a name="addons-gvnix"></a>Parte&nbsp;III.&nbsp;Desarrollo avanzado con gvNIX</h1></div></div></div>
    

    <div class="partintro" lang="es"><div></div>
      <p>En esta se va a ver c&oacute;mo ampliar una aplicaci&oacute;n
      web b&aacute;sica creada con el framework para cumplir con los requerimientos de
      cualquier proyecto real.</p>

      <p>Se revisar&aacute; las caracter&iacute;sticas distintivas que ofrece gvNIX
      y que van enfocadas al desarrollo de funcionalidades de alto nivel para facilitar
      el desarrollo y proporcionar una mejor experiencia de uso al usuario:</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>Gesti&oacute;n de distintos temas visuales.</p>
        </li><li>
          <p>Organizaci&oacute;n de la estructura de p&aacute;ginas en el men&uacute;.</p>
        </li><li>
          <p>Gesti&oacute;n de patrones de visualizaci&oacute;n de entidades y sus relaciones.</p>
        </li><li>
          <p>Control de concurrencia a nivel de aplicaci&oacute;n sin campos en base de datos.</p>
        </li><li>
          <p>Gesti&oacute;n de la visualizaci&oacute;n de excepciones y
          gesti&oacute;n de mensajes de usuario en ventana modal.</p>
        </li><li>
          <p>Control de acceso (autenticaci&oacute;n y autorizaci&oacute;n) y seguridad.</p>
        </li><li>
          <p>Generaci&oacute;n de documentos (reportes).</p>
        </li><li>
          <p>Gesti&oacute;n de servicios locales y servicios web (importaci&oacute;n y exposici&oacute;n).</p>
        </li><li>
          <p>Soporte de idiomas oficiales para el estado Espa&ntilde;ol
          (inicialmente incluido el Valenciano).</p>
        </li><li>
          <p>Gesti&oacute;n de configuraciones por entorno.</p>
        </li><li>
          <p>Gesti&oacute;n de transformaci&oacute;n de cadenas vac&iacute;as a valores nulos.</p>
        </li></ul></div>
      
      <p>Cada uno de estos elementos son a&ntilde;adidos (add-ons) que
      gvNIX incluye de forma adicional a todas las funcionalidades que ya
      proporciona su n&uacute;cleo Spring Roo. Cada uno de estos addons pueden ser tambi&eacute;n
      utilizados en cualquier distribuci&oacute;n de Spring Roo est&aacute;ndar.</p>

      <p>Estos add-ons han sido inicialmente dise&ntilde;ados para
      ser aplicados en un modelo de dominio del tipo registro activo y una capa
      visual del tipo spring MVC. Sin embargo, pueden funcionar tambi&eacute;n con otros
      modelos de dominio y visuales y en futuras versiones se ir&aacute; incrementando
      dicha compatibilidad.
      .</p>
      
    </div>

    <div class="chapter" lang="es"><div class="titlepage"><div><div><h2 class="title"><a name="addon-theme-manager"></a>Cap&iacute;tulo 14. Add-on Theme Manager</h2></div></div></div>
  

  <p>Add-on para la gesti&oacute;n de distintos temas visuales.</p>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="addon-theme-manager_descripcion"></a>14.1. Descripci&oacute;n</h2></div></div></div>
    

    <p>Este add-on permite gestionar temas visuales en la
    aplicaci&oacute;n.</p>

    <p>Un tema visual est&aacute; compuesto por ficheros (css, tagx,
    layouts, im&aacute;genes) que, usando los comandos de esta utilidad, se pueden
    instalar en la aplicaci&oacute;n sobre la que se trabaja. Tiene tambi&eacute;n un
    fichero XML de descripci&oacute;n con el identificador del tema.</p>

    <p>Cada uno de los temas que ofrece gvNIX
    puede estar en alguno de los siguientes estados:</p>

    <div class="variablelist"><dl><dt><span class="term">Establecido</span></dt><dd>
          <p>&Uacute;ltimo tema que se ha aplicado en la
          aplicaci&oacute;n y por lo tanto el tema que se estar&aacute;
          visualizando.</p>
        </dd><dt><span class="term">Instalado</span></dt><dd>
          <p>Temas que se encuentran almacenados dentro de la
          aplicaci&oacute;n y preparados para establecer.</p>
        </dd><dt><span class="term">Disponible</span></dt><dd>
          <p>Temas que se pueden instalar en la aplicaci&oacute;n
          y que est&aacute;n incluidos en la instalaci&oacute;n de gvNIX.</p>
        </dd></dl></div>

    <p>Un Tema, para poder ser
    <span class="emphasis"><em>establecido</em></span> en la aplicaci&oacute;n en desarrollo, debe de
    estar <span class="emphasis"><em>Instalado</em></span>. La instalaci&oacute;n de un Tema puede
    hacerse mediante el comando <a class="link" href="#apendice-comandos_addon-theme-manager_theme-install" title="26.2.1.&nbsp;theme install"><span class="command"><strong>theme
    install</strong></span></a> o copiando el tema en el directorio
    <code class="filename">themes</code> de la aplicaci&oacute;n con la que se est&aacute;
    trabajando. gvNIX detectar&aacute; la instalaci&oacute;n manual de un tema y por lo
    tanto se podr&aacute; establecer en la aplicaci&oacute;n.</p>

    <p>Para establecer un tema se utiliza el comando
    <a class="link" href="#apendice-comandos_addon-theme-manager_theme-set" title="26.2.2.&nbsp;theme set"><span class="command"><strong>theme
    set</strong></span></a>. Este comando copiar&aacute; el contenido del tema al
    directorio de la aplicaci&oacute;n, sobreescribiendo los fichero ya existentes.
    Este comando <span class="bold"><strong>sobreescribe los ficheros y no implementa
    ning&uacute;n mecanismo para revertir los cambios</strong></span>.</p>
    
    <p>Si se desea actualizar
    un tema (estilos, recursos gr&aacute;ficos, ...) a una versi&oacute;n m&aacute;s actual
    que tenga disponible una nueva versi&oacute;n de gvNIX
    es suficiente con instalar la nueva versi&oacute;n (comando 
    <span class="emphasis"><em>theme install</em></span>) y establecerla
    (<span class="emphasis"><em>theme set</em></span>). Es decir, los comandos de este
    add-on permiten la actualizaci&oacute;n del tema.</p>

    <p>Por otro lado, con el comando <span class="emphasis"><em>theme set</em></span>
    se instala en el directorio <span class="emphasis"><em>styles</em></span> del proyecto un
    archivo (<span class="emphasis"><em>application.css</em></span>) que permitir&aacute; personalizar
    los estilos de la aplicaci&oacute;n sin necesidad de modificar directamente las CSS
    de los temas o de otros addons. Esta hoja de estilos no se reemplaza
    al reinstalar un tema.</p>

    <p>Para ver todos los comandos y sus opciones ver el
    <a class="link" href="#apendice-comandos_addon-theme-manager" title="26.2.&nbsp;Comandos del add-on Theme Manager">ap&eacute;ndice de
    comandos</a>.</p>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e2281"></a>14.2. Temas disponibles por defecto.</h2></div></div></div>
    

    <p>La distribuci&oacute;n de gvNIX viene con dos temas
    <span class="emphasis"><em>disponibles</em></span>:</p>

    <div class="variablelist"><dl><dt><span class="term">cit-theme</span></dt><dd>
          <p>Tema visual utilizado en las aplicaciones de
          la CITMA (Consejer&iacute;a de Infraestructuras, Transporte y Medio
          Ambiente del Govierno de Valencia).</p>
        </dd><dt><span class="term">gvNIX-theme</span></dt><dd>
          <p>Tema de ejemplo con una personalizaci&oacute;n del
          tema est&aacute;ndar de Spring Roo.</p>
        </dd></dl></div>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e2294"></a>14.3. Futuras versiones</h2></div></div></div>
    

    <p>Para las futuras versiones de esta herramienta se
    preve (aunque no est&aacute;n planificadas) a&ntilde;adir la siguientes
    funcionalidades:</p>

    <div class="variablelist"><dl><dt><span class="term">Exportaci&oacute;n de temas</span></dt><dd>
          <p>Generar un Tema basado en los elementos de
          visualizaci&oacute;n actuales de la aplicaci&oacute;n.</p>
        </dd><dt><span class="term">Descarga de temas</span></dt><dd>
          <p>Soporte de descarga de temas desde
          servidores.</p>
        </dd></dl></div>
  </div>
</div>

    <div class="chapter" lang="es"><div class="titlepage"><div><div><h2 class="title"><a name="addon-web-menu"></a>Cap&iacute;tulo 15. Add-on Web Menu</h2></div></div></div>
  

  <p>Sistema de gesti&oacute;n del men&uacute; web</p>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="addon-web-menu_descripcion"></a>15.1. Descripci&oacute;n</h2></div></div></div>
    

    <p>Este Add-on instala un nuevo sistema de gesti&oacute;n del men&uacute; web
    de la aplicaci&oacute;n sobre la que se est&aacute; trabajando para facilitar la organizaci&oacute;n de
    su estructura de p&aacute;ginas y grupos.</p>

    <p>Las principales caracter&iacute;sticas de este sistema
    son:</p>

    <div class="variablelist"><dl><dt><span class="term">Modelo de datos del men&uacute; separado de su formato de visualizaci&oacute;n.</span></dt><dd>
          <p>El modelo de datos del men&uacute; no est&aacute; ubicado en la misma
          p&aacute;gina que lo visualiza como ocurre en el modelo de men&uacute; que se proporciona
          por defecto. El modelo del men&uacute; estar&aacute; definido en un archivo XML
          independiente.</p>
        </dd><dt><span class="term">M&uacute;ltiples niveles en el men&uacute;</span></dt><dd>
          <p>Soporte para crear elementos jerarquizados con
          m&uacute;ltiples niveles. Permite a&ntilde;adir, mover y anidar en varios niveles
          los elementos del men&uacute;.</p>
        </dd><dt><span class="term">Gesti&oacute;n de elementos desde consola</span></dt><dd>
          <p>Permite a&ntilde;adir, quitar, mover, actualizar,
          definir permisos, ocultar, definir enlaces, etc. para 
          cada uno de los elementos del men&uacute; desde la consola del framework.</p>
        </dd><dt><span class="term">Integraci&oacute;n con Spring Security</span></dt><dd>
          <p>Si est&aacute; instalado el sistema de seguridad,
          se puede establecer que ciertos elementos del men&uacute; no sean visibles
          si el usuario no est&aacute; entre los roles permitidos para ello.</p>
        </dd><dt><span class="term">Gestiona las peticiones de Roo</span></dt><dd>
          <p>Aunque el sistema de gesti&oacute;n del men&uacute; es distinto al
          que se proporciona por defecto, este nuevo sistema tambi&eacute;n gestiona 
          las peticiones de generaci&oacute;n de elementos del men&uacute; realizadas
          por el resto de comandos. Es decir, si se encuentra
          instalada la nueva gesti&oacute;n del men&uacute; y cualquier otro comando solicita
          crear o actualizar un elemento del men&uacute;, la solicitud se realizar&aacute;
          correctamente utilizando el nuevo sistema de gesti&oacute;n.</p>
        </dd></dl></div>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e2334"></a>15.2. Definiciones</h2></div></div></div>
    

    <p>Antes de continuar explicando las funcionalidades del
    add-on es interesante tener clara las siguientes definiciones de los
    elementos que conforman un men&uacute;.</p>

    <div class="variablelist"><dl><dt><span class="term">P&aacute;gina</span></dt><dd>
          <p>Representaci&oacute;n de una URL. El destino puede ser
          interno o externo. Los destinos internos apuntan dentro de la propia
          aplicaci&oacute;n mediante una ruta relativa, por ejemplo
          <span class="emphasis"><em>/entity1s/entity1?id=1</em></span>.
          Los enlaces externos apuntan a cualquier direcci&oacute;n web mediante una
          ruta absoluta, por ejemplo <span class="emphasis"><em>https://www.cit.gva.es</em></span>.
          </p>
        </dd><dt><span class="term">Grupo</span></dt><dd>
          <p>Contenedor de p&aacute;ginas. El contenido de un grupo puede ser
          tambi&eacute;n otros grupos. Tambi&eacute;n puede tener asociado una URL pero con
          las mismas restricciones que la p&aacute;gina.</p>
        </dd><dt><span class="term">Men&uacute;</span></dt><dd>
          <p>Estructura en &aacute;rbol de p&aacute;ginas y grupos.</p>
        </dd><dt><span class="term">&Iacute;tem del men&uacute;</span></dt><dd>
          <p>Un elemento del men&uacute; que puede ser una p&aacute;gina o
          un grupo.</p>
        </dd></dl></div>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="addon-web-menu_instalacion"></a>15.3. Instalaci&oacute;n de la gesti&oacute;n del men&uacute;</h2></div></div></div>
    

    <p>El uso del sistema de gesti&oacute;n del men&uacute; aportado por esta
    herramienta es opcional. Por ello, para instalarlo y activarlo es
    necesario ejecutar en primer lugar el comando <span class="command"><strong><a class="link" href="#apendice-comandos_addon-web-menu_page-menu-setup" title="26.4.1.&nbsp;menu setup">menu
    setup</a></strong></span>.</p>
    
	<pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>menu setup</strong></span>
Component org.springframework.roo.addon.web.mvc.jsp.menu.MenuOperationsImpl disabled

Created SRC_MAIN_WEBAPP/WEB-INF/views/menu.xml
Updated SRC_MAIN_WEBAPP/WEB-INF/views/menu.xml
Created SRC_MAIN_JAVA/org/gvnix/test/web/menu
Created SRC_MAIN_JAVA/org/gvnix/test/web/menu/MenuItem.java
Created SRC_MAIN_JAVA/org/gvnix/test/web/menu/Menu.java
Created SRC_MAIN_JAVA/org/gvnix/test/web/menu/MenuLoader.java
Created SRC_MAIN_JAVA/org/gvnix/test/web/menu/ContextMenuStrategy.java
Created SRC_MAIN_JAVA/org/gvnix/test/web/menu/BaseURLContextMenuStrategy.java
Created SRC_MAIN_JAVA/org/gvnix/test/web/menu/URLBrothersContextMenuStrategy.java
Created SRC_MAIN_JAVA/org/gvnix/test/web/menu/URLChildrenContextMenuStrategy.java
Created SRC_MAIN_WEBAPP/WEB-INF/tags/menu/gvnixmenu.tagx
Created SRC_MAIN_WEBAPP/WEB-INF/tags/menu/gvnixitem.tagx
Updated SRC_MAIN_WEBAPP/WEB-INF/views/menu.jspx
Updated ROOT/pom.xml [added property 'gvnix.version' = '1.0.0']</pre>
    
    <p>Este comando a&ntilde;adir&aacute; los siguientes elementos:</p>

    <div class="orderedlist"><ol type="1"><li>
        <p>Clases que representan el modelo de datos del men&uacute;.
        Cada una de estas clases estar&aacute;n anotadas con
        <code class="classname">@GvNIXMenu*</code> para poder ser identificadas.
        Estas clases se crear&aacute;n en el subpaquete
        <code class="filename">web.menu</code>.</p>
      </li><li>
        <p>Una Clase para la carga del men&uacute; y hacerlo
        disponible para su pintado en la vista. Esta clase se crear&aacute;
        en el subpaquete <code class="filename">web.menu</code>.</p>
      </li><li>
        <p>Archivo XML para almacenar el modelo de datos del
        men&uacute;, rellenado previamente con la informaci&oacute;n del men&uacute; de Roo que existiese
        en ese momento. Por defecto se crear&aacute; en
        <code class="filename">WEB-INF/views/menu.xml</code>.</p>
      </li><li>
        <p><span class="emphasis"><em>Tagx</em></span> necesarios para el
        pintado del men&uacute;, almacenados en
        <code class="filename">WEB-INF/tags/menu</code>.</p>
      </li><li>
        <p>Una nueva p&aacute;gina jspx de la gesti&oacute;n del men&uacute; en la que se utilizan
        los <span class="emphasis"><em>tagx</em></span> de pintado del men&uacute;, creada en
        <code class="filename">WEB-INF/views/menu.jspx</code>.</p>
      </li><li>
        <p>Clases para el uso de los men&uacute;s
        contextuales. Estas clases se crear&aacute;n en el subpaquete
        <code class="filename">web.menu</code>.</p>
      </li></ol></div>

    <p>Para m&aacute;s informaci&oacute;n sobre el comando ver
    <span class="command"><strong><a class="link" href="#apendice-comandos_addon-web-menu_page-menu-setup" title="26.4.1.&nbsp;menu setup">menu
    setup</a></strong></span> en el <a class="link" href="#apendice-comandos_addon-web-menu" title="26.4.&nbsp;Comandos del add-on Web Menu">ap&eacute;ndice de comandos de este
    add-on</a>.</p>

    <p>El nombre del fichero XML que contiene el modelo de datos
    del men&uacute; se toma de la constante <code class="constant">MENU_CONFIG_FILE</code> de la
    clase anotada como <code class="classname">@GvNIXMenuLoader</code>.</p>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e2393"></a>15.4. Modificaci&oacute;n del men&uacute;.</h2></div></div></div>
    

    <p>Para hacer cambios en el men&uacute; se deben utilizar los comandos
    disponibles en la consola, que ser&aacute;n accesibles despu&eacute;s de haber
    instalado la nueva gesti&oacute;n del men&uacute;.</p>

    <p>Para mas informaci&oacute;n sobre los comandos ver el <a class="link" href="#apendice-comandos_addon-web-menu" title="26.4.&nbsp;Comandos del add-on Web Menu">ap&eacute;ndice de comandos de este
    add-on</a>.</p>
  </div>
  

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="addon-web-menu_futuras-versiones"></a>15.5. Futuras versiones</h2></div></div></div>
    

    <p>Mejoras a incluir en futuras versiones del
    add-on.</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p>El modelo de datos del men&uacute; actualmente se
        define en un archivo XML y en un futuro podr&aacute;
        estar almacenada en la base de datos.</p>
      </li></ul></div>
  </div>
  
</div>

    <div class="chapter" lang="es"><div class="titlepage"><div><div><h2 class="title"><a name="addon-web-screen-patterns"></a>Cap&iacute;tulo 16. Add-on Web Screen Patterns</h2></div></div></div>
  

  <p>Add-on para aplicar patrones de visualizaci&oacute;n sobre
  entidades y sus relaciones.</p>

  <p>&iquest;Qu&eacute; entendemos por patr&oacute;n de visualizaci&oacute;n? <a class="ulink" href="http://designingwebinterfaces.com/designing-web-interfaces-12-screen-patterns" target="_top">"12
  patrones de pantalla est&aacute;ndar"</a></p>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="addon-web-relation-styles_descripcion"></a>16.1. Descripci&oacute;n</h2></div></div></div>
    

    <p>El add-on permite aplicar patrones de visualizaci&oacute;n
    sobre una entidad determinada del proyecto y una o varias de sus relaciones
    con otras entidades. Los patrones actualmente soportados son:</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p>Maestro tabular</p>
      </li><li>
        <p>Maestro tabular con edici&oacute;n registro</p>
      </li><li>
        <p>Maestro registro</p>
      </li><li>
        <p>Maestro registro - Detalle tabular</p>
      </li><li>
        <p>Maestro registro - Detalle tabular con edici&oacute;n registro</p>
      </li><li>
        <p>Maestro tabular - Detalle tabular</p>
      </li><li>
        <p>Maestro tabular - Detalle tabular con edici&oacute;n registro</p>
      </li><li>
        <p>Maestro tabular con edici&oacute;n registro - Detalle tabular</p>
      </li><li>
        <p>Maestro tabular con edici&oacute;n registro - Detalle tabular con edici&oacute;n registro</p>
      </li></ul></div>

    <p>Cuando un patr&oacute;n maestro tiene alg&uacute;n detalle,
    el detalle de una entidad se corresponde con las relaciones 1 a n
    <span class="emphasis"><em>ONE_TO_MANY</em></span> o las relaciones n a n 
    <span class="emphasis"><em>MANY_TO_MANY</em></span> que tiene con otras entidades.
    As&iacute; mismo, un maestro puede tener m&uacute;ltiples detalles y ser&aacute;n visualizados
    en la parte inferior de la pantalla mediante una pesta&ntilde;a por cada
    una de las relaciones.</p>
  </div>
  
  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="addon-web-relation-styles_instalacion"></a>16.2. Instalaci&oacute;n</h2></div></div></div>
    
    
  	<p>El add-on ofrece el comando <a class="link" href="#apendice-comandos_addon-web_mvc_pattern_install" title="26.5.1.&nbsp;web mvc pattern install">
    web mvc pattern install</a> que crea en el proyecto los
    ficheros que utilizar&aacute;n los patrones de visualizaci&oacute;n.</p>
    
    <div class="itemizedlist"><ul type="disc"><li>
        <p>Nuevas librer&iacute;as de tags e inclusi&oacute;n de nuevos tags en librer&iacute;as existentes</p>
      </li><li>
        <p>Im&aacute;genes utilizadas para mostrar distintos controles y mensajes</p>
      </li><li>
        <p>Librer&iacute;as javascript para realizar ciertas acciones en el lado cliente</p>
      </li><li>
        <p>Hojas de estilo css con la definici&oacute;n de los estilos visuales</p>
      </li><li>
        <p>Propiedades para el soporte de m&uacute;ltiples idiomas</p>
      </li></ul></div>
    
	<p>Si los ficheros ya se encontraban instalados en el
	proyecto, el comando los actualizar&aacute; en el caso de existir una nueva
    versi&oacute;n de dichos ficheros.</p>
    
  	<p>La ejecuci&oacute;n del comando realizar&aacute; las siguientes
  	modificaciones en el proyecto.</p>
    
	<pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>web mvc pattern install</strong></span>
	Created SRC_MAIN_WEBAPP/images/pattern
	Created SRC_MAIN_WEBAPP/images/pattern/enEdicion.gif
	Created SRC_MAIN_WEBAPP/images/pattern/pedi_off.gif
	Created SRC_MAIN_WEBAPP/images/pattern/pedi_on.gif
	Created SRC_MAIN_WEBAPP/images/pattern/pfil_off.gif
	Created SRC_MAIN_WEBAPP/images/pattern/pfil_on.gif
	Created SRC_MAIN_WEBAPP/images/pattern/plis_off.gif
	Created SRC_MAIN_WEBAPP/images/pattern/plis_on.gif
	Created SRC_MAIN_WEBAPP/images/pattern/refresh.gif
	Created SRC_MAIN_WEBAPP/scripts
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/dialog/message
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/pattern
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/pattern/form
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/pattern/form/fields
	Created SRC_MAIN_WEBAPP/WEB-INF/i18n/messages_ca.properties
	Updated SRC_MAIN_WEBAPP/WEB-INF/i18n/messages_ca.properties
	Updated SRC_MAIN_WEBAPP/WEB-INF/i18n/messages_es.properties
	Updated SRC_MAIN_WEBAPP/WEB-INF/i18n/messages.properties
	Created SRC_MAIN_WEBAPP/scripts/quicklinks.js
	Created SRC_MAIN_WEBAPP/styles/pattern.css
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/util/changes-control.tagx
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/util/panel-tab.tagx
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/util/panel-tabs.tagx
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/util/quicklink.tagx
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/util/quicklinks.tagx
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/util/slider.tagx
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/dialog/message/message-box.tagx
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/pattern/cancelbutton.tagx
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/pattern/contentpane.tagx
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/pattern/hiddengvnixpattern.tagx
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/pattern/paginationadd.tagx
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/pattern/paginationview.tagx
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/pattern/relation.tagx
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/pattern/relations.tagx
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/pattern/tabcontainer.tagx
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/pattern/form/show.tagx
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/pattern/form/update.tagx
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/pattern/form/updateregister.tagx
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/pattern/form/fields/checkbox.tagx
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/pattern/form/fields/contentpane.tagx
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/pattern/form/fields/datetime.tagx
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/pattern/form/fields/input.tagx
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/pattern/form/fields/select-withempty.tagx
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/pattern/form/fields/select.tagx
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/pattern/form/fields/selectFinder.tagx
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/pattern/form/fields/selectRelated.tagx
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/pattern/form/fields/simple.tagx
	Created SRC_MAIN_WEBAPP/WEB-INF/tags/pattern/form/fields/textarea.tagx</pre>
  	
    <p>Algunos de los componentes que se incluyen en el
    proyecto no son utilizados autom&aacute;ticamente por los patrones de visualizaci&oacute;n,
    sino que ser&aacute;n &uacute;tiles para modificar el comportamiento de ciertas
    funcionalidades en la aplicaci&oacute;n.</p>
  	
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="addon-web-relation-styles_creacion"></a>16.3. Creaci&oacute;n de un patr&oacute;n</h2></div></div></div>
    

    <p>El add-on proporciona una serie de anotaciones que
    sirven para definir patrones de visualizaci&oacute;n sobre el controlador de una
    entidad de la aplicaci&oacute;n. Por comodidad se han definido una serie de <a class="link" href="#apendice-comandos_web-relation-styles" title="26.5.&nbsp;Comandos del add-on Web Screen Patterns">comandos</a> para
    facilitar la aplicaci&oacute;n de estas anotaciones en las clases Java
    necesarias.</p>

    <p>Al definir un patr&oacute;n de visualizaci&oacute;n sobre un
    controlador, se est&aacute; definiendo un patr&oacute;n maestro para la entidad gestionada
    por dicho controlador. Al definir un patr&oacute;n de visualizaci&oacute;n sobre un
    controlador y una relaci&oacute;n, se est&aacute; definiendo un patr&oacute;n detalle 
    para la entidad relacionada.</p>

    <p>Suponiendo el siguiente escenario codificado en Java
    :</p>

    <pre class="programlisting">@RooJpaActiveRecord
	public class Entidad1 {
	  @OneToMany
	  Set&lt;Entidad2&gt; campo2;
	  @OneToMany
	  Set&lt;Entidad3&gt; campo3;
	  ...
	}
	
	@RooJpaActiveRecord
	public class Entidad2 {
	  ...
	}</pre>

    <p>El c&oacute;digo anterior declara una
    <span class="emphasis"><em>Entidad1</em></span> que tiene un <span class="emphasis"><em>campo2</em></span> que
    define a su vez una relaci&oacute;n 1 a n con la <span class="emphasis"><em>Entidad2</em></span>,
    lo mismo con la relaci&oacute;n definida en el <span class="emphasis"><em>campo3</em></span>. La
    <span class="emphasis"><em>Entidad1</em></span> est&aacute; expuesta mediante el
    <span class="emphasis"><em>Controlador1</em></span>, a su vez la
    <span class="emphasis"><em>Entidad2</em></span> lo est&aacute; mediante el
    <span class="emphasis"><em>Controlador2</em></span>.</p>

    <pre class="programlisting">@RooWebScaffold(..., formBakingObject=Entidad1.class)
	@Controller
	public class Controlador1 {
	  ...
	}
	
	@RooWebScaffold(..., formBackingObject=Entidad2.class)
	@Controller
	public class Controlador2 {
	  ...
	}
	</pre>

  	<div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="addon-web-relation-styles_creacion-maestro"></a>16.3.1. Creaci&oacute;n de un patr&oacute;n maestro</h3></div></div></div>
  		

	    <p>Mediante el commando <span class="emphasis"><em>web mvc
	    pattern</em></span> es posible definir un patr&oacute;n de visualizaci&oacute;n maestro
	    sobre el controlador de cualquier entidad. Al usar el comando,
	    adem&aacute;s de a&ntilde;adir la anotaci&oacute;n <span class="emphasis"><em>@GvNIXPattern</em></span> al
	    controlador elegido, se instalar&aacute;n / crear&aacute;n / modificar&aacute;n los componentes
	    Spring MVC necesarios (diferentes archivos tagx, jspx, im&aacute;genes, javascript,
	    ...) y se generar&aacute;n los aspectos Java apropiados para lograr
	    visualizar el patr&oacute;n elegido.</p>
	</div>

  	<div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="addon-web-relation-styles_creacion-detalle"></a>16.3.2. Creaci&oacute;n de un patr&oacute;n detalle</h3></div></div></div>
  		

	    <p>El comando <span class="emphasis"><em>web mvc pattern
	    detail</em></span> permite definir el formato de visualizaci&oacute;n del detalle
	    de una entidad dado su controlador, esto es, como se visualizar&aacute;n las entidades
	    relacionadas al visualizar la entidad maestra. Notar que el comando se
	    aplica sobre un campo, una relaci&oacute;n, determinada de la entidad maestra (en
	    el ejemplo propuesto, se aplicar&iacute;a el comando una vez sobre
	    <span class="emphasis"><em>campo2</em></span> y opcionalmente otra vez sobre
	    <span class="emphasis"><em>campo3</em></span>). Este comando tambi&eacute;n instala / crea /
	    modifica componentes Spring MVC, a&ntilde;ade la anotaci&oacute;n
	    <span class="emphasis"><em>@GvNIXRelationsPattern</em></span> en el controlador de la
	    entidad maestra y a&ntilde;ade la anotaci&oacute;n
	    <span class="emphasis"><em>@GvNIXRelatedPattern</em></span> sobre el controlador de la
	    entidad detalle. Estas anotaciones har&aacute;n que se genere, en caso
	    necesario, los aspectos Java que hacen posible la visualizaci&oacute;n
	    del patr&oacute;n seleccionado.</p>

	    <p>Para aplicar un patr&oacute;n detalle sobre un
	    controlador, es necesario definir previamente un patr&oacute;n
	    maestro sobre el mismo controlador. Es decir, el controlador
	    debe tener definida la anotaci&oacute;n <span class="emphasis"><em>@GvNIXPattern</em></span>.
	    </p>
	</div>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e2486"></a>16.4. Tipos de patrones</h2></div></div></div>
    

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="d4e2488"></a>16.4.1. Tabular</h3></div></div></div>
      
      
      <p>Este patr&oacute;n se identifica mediante el c&oacute;digo
      <span class="emphasis"><em>tabular</em></span>.</p>

      <p>El patr&oacute;n tabular define una visualizaci&oacute;n de varios registros
      simultaneos con la posibilidad de desplazarse a lo largo de todos los
      registros existentes mediante paginaci&oacute;n.</p>

      <p>Las operaciones de creaci&oacute;n, actualizaci&oacute;n y borrado en este
      formato de visualizaci&oacute;n se pueden realizar sobre varios registros
      de forma simult&aacute;nea. Estas operaciones se realizar&aacute;n de forma transaccional,
      con lo que el fallo de una operaci&oacute;n sobre un registro provocar&iacute;a que todo
      el proceso fallase y todos los registros involucrados en la operaci&oacute;n
      permanecer&iacute;an inalterados.</p>

      <p>El Add-on Web Screen Pattern, genera los componentes necesarios para
      mostrar una entidad en formato tabular. Por defecto, la jspx
      asociada a este patr&oacute;n utiliza el componente
      <span class="emphasis"><em>&lt;form:update/&gt;</em></span> de la librer&iacute;a de tags
      <span class="emphasis"><em>/pattern/form</em></span>.</p>

      <p>Este formato de visualizaci&oacute;n por defecto muestra y habilita el campo
      que representa el identificador de la entidad en el formulario de creaci&oacute;n
      y actualizaci&oacute;n. En ocasiones esto puede ser &uacute;til en entidades en las que
      el identificador haya de ser establecida a mano por el usuario. Otras veces,
      en cambio, se desea que el identificador sea generado autom&aacute;ticamente.
      El tagx <span class="emphasis"><em>&lt;form:update/&gt;</em></span> dispone de un
      atributo <span class="bold"><strong>idDisabled</strong></span> que establecido con el valor
      <span class="emphasis"><em>true</em></span>, deshabilita el campo en los formularios de
      forma que el usuario no puede establecer ning&uacute;n valor en este campo para
      evitar confusiones, pues ser&aacute; el proveedor de persistencia el que se
      ocupe de establecer el valor de este campo usando la generaci&oacute;n autom&aacute;tica de
      identificadores. Tambi&eacute;n se espera que el campo identificador de la
      entidad sea el campo con nombre <span class="emphasis"><em>id</em></span>, si por alg&uacute;n motivo
      no fuese el caso, se puede indicar el campo que hace las veces de identificador
      mediante el atributo <span class="bold"><strong>idField</strong></span>.</p>

      <p>Otro atributo con el que cuenta el tagx de update es el
      atributo <span class="bold"><strong>finder</strong></span> cuyo valor indica un
      buscador al que se podr&aacute; acceder mediante la <span class="emphasis"><em>pesta&ntilde;a lupa</em></span>
      que se muestra a la derecha de la caja principal de la vista del patr&oacute;n
      tabular.</p>
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="d4e2506"></a>16.4.2. Registro</h3></div></div></div>
      

      <p>Este patr&oacute;n se identifica mediante el c&oacute;digo
      <span class="emphasis"><em>register</em></span>.</p>

      <p>Este patr&oacute;n realiza la visualizaci&oacute;n de un &uacute;nico registro pero con la
      posibilidad de avanzar, mediante paginaci&oacute;n de uno en uno, entre todos
      los registros existentes.</p>

      <p>La generaci&oacute;n autom&aacute;tica de c&oacute;digo de este patr&oacute;n posiciona los
      campos de la entidad unos debajo de otros. A parte de generar la
      jspx propia del patr&oacute;n, tambi&eacute;n modifica las jspx <span class="emphasis"><em>create,
      update y show</em></span> de la entidad. En todas estas jspx los campos
      de la entidad se incrustan dentro de elementos HTML de tipo lista
      <span class="emphasis"><em>&lt;ul&gt;&lt;li&gt;campo_entidad&lt;/li&gt;&lt;/ul&gt;</em></span>.
      Con esto se permite personalizar la posici&oacute;n de cada uno de los campos de la
      entidad en estas jspx moviendo los elementos
      <span class="emphasis"><em>&lt;li&gt;campo_entidad&lt;/li&gt;</em></span> dentro de otros elementos
      <span class="emphasis"><em>&lt;ul/&gt;</em></span> de forma que los campos se mostrar&aacute;n en
      columnas. El CSS de la aplicaci&oacute;n est&aacute; preparado para ello.</p>
      
      <p>Por ejemplo, para el siguiente c&oacute;digo extra&iacute;do de
      <span class="emphasis"><em>show.jspx</em></span>:</p>

      <pre class="programlisting">&lt;ul class="formInline" id="ul_com_springsource_petclinic_domain_Pet_name"&gt;
  &lt;li class="size120" id="li_com_springsource_petclinic_domain_Pet_name"&gt;
    &lt;field:input field="name" id="c_com_springsource_petclinic_domain_Pet_name"
    		min="1" required="true" z="ZY+k75JeSo9RmejYZRFNIvs2aBg="/&gt;
  &lt;/li&gt;
&lt;/ul&gt;
&lt;ul class="formInline" id="ul_com_springsource_petclinic_domain_Pet_weight"&gt;
  &lt;li class="size120" id="li_com_springsource_petclinic_domain_Pet_weight"&gt;
    &lt;field:input field="weight" id="c_com_springsource_petclinic_domain_Pet_weight"
    		min="0" required="true" validationMessageCode="field_invalid_number"
    		z="cOD5zE/z7gy+RZu5kVSPuxCa+/I="/&gt;
  &lt;/li&gt;
&lt;/ul&gt;</pre>

      <p>donde los campos <span class="emphasis"><em>name</em></span> y <span class="emphasis"><em>weight</em></span>
      se visualizan uno debajo de otro, se puede modificar por:</p>

      <pre class="programlisting">&lt;ul class="formInline" id="ul_com_springsource_petclinic_domain_Pet_name"&gt;
  &lt;li class="size120" id="li_com_springsource_petclinic_domain_Pet_name"&gt;
    &lt;field:input field="name" id="c_com_springsource_petclinic_domain_Pet_name"
    		min="1" required="true" z="ZY+k75JeSo9RmejYZRFNIvs2aBg="/&gt;
  &lt;/li&gt;
  &lt;li class="size120" id="li_com_springsource_petclinic_domain_Pet_weight"&gt;
    &lt;field:input field="weight" id="c_com_springsource_petclinic_domain_Pet_weight"
    		min="0" required="true" validationMessageCode="field_invalid_number"
    		z="cOD5zE/z7gy+RZu5kVSPuxCa+/I="/&gt;
  &lt;/li&gt;
&lt;/ul&gt;</pre>

      <p>donde los campos <span class="emphasis"><em>name</em></span> y <span class="emphasis"><em>weight</em></span>
      se visualizan uno junto al otro en la misma fila.</p>

      <p>La jspx propia del patr&oacute;n registro usa el componente
      <span class="emphasis"><em>show.tagx</em></span> de la librer&iacute;a de tags<span class="emphasis"><em>
      pattern</em></span>.</p>

      <pre class="programlisting">&lt;page:show id="ps_com_springsource_petclinic_domain_Pet" object="${pet}" path="/pets"
      		z="FrMAP8iVoUnyo/I+XWaK7GumSjc="&gt;</pre>

      <p>Este componente acepta algunos atributos interesantes:</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p><span class="emphasis"><em>list = true|false</em></span> indica si se desea
          mostrar un icono que da acceso mediante un enlace a la vista list
          de la Entidad.</p>
        </li><li>
          <p><span class="emphasis"><em>create = true|false</em></span> indica si se desea
          mostrar el icono que da acceso al formulario de creaci&oacute;n de un nuevo
          registro.</p>
        </li><li>
          <p><span class="emphasis"><em>update = true|false</em></span> indica si se desea
          mostrar el icono que enlaza con el formulario de edici&oacute;n del
          registro visualizado.</p>
        </li><li>
          <p><span class="emphasis"><em>delete = true|false</em></span> indica si se desea
          habilitar el borrado de registros desde esta vista.</p>
        </li><li>
          <p><span class="emphasis"><em>finder = NombreBuscador</em></span> (ejemplo
          <span class="emphasis"><em>finder="ByOwner"</em></span>) si est&aacute; establecido, en la
          vista del patr&oacute;n registro se mostrar&aacute; un enlace que llevar&aacute; al
          buscador indicado por el valor del atributo. Este enlace se representa
          mediante una <span class="emphasis"><em>pesta&ntilde;a con una lupa</em></span>, a la derecha de la caja principal
          de la vista del patr&oacute;n.</p>
        </li></ul></div>
    </div>

  </div>
</div>

    <div class="chapter" lang="es"><div class="titlepage"><div><div><h2 class="title"><a name="addon-persistence"></a>Cap&iacute;tulo 17. Add-on OCC (Optimistic Concurrency Control)</h2></div></div></div>
  

  <p>Add-on de utilidades enfocadas a la persistencia de las
  entidades.</p>

  <p>Este add-on proporciona un sistema
  que facilita la detecci&oacute;n de modificaciones concurrentes
  en la persistencia de entidades del modelo de datos.</p>

  <p>El sistema consiste en un control de
  <span class="emphasis"><em>concurrencia optimista</em></span> basada en un
  <span class="emphasis"><em>checkSum o suma de control</em></span> de los
  valores de una entidad dada.</p>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="addon-persistence_occchecksum"></a>17.1. Introducci&oacute;n</h2></div></div></div>
    

    <p>Esta utilidad a&ntilde;ade a las entidades un sistema
    de <span class="emphasis"><em>control de concurrencia</em></span> basado en una operaci&oacute;n de
    <span class="emphasis"><em>checksum o suma de control</em></span> sobre todos los campos persistentes
    que contiene la entidad.</p>

    <p>El <span class="emphasis"><em>control de concurrencia optimista</em></span>
    ya es ofrecido por defecto por el n&uacute;cleo de Spring Roo. Sin embargo, el sistema que proporciona
    se basa en la existencia de un campo en cada una de las tabla de base de datos
    que se desea controlar. Este campo se suele definir como <span class="emphasis"><em>version</em></span>
    (num&eacute;rico que identifica la versi&oacute;n del objeto) o <span class="emphasis"><em>lastupdate</em></span> (fecha
    de la &uacute;ltima actualizaci&oacute;n). Esto es un problema para aquellas bases de datos ya
    existentes y en las que no se puede o no se quiere alterar su estructura.</p>

    <p>Esta funcionalidad nace de la necesidad de controlar
    la concurrencia sobre modelos de datos heredados en los que no es posible
    alterar el modelo relacional de base de datos para a&ntilde;adir los campos de control
    en los que se basa el mecanismo de <span class="emphasis"><em>control de concurrencia</em></span>
    del n&uacute;cleo de Spring Roo que sigue la especificaci&oacute;n <a class="ulink" href="http://jcp.org/aboutJava/communityprocess/final/jsr220/index.html" target="_top">
    JPA</a>.</p>

    <p>El checksum consiste en una operaci&oacute;n matem&aacute;tica
    de los distintos valores que contiene un registro (instancia) de una entidad.
    El c&aacute;lculo tiene en cuenta todas las propiedad de tipo simple de la entidad,
    es decir, no se incluye en el c&aacute;lculo propiedad que represente una relaci&oacute;n con otro
    u otros objetos. El c&aacute;lculo se realiza en el momento de la carga
    del registro de la entidad desde la base de datos y es
    almacenado en una propiedad no persistente de la misma entidad.</p>

    <p>En el momento de <span class="emphasis"><em>actualizar o
    eliminar</em></span> un registro de dicha entidad se carga el elemento que
    est&aacute; persistido en la base de datos y <span class="emphasis"><em>se compara el valor de
    checksum</em></span> actual con el que se calcul&oacute; en el momento de la carga del
    elemento a actualizar o eliminar. <span class="emphasis"><em>Si no coincide se lanza una
    Excepci&oacute;n </em></span>(<a class="ulink" href="http://docs.oracle.com/javaee/6/docs/api/javax/persistence/OptimisticLockException.html" target="_top">
    javax.persistence.OptimisticLockException</a>) y la operaci&oacute;n no se realizar&aacute;.</p>

    <p>Esta operaci&oacute;n supone un coste adicional en las tareas
    de persistencia, pero no es apreciable en condiciones del uso
    cuotidiano de la aplicaci&oacute;n excepto en procesos de actualizaciones masivas
    de registros.</p>
    
  </div>
  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="addon-persistence_incluir"></a>17.2. A&ntilde;adir el control en las entidades</h2></div></div></div>
    

    <p>Para activar esta caracter&iacute;stica sobre una entidad se
    pueden utilizar los siguientes comandos:</p>

    <div class="variablelist"><dl><dt><span class="term"><a class="link" href="#apendice-comandos_addon-persistence_occchecksum_occ-checksum-set" title="26.1.1.&nbsp;occ checksum set">occ
        checksum set</a></span></dt><dd>
          <p>Aplica el control de concurrencia a una
          entidad.</p>
        </dd><dt><span class="term"><a class="link" href="#apendice-comandos_addon-persistence_occchecksum_occ-checksum-all" title="26.1.2.&nbsp;occ checksum all">occ
        checksum all</a></span></dt><dd>
          <p>Aplica el control de concurrencia a todas
          las entidades de la aplicaci&oacute;n.</p>
        </dd></dl></div>

    <p>Estos comandos a&ntilde;aden a uno o a todos los ficheros
    <code class="filename">.java</code> de las entidades una anotaci&oacute;n
    <code class="classname">@GvNIXEntityOCCChecksum</code> y un campo no persistente
    para almacenar el checksum. En base a esta anotaci&oacute;n se
    generar&aacute; un <span class="emphasis"><em>aspecto java</em></span> (fichero
    <code class="filename">*_gvNIX_occChecksum.aj</code>) con toda la l&oacute;gica necesaria
    para calcular el checksum en base a las propiedades de un registro de
    la entidad y para controlar antes de una actualizaci&oacute;n o borrado si el
    registro ha cambiado desde que se cargo inicialmente.
    Toda esta l&oacute;gica sera manejada autom&aacute;ticamente por el add-on.</p>

    <p>Si se aplica el control de concurrencia sobre
    una entidad que extiende de otra y en la clase padre existe un campo
    anotado como campo de control de persistencia con 
    @javax.persistence.Version, el add-on detectar&aacute; esta
    circunstancia y aplicar&aacute; el control de concurrencia sobre la
    clase padre.</p>

    <p>Para ver todos los comandos y sus opciones ver el
    <a class="link" href="#apendice-comandos_addon-persistence" title="26.1.&nbsp;Comandos del add-on OCC">ap&eacute;ndice
    de comandos</a>.</p>

    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Nota</h3>
      <p>Se ha detectado que al aplicar este control de concurrencia
      sobre entidades que tienen generados, o sobre los que se van a generar,
      tests de integraci&oacute;n (mediante el comando <span class="emphasis"><em>test
      integration</em></span> o mediante la opci&oacute;n <span class="emphasis"><em>--testAutomatically</em></span>
      del comando <span class="emphasis"><em>entity jpa</em></span>) los tests de integraci&oacute;n presentar&aacute;n un error
      de compilaci&oacute;n. Se debe a que el add-on que genera los tests de integraci&oacute;n no
      considera el caso en el que el campo que hace de control de concurrencia sea
      del tipo cadena. Hay varias opciones para evitar estos errores de compilaci&oacute;n:</p>

      <div class="orderedlist"><ol type="1"><li>
          <p>No es recomendable, pero se pueden desactivar los tests
          de los m&eacute;todos <span class="emphasis"><em>flush()</em></span> y
          <span class="emphasis"><em>merge()</em></span> (m&eacute;todos
          <span class="emphasis"><em>testFlush()</em></span> y
          <span class="emphasis"><em>testMerge()</em></span>). Para ello hay que editar los
          archivos <span class="emphasis"><em>src/test/java/**/*IntegrationTest.java</em></span>
          y a&ntilde;adir a la anotaci&oacute;n <span class="emphasis"><em>@RooIntegrationTest</em></span> los
          atributos <span class="emphasis"><em>flush = false</em></span> y <span class="emphasis"><em>merge =
          false</em></span>, de esta manera estos dos tests no se generan
          en sus aspecto Java correspondiente quedando la bater&iacute;a de pruebas
          incompleta pero compilando correctamente:</p>

          <pre class="programlisting">@RooIntegrationTest(entity = MiClase.class, <span class="bold"><strong>flush = false, merge = false</strong></span>)</pre>
        </li><li>
          <p>La m&aacute;s recomendable es corregir los dos test mencionados en el
          punto anterior. Para ello se debe realizar un <span class="emphasis"><em>pushin</em></span>
          de estos dos m&eacute;todos que se encuentran declarados en
          <span class="emphasis"><em>src/test/java/**/*IntegrationTest_Roo_IntegrationTest.aj</em></span>
          y tambi&eacute;n el campo &lt;nombre_entidad&gt;DataOnDemand dod, anotado
          con @Autowired, llevandolos a la clase Java del test de
          integraci&oacute;n. Una vez los test est&aacute;n en la clase Java, se pueden corregir
          los errores de compilaci&oacute;n reemplazando el operador
          <span class="emphasis"><em>"&gt;"</em></span> por el m&eacute;todo
          <span class="emphasis"><em>equals</em></span>. A continuaci&oacute;n se muestra un ejemplo
          extraido del proyecto de ejemplo petclinic que se distribuye junto a
          gvNIX/Roo en el que se han corregido las l&iacute;neas marcadas en negrita
          para los m&eacute;todos <span class="emphasis"><em>testFlush()</em></span> y
          <span class="emphasis"><em>testMerge()</em></span>.</p>

          <pre class="programlisting">package com.springsource.petclinic.domain;

import org.junit.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.roo.addon.test.RooIntegrationTest;

@RooIntegrationTest(entity = Owner.class)
public class OwnerIntegrationTest {
    @Autowired
    private OwnerDataOnDemand dod;

    @Test
    public void testMarkerMethod() {

    }

    @Test
    public void testFlush() {
        com.springsource.petclinic.domain.Owner obj = dod.getRandomOwner();
        org.junit.Assert.assertNotNull(
        		"Data on demand for 'Owner' failed to initialize correctly", obj);
        java.lang.Long id = obj.getId();
        org.junit.Assert.assertNotNull(
        		"Data on demand for 'Owner' failed to provide an identifier", id);
        obj = com.springsource.petclinic.domain.Owner.findOwner(id);
        org.junit.Assert.assertNotNull(
        		"Find method for 'Owner' illegally returned null for id '"
        		+ id + "'", obj);
        boolean modified =  dod.modifyOwner(obj);
        java.lang.String currentVersion = obj.getOccChekcsum();
        obj.flush();
        org.junit.Assert.assertTrue(
        		"OccCheckSum for 'Owner' failed to modify on flush directive", 
        		(currentVersion != null &amp;&amp;
        		<span class="bold"><strong>obj.getOccChekcsum().equals(currentVersion)</strong></span>) ||
        		!modified);
    }

    @Test
    public void testMerge() {
        com.springsource.petclinic.domain.Owner obj = dod.getRandomOwner();
        org.junit.Assert.assertNotNull(
        		"Data on demand for 'Owner' failed to initialize correctly", obj);
        java.lang.Long id = obj.getId();
        org.junit.Assert.assertNotNull(
        		"Data on demand for 'Owner' failed to provide an identifier", id);
        obj = com.springsource.petclinic.domain.Owner.findOwner(id);
        boolean modified =  dod.modifyOwner(obj);
        java.lang.String currentVersion = obj.getOccChekcsum();
        com.springsource.petclinic.domain.Owner merged = (
        		com.springsource.petclinic.domain.Owner) obj.merge();
        obj.flush();
        org.junit.Assert.assertEquals(
        		"Identifier of merged object not the same as identifier of " + 
        				"original object",
        		merged.getId(), id);
        org.junit.Assert.assertTrue(
        		"OccCheckSum for 'Owner' failed to modify on merge and flush " + 
        				"directive", 
        		(currentVersion != null &amp;&amp;
        		<span class="bold"><strong>obj.getOccChekcsum().equals(currentVersion)</strong></span>)
        		|| !modified);
    }
}</pre>
        </li></ol></div>
    </div>
  </div>
</div>

    <div class="chapter" lang="es"><div class="titlepage"><div><div><h2 class="title"><a name="addon-web-dialog"></a>Cap&iacute;tulo 18. Add-on Web Dialog</h2></div></div></div>
  

  <p>Add-on para la gesti&oacute;n de excepciones no controladas
  y de mensajes de usuario.</p>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="addon-web-exception-handler_descripcion"></a>18.1. Descripci&oacute;n</h2></div></div></div>
    

    <p>Este add-on permite gestionar las excepciones no
    controladas en el c&oacute;digo de la aplicaci&oacute;n y as&iacute; mostrar
    mensajes inteligibles al usuario en una ventana modal (pop-up)
    y en el idioma actual de la aplicaci&oacute;n sin necesidad de realizar ning&uacute;n
    desarrollo en la capa web.</p>

    <p>El add-on, al aplicarse sobre un proyecto, por defecto configura
    ciertas excepciones que ser&aacute;n visualizadas de forma amigable al usuario
    en el caso de no ser gestionadas directamente desde la aplicaci&oacute;n. As&iacute; mismo, se
    pueden incluir nuevas excepciones y modificar los textos amigables que se mostrar&aacute;n
    en lugar de la excepci&oacute;n para cada idioma disponible en la aplicaci&oacute;n.</p>
    
    <p>El add-on tambi&eacute;n permite mostrar mensajes de
    usuario sin realizar ninguna implementaci&oacute;n en la capa web mediante la invocaci&oacute;n
    de m&eacute;todos desde el controlador que son los encargados de mostrar
    dichos mensajes en la pantalla del usuario.</p>

    <p>Los mensajes de excepci&oacute;n y de usuario se
    muestran en un di&aacute;logo o ventana modal. Se permite adem&aacute;s la modificaci&oacute;n
    de las ventanas modales de excepci&oacute;n y de mensaje de usuario para
    que puedan ser personalizadas de acuerdo a los requerimientos
    que sean necesarios.</p>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e2635"></a>18.2. Instalaci&oacute;n</h2></div></div></div>
    

    <p>Para aplicar esta funcionalidad sobre un proyecto se debe
    ejecutar en primer lugar el comando
    <a class="link" href="#apendice-comandos_addon-web-dialog" title="26.3.&nbsp;Comandos del add-on Web Dialog">web mvc dialog setup</a>.
    Al hacerlo se incluye el soporte para di&aacute;logos modales en la aplicaci&oacute;n.</p>
    
    <p>El componente visual <span class="emphasis"><em>message-box.tagx</em></span>
    que instala el add-on es el encargado de mostrar en pantalla un di&aacute;logo
    modal al usuario.</p>
    
    <p>Al mismo tiempo, la ejecuci&oacute;n de este comando configura una serie de
    excepciones que ser&aacute;n mapeadas con sus respectivos di&aacute;logos modales y mensajes
    amigables en m&uacute;ltiples idiomas. En las siguiente secciones se ver&aacute; m&aacute;s detalladamente
    las excepciones controladas y el uso de los di&aacute;logos modales.</p>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="addon-web-exception-handler_excptiones-de-gvnix"></a>18.3. Excepciones controladas por gvNIX</h2></div></div></div>
    

    <p>Conjunto de excepciones inicialmente definidas y
    controladas por gvNIX al ejecutar el comando
    <span class="emphasis"><em>web mvc dialog setup</em></span>.</p>

    <div class="itemizedlist"><ul type="disc"><li>
          <p>java.sql.SQLException.</p>

          <p>Se ha producido un error en el acceso a la base
          de datos.</p>
        </li><li>
          <p>java.io.IOException.</p>

          <p>Existen problemas para enviar o recibir
          datos.</p>
        </li><li>
          <p>org.springframework.transaction.TransactionException.</p>

          <p>Se ha producido un error en la transacci&oacute;n. No
          se han guardado los datos correctamente.</p>
        </li><li>
          <p>java.lang.UnsupportedOperationException.</p>

          <p>Se ha producido un error no controlado.</p>
        </li><li>
          <p>javax.persistence.OptimisticLockException.</p>

          <p>No se puede actualizar el registro debido a que
          ha sido actualizado previamente.</p>
        </li></ul></div>

    <p>Las excepciones se muestran mediante un dialogo modal.
    Para ello, se modifica la definici&oacute;n, en el
    archivo webmvc-config.xml, del bean
    <span class="emphasis"><em>SimpleMappingExceptionResolver</em></span> reemplazando la clase 
    que se define por
    una propia. La clase propia se encontrar&aacute; instalada en el proyecto 
    en la clase <span class="emphasis"><em>MessageMappingExceptionResolver.java</em></span>
    del subpaquete <span class="emphasis"><em>web.servlet.handler</em></span>. En el
    subpaquete <span class="emphasis"><em>web.dialog</em></span> se instala tambi&eacute;n 
    la clase <span class="emphasis"><em>Dialog.java</em></span>, la cual es un bean
    que representa la informaci&oacute;n necesaria para visualizar una excepci&oacute;n en la
    ventana modal renderizada por el componente
    <span class="emphasis"><em>message-box.tagx</em></span>.</p>

    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="addon-web-exception-handler_funcionalidad"></a>18.3.1. A&ntilde;adir nuevas excepciones a la gesti&oacute;n</h3></div></div></div>
      

      <p>Pasos a seguir para incluir en la gesti&oacute;n
      autom&aacute;tica de excepciones de la aplicaci&oacute;n una nueva excepci&oacute;n.</p>

      <p>El Add-on proporciona ciertos comandos que permiten realizar
      de forma autom&aacute;tica las siguientes operaciones para la gesti&oacute;n de excepciones:</p>

      <div class="orderedlist"><ol type="1"><li>
          <p>A&ntilde;adir el control de una excepci&oacute;n a la aplicaci&oacute;n:</p>

          <div class="itemizedlist"><ul type="disc"><li>
              <p>Define la excepci&oacute;n a capturar en el bean
              <span class="emphasis"><em>messageMappingExceptionResolverBean</em></span> del archivo
              <span class="emphasis"><em>webmvc-config.xml</em></span>.</p>
            </li><li>
              <p>Asocia una direcci&oacute;n a la excepcion
              en un nuevo bean
              <span class="emphasis"><em>&lt;mvc:view-controller&gt;</em></span> en el archivo
              <span class="emphasis"><em>webmvc-config.xml</em></span>.</p>
            </li><li>
              <p>Crea la nueva jspx asociada a la
              excepci&oacute;n.</p>
            </li><li>
              <p>Instancia la jspx creada en el archivo
              <span class="emphasis"><em>views.xml</em></span> en el directorio
              <span class="emphasis"><em>WEB-INF</em></span> la aplicaci&oacute;n.</p>
            </li><li>
              <p>Crear las etiquetas multi idioma
              en los ficheros de propiedades de todos los idiomas
              que est&eacute;n instalados en la aplicaci&oacute;n.</p>
            </li></ul></div>
        </li><li>
          <p>Mostrar las excepciones gestionadas por la
          aplicaci&oacute;n:</p>

          <div class="itemizedlist"><ul type="disc"><li>
              <p>Muestra la lista de excepciones definidas en
              el bean <span class="emphasis"><em>messageMappingExceptionResolver</em></span> del
              archivo <span class="emphasis"><em>webmvc-config.xml</em></span>.</p>
            </li></ul></div>
        </li><li>
          <p>Eliminar excepciones controladas por la aplicaci&oacute;n:</p>

          <div class="itemizedlist"><ul type="disc"><li>
              <p>Elimina del fichero <span class="emphasis"><em>webmvc-config.xml</em></span>
              las referencias a la excepci&oacute;n y por lo tanto la quita de las excepciones
              gestionadas por la aplicaci&oacute;n.</p>
            </li><li>
              <p>Elimina la p&aacute;gina jspx asociada.</p>
            </li><li>
              <p>Elimina las referencias a la excepci&oacute;n en el
              archivo views.xml.</p>
            </li></ul></div>
        </li></ol></div>

      <p>Para obtener m&aacute;s informaci&oacute;n sobre estos comandos de gesti&oacute;n de
      excepciones consultar el apendice <a class="link" href="#apendice-comandos_addon-web-dialog" title="26.3.&nbsp;Comandos del add-on Web Dialog">Comandos del Add-on Web
      Dialog</a>.</p>
    </div>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="addon-web-exception-handler_nuevos-dialogos"></a>18.4. Nuevos di&aacute;logos modales</h2></div></div></div>
    

    <p>Estos di&aacute;logos son &uacute;tiles para mostrar mensajes al
    usuario informando de cualquier circunstanc&iacute;a tras una operaci&oacute;n
    determinada.</p>

    <p>Para aplicar esta funcionalidad sobre el proyecto primero se debe haber ejecutado
    el comando <a class="link" href="#apendice-comandos_addon-web-exception-handler_dialog-setup" title="26.3.1.&nbsp;web mvc dialog setup">web
    mvc dialog setup</a>.</p>
    
    <p>El comando <a class="link" href="#apendice-comandos_addon-web-exception-handler_dialog-add">web mvc
    dialog add</a> a&ntilde;ade la anotaci&oacute;n <span class="emphasis"><em>GvNIXModalDialogs</em></span>
    en la clase controladora que se le indica.</p>
    
    <pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>web mvc dialog add --class ~.web.PetController --name petsdialog</strong></span></pre>
    
    <p>La anotaci&oacute;n generar&aacute; dos m&eacute;todos asociados con el controlador.
    Un m&eacute;todo con el nombre <span class="emphasis"><em>modalDialog</em></span> y otro que tomar&aacute;
    como nombre el valor del par&aacute;metro <span class="emphasis"><em>name</em></span> del
    comando y una p&aacute;gina jspx en <span class="emphasis"><em>WEB-INF/dialogs</em></span>
    con tambi&eacute;n el mismo nombre.</p>
    
	<p>El m&eacute;todo <span class="emphasis"><em>modalDialog</em></span>
    permite al desarrollador mostrar di&aacute;logos modales gen&eacute;ricos
    en la parte visual directamente desde el c&oacute;digo Java del controlador.
    Para ello, el desarrollador proporcionar&aacute; un t&iacute;tulo, una descripci&oacute;n y un tipo de mensaje
    que ser&aacute; mostrado en la p&aacute;gina al usuario. La signatura del m&eacute;todo es:</p>
    
    <pre class="programlisting">modalDialog(DialogType dialogType, String title, String description,
    		HttpServletRequest httpServletRequest)</pre>
    
    <p>El segundo m&eacute;todo servir&aacute; para mostrar un mensaje espec&iacute;fico.
    La diferencia principal es que este nuevo m&eacute;todo tiene su
    propia p&aacute;gina jspx asociada y adem&aacute;s permite proporcionar
    par&aacute;metros adicionales a dicha p&aacute;gina,
    cosa que no permite el m&eacute;todo <span class="emphasis"><em>modalDialog</em></span>.</p>
    
    <pre class="programlisting">petsdialog(DialogType dialogType, String title, String description,
    		HashMap&lt;String, Object&gt; params, HttpServletRequest httpServletRequest)</pre>
    
    <p>Asociado a este m&eacute;todo tambi&eacute;n se habr&aacute; creado en
    <span class="emphasis"><em>WEB-INF/dialogs</em></span> una p&aacute;gina jspx con el nombre
    <span class="emphasis"><em>petsdialog.jspx</em></span> que podr&aacute; personalizarse seg&uacute;n
    las necesidades. El Map <span class="emphasis"><em>params</em></span> ser&aacute; proporcionado
    a la p&aacute;gina y por lo tanto el desarrollador puede insertar valores
    desde el controlador para utilizarlos en el di&aacute;logo.</p>
    
    <p>Los par&aacute;metros de cada uno de los dos m&eacute;todos anteriores
    definen la siguiente informaci&oacute;n:</p>

    <div class="variablelist"><dl><dt><span class="term">dialogType</span></dt><dd>
          <p>es un tipo enumerado que puede tomar
          como valores: Error, Info, Alert, Suggest. Cada uno define un
          nivel de severidad en el di&aacute;logo y producir&aacute; en el aspecto visual
          del di&aacute;logo que aparezca con distinto color e icono.</p>
        </dd><dt><span class="term">title</span></dt><dd>
          <p>es el c&oacute;digo del recurso i18n que se
          usar&aacute; como t&iacute;tulo del di&aacute;logo modal.</p>
        </dd><dt><span class="term">description</span></dt><dd>
          <p>es el c&oacute;digo del recurso i18n que se
          usar&aacute; como descripci&oacute;n del di&aacute;logo modal.</p>
        </dd><dt><span class="term">params</span></dt><dd>
          <p>es un Map que se puede utilizar para proporcionar
          tantos par&aacute;metros como sea necesario al componente visual del di&aacute;logo modal para
          confeccionarlo y mostrar en &eacute;l cualquier informaci&oacute;n necesaria.</p>
        </dd><dt><span class="term">httpServletRequest</span></dt><dd>
          <p>este par&aacute;metro se usa internamente en
          el m&eacute;todo para obtener la sesi&oacute;n del usuario y establecer un
          atributo que ser&aacute; leido por el componente message-box.tagx para
          mostrar el di&aacute;logo. Si al invocar el m&eacute;todo no se dispone de
          este par&aacute;metro, se puede obtener a&ntilde;adiendo el par&aacute;metro
          <span class="emphasis"><em>HttpServletRequest httpServletRequest</em></span>
          a los par&aacute;metros del m&eacute;todo que contiene la invocaci&oacute;n
          (esta es una caracter&iacute;stica especial de los m&eacute;todos
          que gestionan las URLs en Spring MVC y que permite declarar
          distintos par&aacute;metros de entre algunos dados).</p>
        </dd></dl></div>
    
    <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="d4e2760"></a>18.4.1. Ejemplos de dialogos personalizados</h3></div></div></div>
      

      <p>Con este nuevo soporte para crear di&aacute;logos modales gvNIX
      ofrece una gran libertad para maquetar multitud de mensajes de usuario o
      di&aacute;logos de la aplicaci&oacute;n (avisos, errores, mensajes de confirmaci&oacute;n,
      formularios, etc.).</p>

      <p>A continuaci&oacute;n se muestra una peque&ntilde;a demostraci&oacute;n de implementaci&oacute;n
      de algunos de estos mensajes personalizados.</p>

      <div class="section" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="d4e2764"></a>18.4.1.1. Mensaje de aviso de aplicaci&oacute;n</h4></div></div></div>
        

        <p>En ocasiones puede ser necesario que tras una acci&oacute;n (una
        petici&oacute;n al servidor) se muestre en la respuesta alg&uacute;n mensaje acerca del
        resultado de la operaci&oacute;n solicitada o, en el caso de pantallas de
        b&uacute;squeda, indicar que no se han encontrado resultados.</p>

        <p>Con el soporte de este add-on se puede incluir la siguiente l&iacute;nea
        de c&oacute;digo en cualquier punto de un m&eacute;todo de un controlador para
        definir un mensaje informativo.</p>

        <pre class="programlisting">modalDialog(DialogType.Info, "message_info_title", "message_description_key",
        		httpServletRequest);</pre>

      </div>

      <div class="section" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="d4e2769"></a>18.4.1.2. Mensaje de confirmaci&oacute;n</h4></div></div></div>
        

        <p>Puede ser necesario que tras una acci&oacute;n, la aplicaci&oacute;n deba
        preguntar si se desea ir a una p&aacute;gina en concreto. A continuaci&oacute;n
        se ver&aacute;n los pasos y cambios en el c&oacute;digo de un controlador
        para definir este mensaje de confirmaci&oacute;n.</p>

        <p>En el ejemplo, se va a a&ntilde;adir a la aplicaci&oacute;n de ejemplo petclinic un
        mensaje de confirmaci&oacute;n que consultar&aacute; al usuario si quiere ir al
        formulario de mascotas (Pets) tras actualizar la informaci&oacute;n de un
        propietario (Owner).</p>

        <div class="orderedlist"><ol type="1"><li>
            <p>A&ntilde;adir un di&aacute;logo modal a la aplicaci&oacute;n mediante
            "<span class="emphasis"><em>web mvc dialog message add</em></span>"</p>

            <pre class="programlisting">web mvc dialog add --class ~.web.OwnerController --name confirmgopets</pre>

            <p>Esto generar&aacute; un m&eacute;todo <span class="emphasis"><em>confirmgopets</em></span>
            disponible en <span class="emphasis"><em>OwnerController</em></span> y una jspx base
            llamada <span class="emphasis"><em>confirmgopets</em></span> en
            <span class="emphasis"><em>WEB-INF/dialogs</em></span> que ser&aacute; personalizada.</p>
          </li><li>
            <p>Modificar el m&eacute;todo <span class="emphasis"><em>update</em></span> de
            <span class="emphasis"><em>OwnerController</em></span> para a&ntilde;adir la llamada al
            m&eacute;todo <span class="emphasis"><em>confirmgopets</em></span> justo antes de la l&iacute;nea
            de <span class="emphasis"><em>return</em></span>. Para ello se debe llevar el
            m&eacute;todo <span class="emphasis"><em>update</em></span> desde
            <span class="emphasis"><em>OwnerController_Roo_Controller.aj</em></span> hasta
            <span class="emphasis"><em>OwnerController.java</em></span>, podemos usar la opci&oacute;n
            push-in que ofrece Eclipse. Una vez movido el m&eacute;todo, 
            ser&aacute; modificado quedando como sigue:</p>

            <pre class="programlisting">@RequestMapping(method = RequestMethod.PUT, produces = "text/html")
public String update(@Valid Owner owner, BindingResult bindingResult, Model uiModel,
		HttpServletRequest httpServletRequest) {
    if (bindingResult.hasErrors()) {
        populateEditForm(uiModel, owner);
        return "owners/update";
    }
    uiModel.asMap().clear();
    owner.merge();

    <span class="bold"><strong>HashMap&lt;String, Object&gt; dialogParams = new HashMap&lt;String, Object&gt;();
    dialogParams.put("petsFormLink", "/pets?form");
    confirmgopets(DialogType.Info, "message_confirm_action_title", 
    		"message_confirm_action_desc", dialogParams, httpServletRequest);</strong></span>

    return "redirect:/owners/" + encodeUrlPathSegment(owner.getId().toString(),
    		httpServletRequest);
}</pre>

            <p>Se ha resaltado en negrita la parte espec&iacute;fica que ha de modificarse
            para mostrar el di&aacute;logo modal.</p>

            <p>El HashMap <span class="emphasis"><em>dialogParams</em></span> permite
            proporcionar al componente message-box.tagx informaci&oacute;n adicional
            para mostrarla o utilizarla como sea necesario. En este caso, es necesario
            indicar a qu&eacute; p&aacute;gina dirigir al usuario en caso de que responda
            afirmativamente a la pregunta de confirmaci&oacute;n, pero se podr&iacute;a
            definir cualquier tipo de par&aacute;metro, desde un String hasta objetos
            del Modelo de la aplicaci&oacute;n o listas de objetos.</p>
          </li><li>
            <p>Modificar la jspx que ha creado el add-on
            (confirmgopets.jspx) para adecuarla a las necesidades del proyecto:</p>

            <pre class="programlisting">&lt;div xmlns:c="http://java.sun.com/jsp/jstl/core"
            		xmlns:util="urn:jsptagdir:/WEB-INF/tags/util"
            		xmlns:fn="http://java.sun.com/jsp/jstl/functions" 
            		xmlns:spring="http://www.springframework.org/tags"
            		xmlns:jsp="http://java.sun.com/JSP/Page" version="2.0"&gt;
  &lt;jsp:directive.page contentType="text/html;charset=UTF-8" /&gt;
  &lt;jsp:output omit-xml-declaration="yes" /&gt;
  &lt;spring:message var="title" code="${titleCode}" text="Message title"
  		htmlEscape="false" /&gt;
  &lt;util:panel id="title" title="${title}"&gt;
    &lt;h2&gt;${fn:escapeXml(title)}&lt;/h2&gt;
    &lt;p&gt;
     &lt;spring:message code="${descriptionCode}"
     		text="This is the dialog description ..." htmlEscape="false"/&gt;
    &lt;/p&gt;
    &lt;div class="closeMessage"&gt;
     &lt;spring:message var="closeButtonValue" code="button_close"/&gt;
     &lt;button class="boton" dojoType="dijit.form.Button" type="button"
       onClick="dijit.byId('${dialogId}').hide();"&gt;${closeButtonValue}&lt;/button&gt;
      &lt;spring:url value="<span class="bold"><strong>${dialogParams['petsFormLink']}</strong></span>" var="locationUrl"/&gt;
      &lt;spring:message var="confirmButtonValue" code="confirmButtonValue"/&gt;
      &lt;button class="boton" dojoType="dijit.form.Button" type="button"
        onClick="location.href = '${locationUrl}';"&gt;${confirmButtonValue}&lt;/button&gt;
    &lt;/div&gt;
  &lt;/util:panel&gt;
&lt;/div&gt;</pre>

            <p>En este caso se ha resaltado el accesso al HashMap de
            par&aacute;metros del di&aacute;logo (dialogParams) para demostrar el modo en que 
            se debe extraer los datos que le llegan al di&aacute;logo desde el controlador.</p>
          </li></ol></div>
      </div>

      <div class="section" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="d4e2802"></a>18.4.1.3. Di&aacute;logo modal con formulario</h4></div></div></div>
        

        <p>En alguna ocasi&oacute;n puede ser necesario mostrar un formulario en un
        di&aacute;logo modal para solicitar informaci&oacute;n al usuario, siguiendo el
        ejemplo anterior, se deber&iacute;a modificar la jspx que crea el add-on
        para incluir un formulario. En este ejemplo, tras crear un nuevo Owner
        en la aplicaci&oacute;n, se mostrar&aacute; un formulario para que cree su
        primera mascota.</p>

        <div class="orderedlist"><ol type="1"><li>
            <p>A&ntilde;adir un di&aacute;logo modal a la apliacai&oacute;n mediante
            "<span class="emphasis"><em>web mvc dialog message add</em></span>"</p>

            <pre class="programlisting">web mvc dialog add --class ~.web.OwnerController --name createPetInModal</pre>

            <p>Esto genera un m&eacute;todo <span class="emphasis"><em>createPetInModal</em></span>
            disponible en <span class="emphasis"><em>OwnerController</em></span> y una jspx base
            llamada <span class="emphasis"><em>createPetInModal</em></span> en
            <span class="emphasis"><em>WEB-INF/dialogs</em></span> que ser&aacute; personalizada.</p>
          </li><li>
            <p>Modifica el m&eacute;todo create de OwnerController. Al igual
            que en el ejemplo anterior debemos hacer el Push-in del m&eacute;todo. Lo
            modificamos para que quede como se muestra:</p>

            <pre class="programlisting">@RequestMapping(method = RequestMethod.POST, produces = "text/html")
public String create(@Valid Owner owner, BindingResult bindingResult, Model uiModel,
		HttpServletRequest httpServletRequest) {
    if (bindingResult.hasErrors()) {
        uiModel.addAttribute("owner", owner);
        addDateTimeFormatPatterns(uiModel);
        return "owners/create";
    }
    uiModel.asMap().clear();
    owner.persist();

    <span class="bold"><strong>HashMap&lt;String, Object&gt; dialogParams = new HashMap&lt;String, Object&gt;();
    Pet firstPetOfOwner = new Pet();
    dialogParams.put("pet", firstPetOfOwner);
    dialogParams.put("pettypes",  Arrays.asList(PetType.class.getEnumConstants()));
    createPetInModal(DialogType.Info, "message_create_pet_title",
    		"message_create_pet_desc", dialogParams, httpServletRequest);</strong></span>

    return "redirect:/owners/" + encodeUrlPathSegment(owner.getId().toString(),
    		httpServletRequest);
}</pre>
          </li><li>
            <p>Modificar la jspx incluyendo el formulario de creaci&oacute;n
            de mascotas (Pets):</p>

            <pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
&lt;div xmlns:c="http://java.sun.com/jsp/jstl/core"
		xmlns:field="urn:jsptagdir:/WEB-INF/tags/form/fields"
		xmlns:form="urn:jsptagdir:/WEB-INF/tags/form"
		xmlns:jsp="http://java.sun.com/JSP/Page"
		xmlns:spring="http://www.springframework.org/tags"
		version="2.0"&gt;
    &lt;jsp:directive.page contentType="text/html;charset=UTF-8"/&gt;
    &lt;jsp:output omit-xml-declaration="yes"/&gt;

    <span class="bold"><strong>&lt;c:set scope="request" var="pet" value="${dialogParams['pet']}" /&gt;
    &lt;c:set scope="request" var="pettypes" value="${dialogParams['pettypes']}" /&gt;
</strong></span>
    &lt;form:create id="fc_com_springsource_petclinic_domain_Pet" modelAttribute="pet"
    		path="/pets" render="${empty dependencies}" z="lgvEyAlAYOudDmaPjwU0ABseTIk="&gt;
        &lt;field:checkbox field="sendReminders"
        		id="c_com_springsource_petclinic_domain_Pet_sendReminders"
        		z="uPpMX+IWb0KONpvd11fpG8x4/4Q="/&gt;
        &lt;field:input field="name" id="c_com_springsource_petclinic_domain_Pet_name"
        		min="1" required="true" z="ZY+k75JeSo9RmejYZRFNIvs2aBg="/&gt;
        &lt;field:input field="weight" id="c_com_springsource_petclinic_domain_Pet_weight"
        		min="0" required="true" validationMessageCode="field_invalid_number"
        		z="cOD5zE/z7gy+RZu5kVSPuxCa+/I="/&gt;
        &lt;input type="hidden" id="c_com_springsource_petclinic_domain_Pet_owner"
        		name="owner" value="${owner.id}" /&gt;
        &lt;field:select field="owner" id="c_com_springsource_petclinic_domain_Pet_owner"
        		itemValue="id" items="${owners}" path="/owners" render="false" 
        		z="fGzswAP4XXvhPhowJKsRVve929c="/&gt;
        &lt;field:select field="type" id="c_com_springsource_petclinic_domain_Pet_type"
        		items="${pettypes}" path="pettypes" required="true" 
        		z="+hDCnUp+Y+A1RlT+AjH07sgipOo="/&gt;
    &lt;/form:create&gt;
    &lt;form:dependency dependencies="${dependencies}" 
    		id="d_com_springsource_petclinic_domain_Pet" render="${not empty dependencies}"
    		z="kThDNIW+69h9nI/69ynY1WyUieo="/&gt;
&lt;/div&gt;</pre>
          </li></ol></div>
      </div>
    </div>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="addon-web-exception-handler_futuras-versiones"></a>18.5. Futuras versiones</h2></div></div></div>
    

    <p>Mejoras a incluir en futuras versiones del
    add-on.</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p>Obtenci&oacute;n de las excepciones y los mensajes multi
        idioma de las excepciones no controladas que deben visualizarse de forma
        amigable desde una base de datos en la que se encuentra almacenada
        dicha informaci&oacute;n. As&iacute; podr&iacute;a definirse un repositorio central de
        excepciones para m&uacute;ltiples aplicaciones y sus mensajes amigables.</p>
      </li><li>
        <p>Env&iacute;o de un informe por email al responsable de la 
        aplicaci&oacute;n con informaci&oacute;n detallada cuando se ha producido una
        excepci&oacute;n.</p>
      </li></ul></div>
  </div>
</div>

    <div class="chapter" lang="es"><div class="titlepage"><div><div><h2 class="title"><a name="addon-cit-security"></a>Cap&iacute;tulo 19. Add-on CIT Security</h2></div></div></div>
         
  

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="addon-cit-security_descripcion"></a>19.1. Descripci&oacute;n</h2></div></div></div>
    

    <p>El add-on instala un cliente del servicio web de autenticaci&oacute;n y
    autorizaci&oacute;n que utiliza la Consejer&iacute;a de Infraestructuras, Transporte y
    Medio Ambiente (CITMA) y lo integra con el sistema de seguridad Spring Security.</p>

    <p>Para instalarlo, hay que utilizar el comando <a class="link" href="#apendice-comandos_addon-cit-security_cit-security-setup" title="26.6.1.&nbsp;cit security setup">cit
    security setup</a> con los par&aacute;metro adecuados (url del
    servicio, nombre de aplicaci&oacute;n y usuario/clave de acceso al servicio). El
    add-on instalar&aacute; las clases necesarias para hacer la llamada al servicio, el
    modelo de datos de usuario cumpliendo con los interfaces de Spring
    Security y el proveedor de autentificaci&oacute;n que sirve de pasarela entre los
    dos elementos.</p>
    
	<pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>cit security setup --url http://www.url.es --login usuario --password clave
			--appName aplicacion</strong></span>
	Created SPRING_CONFIG_ROOT/applicationContext-security.xml
	Created SRC_MAIN_WEBAPP/WEB-INF/views/login.jspx
	Updated SRC_MAIN_WEBAPP/WEB-INF/views/views.xml
	Updated ROOT/pom.xml [
			added property 'spring-security.version' = '3.1.0.RELEASE'; added dependencies 
			org.springframework.security:spring-security-core:${spring-security.version},
			org.springframework.security:spring-security-config:${spring-security.version},
			org.springframework.security:spring-security-web:${spring-security.version},
			org.springframework.security:spring-security-taglibs:${spring-security.version}]
	Updated SRC_MAIN_WEBAPP/WEB-INF/web.xml
	Updated SRC_MAIN_WEBAPP/WEB-INF/spring/webmvc-config.xml
	Created SRC_MAIN_JAVA/org/gvnix/test/security/authentication/wscit
	Created SRC_MAIN_JAVA/org/gvnix/test/security/authentication/wscit/
			ServerWSAuthBindingStub.java
	Created SRC_MAIN_JAVA/org/gvnix/test/security/authentication/wscit/ServerWSAuthPort.java
	Created SRC_MAIN_JAVA/org/gvnix/test/security/authentication/wscit/
			ServerWSAuthPortProxy.java
	Created SRC_MAIN_JAVA/org/gvnix/test/security/authentication/wscit/
			ServerWSAuthService.java
	Created SRC_MAIN_JAVA/org/gvnix/test/security/authentication/wscit/
			ServerWSAuthServiceLocator.java
	Created SRC_MAIN_JAVA/org/gvnix/test/security/authentication/wscit/
			WscitAuthenticationProvider.java
	Created SRC_MAIN_JAVA/org/gvnix/test/security/authentication/wscit/
			WscitUserAuthority.java
	Created SRC_MAIN_JAVA/org/gvnix/test/security/authentication/wscit/WscitUser.java
	Created SRC_MAIN_JAVA/org/gvnix/test/security/authentication/wscit/CredencialCIT.java
	Created SRC_MAIN_JAVA/org/gvnix/test/security/authentication/wscit/ModuloStruct.java
	Created SRC_MAIN_JAVA/org/gvnix/test/security/authentication/wscit/ValidaStruct.java
	Created SPRING_CONFIG_ROOT/CITWSAuth.properties
	Updated SPRING_CONFIG_ROOT/applicationContext-security.xml
	Updated SRC_MAIN_WEBAPP/WEB-INF/web.xml
	Created SRC_MAIN_JAVA/org/gvnix/test/security/authentication/wscit/
			WscitUserAuthority_Roo_JavaBean.aj
	Created SRC_MAIN_JAVA/org/gvnix/test/security/authentication/wscit/
			WscitUser_Roo_JavaBean.aj
	Updated ROOT/pom.xml [added dependency axis:axis:1.4]</pre>

    <p>Los par&aacute;metro de configuraci&oacute;n del cliente proporcionados
    a trav&eacute;s del comando quedar&aacute;n almacenados en el fichero de configuraci&oacute;n
    <code class="filename">src/main/resources/META-INF/spring/CITWSAuth.properties</code>
    del proyecto.</p>
    
    <p>En el caso de que una organizaci&oacute;n disponga de un
    sistema de seguridad propio, puede hacer uso de este sistema si 
    ofrece la informaci&oacute;n de autorizaci&oacute;n y autenticaci&oacute;n de sus usuarios
    a trav&eacute;s de un servidor de servicios web que respete el contrato
    definido por este servicio.
    </p>
    
    <p>Para ver con mas detalle el comando que proporciona el add-on
    consultar la secci&oacute;n de <a class="link" href="#apendice-comandos_cit-security" title="26.6.&nbsp;Comandos del add-on CIT Security">
    comandos del add-on CIT Security</a>.</p>
  </div>
  
</div>

    <div class="chapter" lang="es"><div class="titlepage"><div><div><h2 class="title"><a name="addon-web-report"></a>Cap&iacute;tulo 20. Add-on Web Report</h2></div></div></div>
  

  <p>El add-on a&ntilde;ade soporte para la generaci&oacute;n de informes
  con <span class="emphasis"><em>Jasper Reports</em></span> y genera informes totalmente
  funcionales para una entidad que posteriormente pueden ser personalizados.
  Los informes son accesibles desde la interfaz web mediante un 
  formulario que se crea para tal efecto.</p>
  
  <p>En la secci&oacute;n de recetas se puede encontrar
  informaci&oacute;n adicional para realizar el <a class="link" href="#recetas-reports-subinforme" title="25.5. Dise&ntilde;o de informes con sub informes">
  dise&ntilde;o de informes con sub informes</a>.</p>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="addon-web-report_descripcion"></a>20.1. Descripci&oacute;n</h2></div></div></div>
    

    <p>El add-on a&ntilde;ade por un lado el soporte necesario para trabajar
    con Jasper Reports y por otro es capaz de generar informes asociados con una
    entidad cualquiera de la aplicaci&oacute;n.</p>

    <p>Un informe de <span class="emphasis"><em>Jasper Reports</em></span>
    se se define principalmente mediante un archivo de dise&ntilde;o de informe (jrxml).
    El dise&ntilde;o de informe al procesarse junto con una fuente de datos, genera
    un fichero de salida en un formato determinado incluyendo en &eacute;l la
    informaci&oacute;n existente en la fuente de datos. La fuente de datos puede
    provenir de distintos or&iacute;genes, aunque en este caso siempre ser&aacute;
    una lista de entidades proporcionada directamente desde la aplicaci&oacute;n.</p>

    <p>El archivo de dise&ntilde;o es un documento XML con un
    formato determinado que se puede editar de manera sencilla y gr&aacute;fica
    mediante una herramienta como <a class="ulink" href="http://jasperforge.org/projects/ireport" target="_top">iReport</a>.</p>

    <div class="figure"><a name="d4e2858"></a><div class="figure-contents">
      

      <div class="mediaobject" align="center"><img src="images/ireport.png" align="middle" alt="Editor de informes iReport"></div>
    </div><p class="title"><b>Figura 20.1. Editor de informes iReport</b></p></div><br class="figure-break">
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="addon-web-report_instalacion"></a>20.2. Instalaci&oacute;n</h2></div></div></div>
    

    <p>Jasper Reports requiere varias librer&iacute;as y configuraciones para funcionar,
    el add-on incluye en el proyecto las dependencias de la librer&iacute;a modificando el pom.xml
    del mismo e incluye varios ficheros de configuraci&oacute;n que se ver&aacute;n a continuaci&oacute;n
    con mas detalle.</p>

    <p>El comando s&oacute;lo estar&aacute; disponible si el proyecto utiliza Spring MVC en
    la capa web. Esto es, el archivo de configuraci&oacute;n <span class="emphasis"><em>webmvc-config.xml</em></span>
    debe existir en <span class="emphasis"><em>/WEB-INF/spring</em></span>.</p>
    
    <p>Estas operaciones de configuraci&oacute;n las realiza el comando del add-on
    <a class="link" href="#apendice-comandos_addon-web-report_setup" title="26.7.1.&nbsp;web report setup">web report setup</a>:</p>

	<pre class="programlisting">
	roo-gvNIX&gt; <span class="command"><strong>web report setup</strong></span>
	Updated SRC_MAIN_WEBAPP/WEB-INF/spring/webmvc-config.xml
	Created SRC_MAIN_WEBAPP/WEB-INF/spring/jasper-views.xml
	Created SRC_MAIN_WEBAPP/WEB-INF/classes/jasperfonts
	Created SRC_MAIN_WEBAPP/WEB-INF/classes/jasperfonts/FreeSans.ttf
	Created SRC_MAIN_WEBAPP/WEB-INF/classes/jasperfonts/FreeSansBold.ttf
	Created SRC_MAIN_WEBAPP/WEB-INF/classes/jasperfonts/FreeSansBoldOblique.ttf
	Created SRC_MAIN_WEBAPP/WEB-INF/classes/jasperfonts/FreeSansOblique.ttf
	Created SRC_MAIN_WEBAPP/WEB-INF/classes/jasperfonts/gvnix_reportfonts.xml
	Updated ROOT/pom.xml [added dependency org.gvnix:org.gvnix.web.report.roo.addon:1.0.0; 
			added property 'jasperreports.version' = '4.0.1';
			added property 'jasperreportsfonts.version' = '4.0.0';
			added property 'apachepoi.version' = '3.7';
			added dependencies net.sf.jasperreports:jasperreports:${jasperreports.version},
			org.apache.poi:poi:${apachepoi.version},
			net.sf.jasperreports:jasperreports-fonts:${jasperreportsfonts.version}]
	Created SRC_MAIN_WEBAPP/WEB-INF/classes/jasperreports_extension.properties
	</pre>

    <p>El comando configura los siguientes archivos:</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p><span class="emphasis"><em>pom.xml</em></span>: a&ntilde;ade la dependencia JasperReports,
        la dependencia Apache POI para informes en formato Excel y una
        dependencia con el propio add-on para as&iacute; reconocer la anotaci&oacute;n
        <span class="emphasis"><em>@GvNIXReports</em></span> que se utilizar&aacute; en el proyecto.</p>
      </li><li>
        <p><span class="emphasis"><em>webmvc-config.xml</em></span>: a&ntilde;ade un bean para
        configurar el sitema de vistas de informes.</p>
      </li><li>
        <p><span class="emphasis"><em>jasper-views.xml</em></span>: a&ntilde;ade una definici&oacute;n de
        vistas por informe.</p>
      </li><li>
        <p><span class="emphasis"><em>jasperfonts</em></span>: directorio que contiene
        fuentes True Type que usar&aacute; JasperReports para confeccionar el
        informe.</p>
      </li><li>
        <p><span class="emphasis"><em>jasperreports_extension.properties</em></span>: define
        el lugar donde se encuentran las fuentes a utilizar.</p>
      </li></ul></div>

    <p>Cada uno de los informes se comporta como una vista m&aacute;s de la aplicaci&oacute;n y 
    por tanto el add-on habr&aacute; incluido en el fichero de configuraci&oacute;n de la capa web
    <span class="emphasis"><em>webmvc-config.xml</em></span> un componente que para cada  petici&oacute;n
    de este tipo devolver&aacute; el nuevo tipo de salida (un informe). Esto se logra
    a&ntilde;adiendo un nuevo <span class="emphasis"><em>bean</em></span>:</p>

    <pre class="programlisting">&lt;bean id="jasperReportsXmlViewResolver"
    		class="org.springframework.web.servlet.view.XmlViewResolver"
    		p:location="/WEB-INF/spring/<span class="bold"><strong>jasper-views.xml</strong></span>" p:order="0" /&gt;</pre>

    <p>Este <span class="emphasis"><em>bean</em></span> referencia al fichero
    <span class="emphasis"><em>jasper-views.xml</em></span> como fichero de configuraci&oacute;n de las
    nuevas vistas, por tanto el add-on habr&aacute; creado este archivo en
    <span class="emphasis"><em>src/main/webapp/WEB-INF/spring</em></span>.</p>

    <p>Los informes generados pueden contener textos que se deban visualizar con 
    caracter&iacute;sticas especiales tales como negrita y cursiva. Para ello, Jasper Reports
    requiere que las fuentes utilizadas para generar el
    informe se encuentren en el classpath de la aplicaci&oacute;n. As&iacute; pues, el
    add-on se ocupa de copiar en
    <span class="emphasis"><em>src/main/webapp/WEB-INF/classes/jasperfonts</em></span>
    varios archivos de fuentes
    True Type y su definici&oacute;n para poder hacer uso de ellas en el archivo
    <span class="emphasis"><em>gvnix_reportfonts.xml</em></span>. En el archivo
    <span class="emphasis"><em>src/main/webapp/WEB-INF/classes/jasperreports_extension.properties</em></span>
    se indica a Jasper Reports que utilice estas fuentes a la hora de generar el informe.</p>
    
    <p>Si se desean utilizar fuentes de letra adicionales a parte de
    las incluidas por defecto por el add-on, deber&aacute;n ser instaladas de forma manual en el
    proyecto. Para ello se puede consultar la secci&oacute;n <a class="link" href="#recetas-reports-fuentes" title="25.4. Instalar fuentes de letra para los informes">
    Instalar fuentes de letra para los informes</a> de la secci&oacute;n de recetas.</p>

  </div>
  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="addon-web-report_generacion"></a>20.3. Generaci&oacute;n de un informe</h2></div></div></div>
    

    <p>El add-on realiza la generaci&oacute;n autom&aacute;tica de informes
    sobre cualquier entidad de la applicaci&oacute;n en la que se est&aacute; utilizando.
    Posteriormente, los informes podr&aacute;n ser personalizados por parte
    del desarrollador de la aplicaci&oacute;n para adecuarlos a los requerimientos
    modificando o bien lo l&oacute;gica de negocio o bien el estilo visual como se desee.</p>

    <p>La petici&oacute;n de un informe, al tratarse de una vista m&aacute;s de la
    aplicaci&oacute;n, ha de ser atendida por un controlador. No obstante, los informes
    muestran informaci&oacute;n referente a una entidad del modelo de datos de la
    aplicaci&oacute;n, por tanto el controlador debe atender peticiones
    referentes a una determinada entidad. Esto, como se coment&oacute; en <a class="link" href="#guia-desarrollo_web_definir-controller_a-mano_automatico" title="11.2.2. Controlador CRUD">CRUDS
    autom&aacute;tico</a>, se configura mediante la anotaci&oacute;n
    <span class="emphasis"><em>@RooWebScaffold</em></span> y su atributo
    <span class="emphasis"><em>formBackingObject.</em></span> As&iacute; pues, no se puede definir un
    informe sobre un controlador que no disponga de la anotaci&oacute;n
    <span class="emphasis"><em>@RooWebScaffold</em></span>.</p>

    <p>La generaci&oacute;n de un informe se realiza mediante el comando <a class="link" href="#apendice-comandos_addon-web-report_add" title="26.7.2.&nbsp;web report add">web report add</a> o
    incluyendo la anotaci&oacute;n @GvNIXReports en la clase del controlador.
    Los formatos de fichero en los que se puede generar el informe son:</p>
        
    <div class="itemizedlist"><ul type="disc"><li>
		<span class="emphasis"><em>PDF</em></span>: Portable Document Format.
      </li><li>
		<span class="emphasis"><em>XLS</em></span>: Excel.
      </li><li>
		<span class="emphasis"><em>CSV</em></span>: Comma Separated Values.
      </li><li>
		<span class="emphasis"><em>HTML</em></span>: Hyper Text Markup Language.
      </li></ul></div>
    
	<pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>web report add --controller ~.web.EntityController --reportName informe</strong></span>
	Updated SRC_MAIN_JAVA/org/gvnix/test/web/EntityController.java
	Created SRC_MAIN_WEBAPP/WEB-INF/reports
	Created SRC_MAIN_WEBAPP/WEB-INF/reports/entity_informe.jrxml
	Created SRC_MAIN_JAVA/org/gvnix/test/web/servlet/view/jasperreports
	Created SRC_MAIN_JAVA/org/gvnix/test/web/servlet/view/jasperreports/
			CustomJasperReportsMultiFormatView.java
	Updated SRC_MAIN_WEBAPP/WEB-INF/spring/jasper-views.xml
	Updated SRC_MAIN_WEBAPP/WEB-INF/i18n/application.properties
	Created SRC_MAIN_WEBAPP/WEB-INF/views/pets/informe.jspx
	Updated SRC_MAIN_WEBAPP/WEB-INF/views/pets/views.xml
	Updated SRC_MAIN_WEBAPP/WEB-INF/i18n/application.properties
	Created SRC_MAIN_JAVA/org/gvnix/test/web/EntityController_Roo_GvNIXReport.aj
	Updated SRC_MAIN_WEBAPP/WEB-INF/views/menu.jspx</pre>

    <p>El comando incluir&aacute; la anotaci&oacute;n <span class="emphasis"><em>@GvNIXReports</em></span>
    en la clase controladora e incluira como atributo un array de cadenas en la que cada
    elemento define un informe y los formatos en los que se podr&aacute; generar dicho informe.
    As&iacute; pues, la anotaci&oacute;n:</p>

    <pre class="programlisting">@GvNIXReports({ "informe|pdf,xls,csv" })</pre>

    <p>Define un informe cuyo nombre es <span class="emphasis"><em>informe</em></span>
    y estar&aacute; disponible en los formatos pdf, xls y csv.</p>

    <p>Al lanzar el comando <span class="emphasis"><em>web report add</em></span> o anotar
    la clase del controlador con <span class="emphasis"><em>@GvNIXReports</em></span> se
    realizan una serie de modificaciones en el proyecto que dar&aacute;n como resultado la 
    posibilidad de generar un informe desde un formulario de la aplicaci&oacute;n.
    Las modificaciones que realiza el comando sobre el proyecto son:</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p>Crea la clase Java <span class="bold"><strong>CustomJasperReportsMultiFormatView</strong></span>. La nueva clase se
        crear&aacute; en el subpaquete <span class="emphasis"><em>servlet.view.jasperreports</em></span>
        dentro del paquete donde se encuentre el controlador.
        Esta clase se instala solo una vez y en sucesivas ejecuciones se
        comprueba si existe. Esta clase tiene como principal cometido
        establecer, de manera din&aacute;mica, el nombre del archivo del informe que
        se genera para su descarga.</p>
      </li><li>
        <p>En el archivo <code class="filename">jasper-views.xml</code>
        a&ntilde;ade la definici&oacute;n de una nueva vista que ser&aacute; el nuevo informe
        a&ntilde;adido a la aplicaci&oacute;n. Se define para ello un bean cuyo id es
        <span class="emphasis"><em>&lt;fromBackingObject&gt;_&lt;reportname&gt;</em></span> y
        <span class="emphasis"><em>CustomJasperReportsMultiFormatView</em></span> como clase del
        bean. Si <span class="emphasis"><em>formBackingObject</em></span> de
        <span class="emphasis"><em>@RooWebScaffold</em></span> tiene como valor
        <span class="emphasis"><em>Entity</em></span> y el nombre definido para el informe es
        <span class="emphasis"><em>informe</em></span>:</p>

        <pre class="programlisting">&lt;bean id="entity_informe" 
class="org.gvnix.test.web.servlet.view.jasperreports.CustomJasperReportsMultiFormatView"
p:url="/WEB-INF/reports/entity_informe.jrxml"
p:subReportUrls-ref="subReportUrls"
p:subReportDataKeys-ref="subReportDataKeys" /&gt;</pre>
      </li><li>
        <p>Crea un archivo de dise&ntilde;o de informe (jrxml) con 
        carios campos de la clase Entity (siguiendo el ejemplo anterior).
        El archivo se crear&aacute; en
        <code class="filename">src/main/webapp/WEB-INF/reports</code> con
        el nombre <code class="filename">entity_informe.jrxml</code>. Este
        archivo se referenciar&aacute; en el <span class="emphasis"><em>bean</em></span> del fichero
        <code class="filename">jasper-views.xml</code> desde el atributo
        <span class="emphasis"><em>p:url</em></span>.</p>
      </li><li>
        <p>Crea un formulario web bajo <code class="filename">
        src/main/webapp/WEB-INF/views/&lt;entity&gt;
        </code>con nombre <span class="emphasis"><em>informe.jspx</em></span>
        siguiendo con el ejemplo anterior. Y define esta nueva
        vista en el fichero <code class="filename">views.xml</code>
        situado en el mismo directorio. Esta p&aacute;gina permitir&aacute; solicitar
        la generaci&oacute;n del informe y por defecto lo har&aacute; incluyendo los 10
        primeros registros de la entidad.</p>
      </li><li>
        <p>Incluye las etiquetas multidioma que necesita
        visualizar la generaci&oacute;n de informes en
        <span class="emphasis"><em>src/main/webapp/WEB-INF/i18n/application.properties</em></span>
        y un nuevo enlace del men&uacute; en <span class="emphasis"><em>src/main/webapp/WEB-INF/views/menu.jspx
        </em></span> para poder acceder a la p&aacute;gina de generaci&oacute;n del informe.</p>
      </li><li>
        <p>Crea el aspecto Java
        <span class="emphasis"><em>&lt;controller&gt;_Roo_GvNIXReport.aj</em></span> con
        los m&eacute;todos que atender&aacute;n las peticiones relacionadas con el
        informe a&ntilde;adido. Se a&ntilde;aden dos m&eacute;todos por informe:</p>

        <div class="itemizedlist"><ul type="circle"><li>
            <p><span class="emphasis"><em>generate&lt;Reportname&gt;Form(..)</em></span>:
            devuelve la vista del formulario web que permite al
            usuario seleccionar el formato de salida del informe y solicitar
            su generaci&oacute;n mediante un bot&oacute;n.</p>
          </li><li>
            <p><span class="emphasis"><em>generate&lt;Reportname&gt;(..)</em></span>: atiende
            la petici&oacute;n de generaci&oacute;n del informe recopilando los datos
            necesarios que se deben incluir en &eacute;l. Para ello, por defecto invoca el m&eacute;todo
            <span class="emphasis"><em>&lt;formBackingObject&gt;.find&lt;formBackingObject&gt;Entries(0,
            10)</em></span> por lo que se tomar&aacute;n los 10 primeros registros de la entidad para
            rellenar el informe.</p>

            <pre class="programlisting">@RequestMapping(value = "/reports/informe", params = "form",
		method = RequestMethod.GET)
public String EntityController.generateInformeForm(Model uiModel) {
    String[] reportFormats =  {"pdf"};
    Collection&lt;String&gt; reportFormatsList = Arrays.asList(reportFormats);
    uiModel.addAttribute("report_formats", reportFormatsList);
    return "users/informe";
}

@RequestMapping(value = "/reports/informe", method = RequestMethod.GET)
public String EntityController.generateInforme(
		@RequestParam(value = "format", required = true) String format, Model uiModel) {
    if ( null == format || format.length() &lt;= 0 ) {
            uiModel.addAttribute("error", "message_format_required");
            return "users/informe";
    }
    final String REGEX = "(pdf)";
    Pattern pattern = Pattern.compile(REGEX, Pattern.CASE_INSENSITIVE);
    Matcher matcher = pattern.matcher(format);
    if ( !matcher.matches() ) {
            uiModel.addAttribute("error", "message_format_invalid");
            return "users/informe";
    }
    Collection&lt;Entity&gt; dataSource = Entity.findEntityEntries(0, 10);
    if (dataSource.isEmpty()) {
            uiModel.addAttribute("error", "message_emptyresults_noreportgeneration");
            return "users/informe";
    }
    uiModel.addAttribute("format", format);
    uiModel.addAttribute("title", "INFORME");
    uiModel.addAttribute("informeList", dataSource);
    return "entity_informe";
}</pre>
          </li></ul></div>
      </li></ul></div>

    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Nota</h3>
      <p>El comando web report add puede ejecutarse tantas veces como se
      desee sobre el mismo controlador. Si el nombre del informe a a&ntilde;adir ya
      existe previamente, se a&ntilde;adir&aacute;n los formatos especificados
      a los ya definidos. Si el nombre dado al nuevo informe
      definido no exist&iacute;a, se a&ntilde;adir&aacute; su definici&oacute;n en la anotaci&oacute;n
      <span class="emphasis"><em>@GvNIXReports</em></span>.</p>

      <pre class="programlisting">@GvNIXReports({ "informe|pdf,xls,csv", "otroinforme|pdf" })</pre>
	</div>
	
    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Nota</h3>
      <p>Los valores de la anotaci&oacute;n <span class="emphasis"><em>@GvNIXReports</em></span>
      <span class="bold"><strong>no son sensibles</strong></span> a may&uacute;sculas por tanto si
      manualmente se establecen los valores de la anotaci&oacute;n como:</p>

      <pre class="programlisting">@GvNIXReports({ "informe|pdf", "INFORME|xls,csv" })</pre>

      <p>es equivalente a:</p>

      <pre class="programlisting">@GvNIXReports({ "informe|pdf,xls,csv" })</pre>
    </div>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="addon-web-report_futuras-versiones"></a>20.4. Futuras versiones</h2></div></div></div>&gt;
    

	<div class="itemizedlist"><ul type="disc"><li>
		    <p>Incrementar la funcionalidad del informe generado, 
		    incluyendo la visualizaci&oacute;n de las relaciones que pueda tener la entidad sobre
		    la que se declara el informe. En la secci&oacute;n de recetas se muestra una forma de
		    mostrar las relaciones de una entidad en el informe mediante el 
		    <a class="link" href="#recetas-reports-subinforme" title="25.5. Dise&ntilde;o de informes con sub informes">uso de subinformes</a>.</p>
		 </li></ul></div>
  </div>
</div>

    <div class="chapter" lang="es"><div class="titlepage"><div><div><h2 class="title"><a name="addon-service"></a>Cap&iacute;tulo 21. Add-on Service</h2></div></div></div>
  

    <p>Permite crear servicios locales, servidores de
    servicios web y clientes de servicios web de forma autom&aacute;tica.</p>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="addon-service_descripcion"></a>21.1. Descripci&oacute;n</h2></div></div></div>
    

	<p>Permite crear de forma autom&aacute;tica servicios locales,
	servidores de servicios web a partir de un m&eacute;todo del
	c&oacute;digo fuente, crear servidores de servicios web bas&aacute;ndose
	en un archivo de descripci&oacute;n de servicios <span class="emphasis"><em>WSDL</em></span> y crear clientes de servicios
	web a partir de un archivo de descripci&oacute;n de servicios <span class="emphasis"><em>WSDL</em></span>.</p>

    <p>La creaci&oacute;n de servicios, del mismo modo que todas las 
    funcionalidades que proporciona el framework, se realiza mediante anotaciones.
    Para simplificar esta tarea se puede hacer uso de los comandos que
    ofrece. A medida que se van ejecutando comandos del add-on, se van
    modificando anotaciones y m&eacute;todos de la clase Java de forma que acabar&aacute;
    conformando el servicio web que se desea publicar.</p>

  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="addon-service_crear-local"></a>21.2. Creaci&oacute;n de servicios locales</h2></div></div></div>
      

      <p>Un servicio local es una clase Java con una serie de m&eacute;todos
      que se desea que est&eacute;n disponibles de forma interna para toda la aplicaci&oacute;n. La clase
      se puede crear con el comando <a class="link" href="#apendice-comandos_addon-service_class" title="26.8.1.&nbsp;remote service class">
      remote service class</a>.</p>
      
      <pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>remote service class --class ~.service.Service</strong></span>
Created SRC_MAIN_JAVA/org/gvnix/test/service/Service.java</pre>
      
      <p>La ejecuci&oacute;n del comando crear&aacute; una clase en la ruta
      especificada con la anotaci&oacute;n <span class="emphasis"><em>@Service</em></span> que le
      proporciona unas caracter&iacute;sticas especiales y facilita su uso como servicio
      local dentro de la aplicaci&oacute;n.</p>
      
      <pre class="programlisting">...
@Service
public class Service {
}</pre>
		
	  <p>De esta forma, el servicio puede ser utilizar desde
	  cualquier otra clase Java definiendo una propiedad del tipo de la clase
	  de servicio con la anotaci&oacute;n <span class="emphasis"><em>@Autowired</em></span>.</p>
	  
	  <pre class="programlisting">@Autowired
Service service;</pre>
      
      <p>Una vez creada la clase se pueden crear los m&eacute;todos que se
      desea ofrecer en el servicio. Los m&eacute;todos se pueden crear mediante el comando
      <a class="link" href="#apendice-comandos_addon-service_operation" title="26.8.2.&nbsp;remote service operation">remote service
      operation</a> que permite a&ntilde;adir m&eacute;todos en una clase.</p>
      
      <pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>remote service operation</strong></span> --name myMethod --service ~.service.Service
		--return java.lang.Long --paramNames param1,param2
		--paramTypes "java.lang.String,java.util.List"
Updated SRC_MAIN_JAVA/org/gvnix/test/service/Service.java</pre>
      
      <p>El comando anterior crear&aacute; el m&eacute;todo con las caracter&iacute;sticas
      solicitadas en la clase que se le indica como par&aacute;metro.</p>
      
      <pre class="programlisting">public Long myMethod(String param1, List param2) {
  return null;
}</pre>
      
      <p>Como se puede observar, la implementaci&oacute;n del m&eacute;todo
      est&aacute; vac&iacute;a y como es obvio deber&aacute; ser definida por el desarrollador.</p>
      		
  </div>
  
  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="addon-service_crear-desde-java"></a>21.3. Creaci&oacute;n de servidores desde Java</h2></div></div></div>
      
      
      <p>Permite que los m&eacute;todos de una clase Java puedan ser
      accedidos desde el exterior mediante operaciones de un servicio web.</p>

      <p>En primer lugar se debe elegir una clase Java que contendr&aacute; los
      m&eacute;todos que se desea ofrecer al exterior mediante el servicio web. La clase puede ser
      cualquiera existiente previamente o se puede crear una nueva mediante el comando <a class="link" href="#apendice-comandos_addon-service_class" title="26.8.1.&nbsp;remote service class">remote service class</a>.</p>
      
      <p>A continuaci&oacute;n, se debe elegir los m&eacute;todos a
      ofrecer a trav&eacute;s del servicio web. Si todav&iacute;a no existen,
      se pueden crear mediante el comando <a class="link" href="#apendice-comandos_addon-service_operation" title="26.8.2.&nbsp;remote service operation">remote service
      operation</a>.</p>

      <p>De momento la clase no es accesible mediante
      un servicio web. Para ello se debe ejecutar el comando <a class="link" href="#apendice-comandos_addon-service_define_ws" title="26.8.3.&nbsp;remote service define ws">remote service define
      ws</a>.</p>
      
      <pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>remote service define ws --class ~.service.Service</strong></span>
Updated ROOT/pom.xml [
		added repository https://gvnix.googlecode.com/svn/repo; 
		added dependency org.gvnix:org.gvnix.service.roo.addon:1.0.0; 
		added plugin org.apache.cxf:cxf-java2ws-plugin:${cxf.version}]
Created SRC_MAIN_WEBAPP/WEB-INF/cxf-appname.xml
Updated SRC_MAIN_WEBAPP/WEB-INF/web.xml
Creating a new class 'Service' to export web service.
Created SRC_MAIN_JAVA/org/gvnix/test/service/Service.java
Updated SRC_MAIN_JAVA/org/gvnix/test/service/Service.java
Updated ROOT/pom.xml [
		added dependency org.apache.cxf:cxf-rt-core:${cxf.version};
		added dependency org.apache.cxf:cxf-rt-bindings-soap:${cxf.version};
		added dependency org.apache.cxf:cxf-rt-databinding-jaxb:${cxf.version};
		added dependency org.apache.cxf:cxf-rt-frontend-jaxws:${cxf.version};
		added dependency org.apache.cxf:cxf-rt-transports-http:${cxf.version};
		added dependency javax.xml.bind:jaxb-api:2.1;
		added dependency javax.xml.ws:jaxws-api:2.1;
		added property 'cxf.version' = '2.4.2']
Updated SRC_MAIN_WEBAPP/WEB-INF/cxf-petclinic.xml
Updated ROOT/pom.xml
Created SRC_MAIN_JAVA/org/gvnix/test/service/Service_Roo_GvNix_WebService.aj
* New service defined without operations, use 'service export operation' command to add it
* New service can be shown adding '/services/' suffix to your base application URL</pre>

	  <p>El comando incluir&aacute; la anotaci&oacute;n <span class="emphasis"><em>@GvNIXWebService</em></span>
      en la clase Java indicada. Tambi&eacute;n generar&aacute; los componentes necesarios para exponer la
      clase como un servicio web a partir de los atributos de la anotaci&oacute;n.</p>
      
      <pre class="programlisting">...
@GvNIXWebService(name = "ServicePortType",
		targetNamespace = "http://service.test.gvnix.org/",
		serviceName = "Service", address = "Service",
		fullyQualifiedTypeName = "org.gvnix.test.service.Service", exported = false)
public class Service {
}</pre>
      
      <p>La clase Java ser&aacute; enlazada en la definici&oacute;n del servicio
      con un <span class="emphasis"><em>PortType </em></span> lo que permitir&aacute; la comunicaci&oacute;n 
      con la clase desde el exterior mediante los protocolos y tecnolog&iacute;as de
      servicios web.</p>
      
      <pre class="programlisting">privileged aspect Service_Roo_GvNix_WebService {
declare @type: Service: @WebService(name = "ServicePortType",
		targetNamespace = "http://service.test.gvnix.org/",
		serviceName = "Service", portName = "ServicePortType");
declare @type: Service: @SOAPBinding(style = Style.DOCUMENT, use = Use.LITERAL, 
		parameterStyle = ParameterStyle.WRAPPED);
}</pre>

      <p>En este momento el servicio web ya est&aacute; publicado y es accesible,
      sin embargo no dispondr&aacute; de ninguna operaci&oacute;n ya que por defecto todos
      los m&eacute;todos de la clase publicada son configurados inicialmente como no accesibles
      por motivos de seguridad. Se podr&aacute; hacer accesible
      cada uno de los m&eacute;todos de la clase por separado mediante el 
      comando <a class="link" href="#apendice-comandos_addon-service_export_operation" title="26.8.4.&nbsp;remote service export operation">remote service
      export operation</a></p>
      
      <pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>remote service export operation --class ~.service.Service --method method</strong></span>
Updated SRC_MAIN_JAVA/org/gvnix/test/service/Service.java
Updated SRC_MAIN_WEBAPP/WEB-INF/cxf-appname.xml
Updated ROOT/pom.xml
Deleted SRC_MAIN_JAVA/org/gvnix/test/service/Service.java
Created SRC_MAIN_JAVA/org/gvnix/test/service/Service.java
Created SRC_MAIN_JAVA/org/gvnix/test/service/Service_Roo_GvNix_WebService.aj
Updated SRC_MAIN_JAVA/org/gvnix/test/service/Service_Roo_GvNix_WebService.aj
      </pre>
      
      <p>El comando anterior a&ntilde;ade la anotaci&oacute;n <span class="emphasis"><em>@GvNIXWebMethod
      </em></span> al m&eacute;todo, de forma que que se generar&aacute; el c&oacute;digo necesario para que
      la operaci&oacute;n est&eacute; disponible en el servicio web.</p>

      <pre class="programlisting">@GvNIXWebMethod(operationName = "method", requestWrapperName = "method",
      		requestWrapperNamespace = "http://service.test.gvnix.org/",
      		requestWrapperClassName = "org.gvnix.test.service.MethodRequestWrapper",
      		resultName = "return", resultNamespace = "http://service.test.gvnix.org/",
      		webResultType = Long.class, responseWrapperName = "methodResponse",
      		responseWrapperNamespace = "http://service.test.gvnix.org/",
      		responseWrapperClassName = "org.gvnix.test.service.MethodResponse")
public Long method(@GvNIXWebParam(name = "param1", type = String.class) 
		@WebParam(name = "param1", partName = "parameters", mode = Mode.IN, header = false)
		String param1,
		@GvNIXWebParam(name = "param2", type = List.class)
		@WebParam(name = "param2", partName = "parameters", mode = Mode.IN, header = false)
		List param2) {
    return null;
}</pre>

    <p>Como es obvio, el m&eacute;todo no dispone de ning&uacute;n c&oacute;digo 
    en su cuerpo y ser&aacute; responsabilidad del desarrollador el implementar la l&oacute;gica
    de negocio que sea necesaria.</p>

  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="addon-service_crear-desde-wsdl"></a>21.4. Creaci&oacute;n de servidores desde WSDL</h2></div></div></div>
  
      

      <p>Existe otro modo para crear servidores de 
      servicios web. Consiste en ofrecer al exterior un servicio web partiendo de un
      archivo de contrato de servicio conocido como <span class="emphasis"><em>WSDL</em></span>. Con el comando <a class="link" href="#apendice-comandos_addon-service_export_ws" title="26.8.6.&nbsp;remote service export ws">remote service export
      ws</a> se proporciona la ruta a un archivo <span class="emphasis"><em>WSDL</em></span>
      y se generar&aacute; una r&eacute;plica del servicio en la que las operaciones
      son m&eacute;todos vacios que posteriormente deber&aacute;n
      ser personalizadas con la l&oacute;gica de negocio adecuada.</p>
      
      <pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>remote service export ws --wsdl ruta</strong></span></pre>
      
      <p>La ruta al <span class="emphasis"><em>WSDL</em></span> puede ser un archivo local 
      mediante <span class="emphasis"><em>file://ruta</em></span>, una direcci&oacute;n web mediante
      <span class="emphasis"><em>http://ruta</em></span> o una direcci&oacute;n web segura mediante
      <span class="emphasis"><em>https://ruta</em></span>.</p>
      
      <p>Este modo es especialmente c&oacute;modo para realizar
      la migraci&oacute;n de servicios que est&aacute;n implementados en otras aplicaciones
      o tecnolog&iacute;as o que se desean integrar en otra aplicaci&oacute;n.</p>
  </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e3062"></a>21.5. Creaci&oacute;n de clientes</h2></div></div></div>
      

      <p>Es posible generar un cliente que permita realizar
      peticiones a un servicio web remoto existente utilizando para ello el comando <a class="link" href="#apendice-comandos_addon-service_import_ws" title="26.8.7.&nbsp;remote service import ws">remote service import
      ws</a>. Facilitando la ruta a un <span class="emphasis"><em>WSDL</em></span>, se generar&aacute; una clase 
      en la ruta que se especifique y que contendr&aacute; los m&eacute;todos del cliente que dar&aacute;n
      acceso al servicio web remoto.</p>
      
      <pre class="programlisting">remote service import ws --class org.gvnix.test.service.Service
      		--wsdl ruta
Created SRC_MAIN_JAVA/org/gvnix/test/service/
Created SRC_MAIN_JAVA/org/gvnix/test/service/Service.java
Updated SRC_MAIN_JAVA/org/gvnix/test/service/Service.java
Updated ROOT/pom.xml [
		added dependency org.hibernate.javax.persistence:hibernate-jpa-2.0-api:1.0.0.Final;
		removed dependency org.hibernate.javax.persistence:hibernate-jpa-2.0-api:1.0.1.Final;
		added plugin org.apache.cxf:cxf-codegen-plugin:${cxf.version}]
Updated ROOT/pom.xml
</pre>

	  <p>El comandoe dar&aacute; lugar a la creaci&oacute;n, si no exist&iacute;a, de
	  la clase Java y a la inclusi&oacute;n de la anotaci&oacute;n <span class="emphasis"><em>@GvNIXWebServiceProxy
	  </em></span> que define el servicio web al que da acceso la clase.</p>

	  <pre class="programlisting">...
@Service
@GvNIXWebServiceProxy(wsdlLocation = "ruta")
public class Service {
}</pre>

	  <p>La anotaci&oacute;n desencadenar&aacute; la creaci&oacute;n en el aspecto
	  Java correspondiente de tantos m&eacute;todos como operaciones ofrece el
	  servicio web y que enmascaran la comunicaci&oacute;n con el sistema
	  remoto.</p>

	  <pre class="programlisting">privileged aspect Service_Roo_GvNix_WebServiceProxy {
	  
	public String Service.method(String param1) {
			org.web.service.RemoteService s = new org.web.service.RemoteService();
		org.web.service.RemoteServiceSoap p = s.getRemoteServiceSoap12();
		return p.method(param1);
	}

}</pre>

      <p>Esta clase se podr&aacute; utilizar como si de un
      servicio local se tratase. Para usar esta clase simplemente habr&aacute; que crear
      una propiedad en la clase donde se desea hacer uso de ella y a&ntilde;adirle
      la anotaci&oacute;n <span class="emphasis"><em>@Autowired</em></span>.</p>

      <pre class="programlisting">public class MyClass {
  ...
  @Autowired
  private Service service;
  ...
  public void myMethod() {
    ...
    service.method(..);
    ...
  }
}</pre>

      <p>La ruta al <span class="emphasis"><em>WSDL</em></span> puede ser un archivo local 
      mediante <span class="emphasis"><em>file://ruta</em></span>, una direcci&oacute;n web mediante
      <span class="emphasis"><em>http://ruta</em></span> o una direcci&oacute;n web segura mediante
      <span class="emphasis"><em>https://ruta</em></span>.</p>

	</div>
    <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e3081"></a>21.6. Acceso a un WSDL en un servidor seguro</h2></div></div></div>
      

      <p>Cuando el <span class="emphasis"><em>WSDL</em></span> se encuentra en un
      archivo local o en un servidor no seguro como HTTP, se puede acceder
      directamente sin ning&uacute;n problema.</p>

      <p>En el caso que un <span class="emphasis"><em>WSDL</em></span>
      se encuentra en un servidor seguro al que se
      accede mediante HTTPS pueden darse dos posibles escenarios:</p>

      <div class="orderedlist"><ol type="1"><li>
          <p>El certificado del servidor ha sido creado por una <span class="bold"><strong>Autoridad de certificaci&oacute;n (CA) confiable por la
          JVM</strong></span>.</p>

          <p>En este caso, el procesado del <span class="emphasis"><em>WSDL</em></span> funciona de la misma
          manera que en el caso de acceso por HTTP, transparente para el
          usuario.</p>
        </li><li>
          <p>El certificado de servidor ha sido creado por un <span class="bold"><strong>CA no confiable</strong></span> (caso de certificados
          autofirmados).</p>

          <p>Aqu&iacute;, es responsabilidad del usuario el aceptar las
          credenciales del servidor para poder acceder al <span class="emphasis"><em>WSDL</em></span>. Recordando
          como trabajan los navegadores web, cuando se intenta acceder a un
          recurso seguro, si el certificado del servidor no ha sido creado por
          un CA que se encuentre entre la lista de CAs conocida (Verisign,
          Thwate, Equfax, ...), el navegador muestra un mensaje de
          advertencia y pregunta si se desea confiar en la identidad del
          servidor. Cada usuario decide aceptar o no el certificado.</p>

          <p>Para simplificar el proceso de importaci&oacute;n de servicios web,
          se intenta hacer esta tarea de manera transparente para el usuario.</p>

          <p>Para ello, se manipula el almacen de certificados de la
          m&aacute;quina virtual Java siempre que sea posible. Esto es:</p>

          <div class="orderedlist"><ol type="a"><li>
              <p>Existe el archivo de keystore en el directorio
              donde est&aacute; instalado Java, por ejemplo en sistemas linux <span class="emphasis"><em> 
              $JAVA_HOME/jre/lib/security/cacerts</em></span> y es modificable
              por el usuario del sistema que est&aacute; ejecutando gvNIX.</p>
            </li><li>
              <p>La contrase&ntilde;a del <span class="emphasis"><em>keystore</em></span> es
              changeit (la contrase&ntilde;a por defecto del keystore).</p>
            </li></ol></div>

          <p>Si se puede modificar el keystore, se importar&aacute;n los
          certificados implicados en la autenticaci&oacute;n del servidor y entonces se
          podr&aacute; acceder al <span class="emphasis"><em>WSDL</em></span> requerido para generar el cliente del
          WS.</p>

          <p>Al mismo tiempo, se crea en
          <span class="emphasis"><em>src/main/resources</em></span> una copia del almacen de
          certificados en el archivo gvnix-cacerts y una copia local de los
          certificados importados con el nombre
          <span class="emphasis"><em>&lt;servidor&gt;-&lt;indice_certificado&gt;.cer</em></span>.
          De esta forma, los certificados pueden ser distribuidos con el resto
          de archivos del proyecto para que puedan ser instalados en otros
          entornos.</p>

          <p>Si no puede modificar el keystore de la JVM, porque no
          se cumplen alguna de las 2 condiciones enumeradas anteriormente, de todas
          formas realizar&aacute; la copia de los certificados necesarios para que sea el
          usuario quien instale los mismos en el almacen de certificados de su
          JVM. Para ello se puede hacer uso de la herramienta <a class="ulink" href="http://download.oracle.com/javase/6/docs/technotes/tools/solaris/keytool.html" target="_top">keytool</a>
          (distribuida tambi&eacute;n con el JDK). La operaci&oacute;n de importar los
          certificados equivale a la aceptaci&oacute;n que se hace con el navegador.</p>
        </li></ol></div>

      <div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="d4e3114"></a>21.6.1. Creaci&oacute;n de clientes con firma</h3></div></div></div>
        

        <p>El add-on permite a&ntilde;adir una
        firma digital a las peticiones realizadas a un servicio web
        externo que se encuentra importado en la aplicaci&oacute;n.</p>

        <p>Actualmente esta opci&oacute;n s&oacute;lo est&aacute; disponible para los servicio
        web que utilicen la librer&iacute;a Axis (RPC/Encoded). En futuras versiones se a&ntilde;adir&aacute;
        esta misma opci&oacute;n para servicios que utilicen la librer&iacute;a CXF (Document/Literal)
        y otra operaciones relacionadas con la seguridad en servicios web.</p>

        <p>Para ello se debe disponer de:</p>

        <div class="orderedlist"><ol type="1"><li>
            <p>Servicio web importado en la aplicaci&oacute;n.</p>
          </li><li>
            <p>Fichero <span class="emphasis"><em>pkc12</em></span> con el certificado a usar
            para firmar la petici&oacute;n.</p>
          </li><li>
            <p>Contrase&ntilde;a del certificado.</p>
          </li><li>
            <p>Alias a usar con el certificado</p>
          </li></ol></div>

        <p>Disponiendo de esto elementos, se puede hacer uso del comando <a class="link" href="#apendice-comandos_addon-service_security_ws" title="26.8.9.&nbsp;remote service security ws">remote service
        security ws</a> para a&ntilde;adir la firma en las peticiones del cliente.</p>
        
        <pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>remote service security ws --class org.gvnix.test.service.Service
        		--alias alias --certificate /tmp/certificate.p12 --password clave</strong></span>
Created ROOT/src/main/resources/org/gvnix/test/service
Created ROOT/src/main/resources/org/gvnix/test/service/certificate.p12
Updated SRC_MAIN_JAVA/org/gvnix/test/service/Service.java
Created ROOT/src/main/resources/client-config.wsdd
Created ROOT/src/main/resources/org/gvnix/test/service/ServiceSecurity.properties
Updated ROOT/pom.xml [added dependency org.apache.ws.security:wss4j:1.5.11]
Updated ROOT/src/main/resources/client-config.wsdd
Created SRC_MAIN_JAVA/org/gvnix/test/service/Service_Roo_GvNIX_WebSecurity.aj
</pre>

		<p>Se crear&aacute;n dos ficheros con distintos par&aacute;metros
		de configuraci&oacute;n en <code class="filename">src/main/resources/org/gvnix/test/service/ServiceSecurity.properties</code>
		y <code class="filename">src/main/resources/client-config.wsdd</code>.</p>

		<p>Tambi&eacute;n dar&aacute; lugar a la inclusi&oacute;n de la
		anotaci&oacute;n <span class="emphasis"><em>@GvNIXWebServiceSecurity</em></span> con los
		mismos valores que los atributos que se proporcionaron desde el comando.
		</p>
		
		<pre class="programlisting">...
@GvNIXWebServiceSecurity(certificate = "certificate.p12",
		password = "clave", alias = "alias")
public class Service {
}</pre>

		<p>La anotaci&oacute;n anterior dar&aacute; lugar a la generaci&oacute;n
		del aspecto Java correspondiente que establece la clave de acceso
		al certificado.</p>

		<pre class="programlisting">privileged aspect Service_Roo_GvNIX_WebSecurity {

    declare parents: Service implements CallbackHandler;

    public Service.new() {
        super();
    }

    public void Service.handle(Callback[] callbacks)
    		throws IOException, UnsupportedCallbackException {
        ((org.apache.ws.security.WSPasswordCallback) callbacks[0]).setPassword("clave");
    }
}</pre>
        
      </div>
    </div>

    <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e3141"></a>21.7. Listar los servicios</h2></div></div></div>
      

      <p>El comando <a class="link" href="#apendice-comandos_addon-service_list_operation" title="26.8.5.&nbsp;remote service list operation">remote service list
      operation</a> muestra los m&eacute;todos existentes en una clase
      que est&aacute;n disponibles para ser ofrecidos al exterior siempre y cuando la clase est&eacute;
      definida como un servicio web.</p>
      
<pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>remote service list operation --class ~.service.Service</strong></span>
Method list to export as web service operation in '~.service.Service':
    * myMethod2</pre>

      <p>El comando <a class="link" href="#apendice-comandos_addon-service_ws_list" title="26.8.8.&nbsp;remote service ws list">remote service ws
      list</a> permite obtener un listado de los servicios ofrecidos al
      exterior o aquellos servicios externos que son utilizados en la aplicaci&oacute;n.</p>

      <p>El resultado es una salida como esta:</p>

      <pre class="programlisting">roo-gvNIX&gt; remote service ws list
Services                         exported    imported
-------------------------------  ---------   ----------
org.gvnix.test.service.Service1      X
org.gvnix.test.service.Service2                 X 
org.gvnix.test.service.Service3                 X</pre>
    </div>
</div>

    <div class="chapter" lang="es"><div class="titlepage"><div><div><h2 class="title"><a name="addon-web-i18n"></a>Cap&iacute;tulo 22. Add-on Web MVC i18n</h2></div></div></div>
  

  <p>Permite a&ntilde;adir soporte para nuevos idiomas en el proyecto.</p>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="addon-web-i18n_descripcion"></a>22.1. Descripci&oacute;n</h2></div></div></div>
    
    
    <p>Este add-on permite a&ntilde;adir en el proyecto
    soporte para nuevas lenguas utilizando para ello una infraestructura com&uacute;n
    para la inclusi&oacute;n de nuevos idiomas. Al incluir un nuevo idioma, se
    a&ntilde;aden en la aplicaci&oacute;n de forma autom&aacute;tica los textos traducidos a
    dicho idioma.</p>

    <p>Los idiomas soportados son: de (Alem&aacute;n), en (Ingl&eacute;s),
    es (Espa&ntilde;ol), it (Italiano), nl (Holand&eacute;s), sv (Finland&eacute;s), <span class="bold"><strong>ca (Valenciano/Catal&aacute;n)</strong></span>. Este &uacute;ltimo es
    a&ntilde;adido por gvNIX utilizando la base del add-on de idiomas de su
    n&uacute;cleo Spring Roo.</p>
    
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e3159"></a>22.2. Instalaci&oacute;n de un idioma</h2></div></div></div>
    

    <p>Para instalar uno de los idiomas soportados hay que
    ejecutar el comando web mvc install language y proporcionar como par&aacute;metro
    <span class="emphasis"><em>code</em></span> el c&oacute;digo del idioma deseado.</p>

	<pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>web mvc install language --code ca</strong></span>
	Created SRC_MAIN_WEBAPP/WEB-INF/i18n/messages_ca.properties
	Created SRC_MAIN_WEBAPP/images/ca.png
	Updated SRC_MAIN_WEBAPP/WEB-INF/views/footer.jspx</pre>

    <p>Este comando instala un fichero de propiedades en el proyecto
    con la traducci&oacute;n de las etiquetas necesarias para el idioma que se requiera.
    Por ejemplo, para el idioma valenciano/catal&aacute;n se crear&aacute; el fichero
    <span class="emphasis"><em>src/main/webapp/WEB-INF/i18n/messages_ca.properties</em></span>.</p>
	
	<pre class="programlisting">#menu
	global_menu_new=Crear nou {0}
	global_menu_list=Llistar {0}
	global_menu_find=Cercar per {0}
	...</pre>

    <p>Tambi&eacute;n realiza las modificaciones necesarias para poder solicitar el
    cambio de idioma desde la interfaz visual, lo que implica la inclusi&oacute;n de una imagen
    con la bandera del idioma solicitado y la modificaci&oacute;n del pie de p&aacute;gina
    para mostrar el cambio a dicho idioma. Esto se realiza en el fichero
    <span class="emphasis"><em>src/main/webapp/WEB-INF/views/footer.jspx</em></span> mediante el tag
    <span class="emphasis"><em>&lt;util:language&gt;</em></span> que ser&aacute; el encargado de incluir
    la imagen y generar el enlace para el cambio de idioma.</p>
    
    <pre class="programlisting">&lt;util:language label="Valencian_Catalan" locale="ca"/&gt;</pre>
    
    <p>Para mas informaci&oacute;n sobre este comando ver el <a class="link" href="#apendice-comandos_addon-web_i18n" title="26.9.&nbsp;Comandos del add-on Web MVC i18n">ap&eacute;ndice de comandos del
    add-on</a>.</p>
  </div>
  
  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="addon-web-i18n_futuras-versiones"></a>22.3. Futuras versiones</h2></div></div></div>
    

    <p>Mejoras a incluir en futuras versiones del
    add-on.</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p>Incluir el soporte para el resto de lenguas
        cooficiales del estado espa&ntilde;ol, es decir, Gallego y Euskera.
        Se deja abierta la posibilidad de a&ntilde;adir idiomas de otros
        estados que pudiesen ser de utilidad.</p>
      </li></ul></div>
  </div>
  
</div>

    <div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="addon-dynamic_config"></a>Chapter&nbsp;23.&nbsp;Add-on Dynamic Configuration</h2></div></div></div>
  

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e3182"></a>23.1.&nbsp;Descripci&oacute;n</h2></div></div></div>
    

    <p>Este add-on pretende simplificar la gesti&oacute;n de distintos valores de
    configuraci&oacute;n por entorno. Cuando se utiliza Maven como gestor del ciclo de
    desarrollo del proyecto existe la posibilidad de utilizar <a class="ulink" href="http://maven.apache.org/guides/introduction/introduction-to-profiles.html" target="_top">
    perfiles</a> para definir los distintos entornos de
    ejecuci&oacute;n que tendr&aacute; la aplicaci&oacute;n (desarrollo, pruebas, integraci&oacute;n,
    preproducci&oacute;n, producci&oacute;n, ...).</p>
    
    <p>A continuaci&oacute;n se muestra un ejemplo de parte
    de la configuraci&oacute;n necesaria para la definici&oacute;n de perfiles en el
    fichero <span class="emphasis"><em>pom.xml</em></span>.</p>

    <pre class="programlisting">   &lt;profiles&gt;
     &lt;profile&gt;
       &lt;id&gt;nombre-entorno&lt;/id&gt;
       &lt;properties&gt;
         &lt;nombre.propiedad&gt;valor&lt;/nombre.propiedad&gt;
         ...
       &lt;/properties&gt;
     &lt;/profile&gt;
   &lt;/profiles&gt;</pre>

    <p>Esta funcionalidad permite configurar el comportamiento de la aplicaci&oacute;n 
    de manera distinta seg&uacute;n donde vaya a ser ejecutada. Por ejemplo,
    la configurac&iacute;&oacute;n de la conexi&oacute;n con la base de datos de la aplicaci&oacute;n
    posiblemente ser&aacute; una URL distinta seg&uacute;n se est&eacute; trabajando en un entorno de
    desarrollo o un entorno de producci&oacute;n. </p>

    <p>Para esto, en la secci&oacute;n <span class="emphasis"><em>&lt;properties&gt;</em></span> de
    cada secci&oacute;n <span class="emphasis"><em>&lt;profile&gt;</em></span> se pueden declarar tantas
    propiedades como se desee de
    forma que al empaquetar la aplicaci&oacute;n (habitualmente en formato WAR), se
    reemplace el valor de estas propiedades en los ficheros adecuados. Esto
    implica que en distintos archivos del proyecto, como puede ser
    <span class="emphasis"><em>persistence.xml</em></span>, empiecen a aparecer definidas
    variables con el formato <span class="emphasis"><em>${nombre.propiedad}</em></span>. Esta
    circunstancia, a la larga, puede complicar la comprensi&oacute;n de la
    configuraci&oacute;n del proyecto o dificultar su gesti&oacute;n. Por ejemplo, podr&iacute;a
    aparecer la siguiente modificaci&oacute;n en el fichero 
    <span class="emphasis"><em>src/main/resources/META-INF/persistence.xml</em></span>:</p>
    
	<pre class="programlisting">&lt;property name="hibernate.hbm2ddl.auto" value="${hibernate.hbm2ddl.auto}"/&gt;</pre>
	
	<p>Esta circunstancia, a la larga, puede complicar la comprensi&oacute;n
	de la configuraci&oacute;n del proyecto o dificultar su gesti&oacute;n.</p>
    
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e3198"></a>23.2.&nbsp;Funcionalidad</h2></div></div></div>
    

    <p>Vista la problem&aacute;tica descrita en el punto anterior, el add-on
    dynamic configuration pretende simplificar esta gesti&oacute;n.
    Permite definir distintas configuraciones de manera r&aacute;pida y simple.
    Adem&aacute;s, es independiente del sistema de gesti&oacute;n del ciclo de vida
    del proyecto, ya que aunque actualmente las configuraciones solo se pueden exportar
    a perfiles Maven, el add-on es lo suficientemente general como para poder
    exportar a formatos Ant, etc.</p>

    <p>A medida que se van ejecutando comandos del add-on se
    ir&aacute; modificando el archivo
    <span class="emphasis"><em>src/main/resources/dynamic-configuration.xml</em></span>
    que almacena la informaci&oacute;n sobre las distintas configuraciones definidas
    hasta el momento.</p>

    <p>La creaci&oacute;n de una nueva configuraci&oacute;n se realiza con el comando <a class="link" href="#apendice-comandos_addon-dynamic_config-config_save" title="26.10.1.&nbsp;configuration create">configuration
    create</a> que tiene un &uacute;nico par&aacute;metro obligatorio (<span class="emphasis"><em>name</em></span>)
    que define el nombre para la nueva configuraci&oacute;n.</p>
    
    <pre class="programlisting">roo-gvNIX&gt; <span class="bold"><strong>script --file clinic.roo</strong></span>
...
roo-gvNIX&gt; <span class="bold"><strong>configuration create --name dev</strong></span>
Updated SRC_MAIN_RESOURCES/dynamic-configuration.xml
Configuration created with currently available properties
First created configuration set as default
(use 'configuration property add' to make a property available for all configurations)
roo-gvNIX&gt; <span class="bold"><strong>configuration create --name pro</strong></span>
Updated SRC_MAIN_RESOURCES/dynamic-configuration.xml
Configuration created with currently available properties
(use 'configuration property add' to make a property available for all configurations)</pre>

	<p>Resaltar que la creaci&oacute;n de las configuraciones no es
	obligatorio realizarlas al inicio y podr&aacute;n realizarse en cualquier momento.</p>

    <p>A partir de este momento es posible a&ntilde;adir nuevas propiedades para que est&eacute;n
    disponibles para su gesti&oacute;n desde todas las configuraciones con <a class="link" href="#apendice-comandos_addon-dynamic_config-config_prop_add" title="26.10.2.&nbsp;configuration property add">configuration
    property add</a>. Las propiedades inicialmente tomar&aacute;n el valor que tengan
    definido en el proyecto.</p>
    
    <pre class="programlisting">roo-gvNIX&gt; <span class="bold"><strong>configuration property add --name database.url</strong></span>
Updated SRC_MAIN_RESOURCES/dynamic-configuration.xml
Property available for all configurations
(use 'configuration property value' to set property new values)
(use 'configuration property undefined' to set property with no values)
roo-gvNIX&gt; <span class="bold"><strong>configuration property add --name hibernate.hbm2ddl.auto</strong></span>
Updated SRC_MAIN_RESOURCES/dynamic-configuration.xml
Property available for all configurations
(use 'configuration property value' to set property new values)
(use 'configuration property undefined' to set property with no values)
roo-gvNIX&gt; <span class="bold"><strong>configuration property add --name log4j.rootLogger</strong></span>
Updated SRC_MAIN_RESOURCES/dynamic-configuration.xml
Property available for all configurations
(use 'configuration property value' to set property new values)
(use 'configuration property undefined' to set property with no values)
roo-gvNIX&gt; <span class="bold"><strong>configuration property add --name database.password</strong></span>
Updated SRC_MAIN_RESOURCES/dynamic-configuration.xml
Updated SRC_MAIN_RESOURCES/dynamic-configuration.xml
Property available for all configurations
(use 'configuration property value' to set property new values)
(use 'configuration property undefined' to set property with no values)</pre>
    
    <p>A continuaci&oacute;n, se podr&aacute;n modificar los valores de cada propiedad con <a class="link" href="#apendice-comandos_addon-dynamic_config-config_prop_update" title="26.10.3.&nbsp;configuration property value">configuration
    property value</a>.</p>
    
    <pre class="programlisting">roo-gvNIX&gt; <span class="bold"><strong>configuration property value --configuration dev --property database.url
		--value jdbc:hsqldb:mem:mydevdb</strong></span>
Updated SRC_MAIN_RESOURCES/dynamic-configuration.xml
Property value seted
(use 'configuration list' to show configurations and their properties)
roo-gvNIX&gt; <span class="bold"><strong>configuration property value --configuration pro
		--property database.url --value jdbc:hsqldb:file:myprodb</strong></span>
Updated SRC_MAIN_RESOURCES/dynamic-configuration.xml
Property value seted
(use 'configuration list' to show configurations and their properties)
roo-gvNIX&gt; <span class="bold"><strong>configuration property value --configuration pro
		--property hibernate.hbm2ddl.auto --value update</strong></span>
Updated SRC_MAIN_RESOURCES/dynamic-configuration.xml
Property value seted
(use 'configuration list' to show configurations and their properties)
roo-gvNIX&gt; <span class="bold"><strong>configuration property value --configuration pro
		--property log4j.rootLogger --value "ERROR, stdout"</strong></span>
Updated SRC_MAIN_RESOURCES/dynamic-configuration.xml
Property value seted
(use 'configuration list' to show configurations and their properties)</pre>
    
    <p>En algunos casos, por seguridad, puede ser necesario que el valor de
    una propiedad no est&eacute; almacenado en el proyecto, para ello puede utilizarse el
    comando <a class="link" href="#apendice-comandos_addon-dynamic_config-config_prop_undefined" title="26.10.4.&nbsp;configuration property undefined">
    configuration property undefined</a> de forma que el valor se tendr&aacute; que proporcionar
    al empaquetar la aplicaci&oacute;n con Maven como un par&aacute;metro mediante el modificador
    <span class="emphasis"><em>-D nombre=valor</em></span>.</p>
    
	<pre class="programlisting">roo-gvNIX&gt; <span class="bold"><strong>configuration property undefined --configuration pro
		--property database.password</strong></span>
Updated SRC_MAIN_RESOURCES/dynamic-configuration.xml
Property value undefined
(use '-D propname=propvalue' on maven commands to set the property value)
(use 'configuration list' to show configurations and their properties)</pre>
    
    <p>Si se desea ver las distintas configuraciones que creadas, sus
    propiedades y los valores definidos para cada una de ellas utilizar el comando <a class="link" href="#apendice-comandos_addon-dynamic_config-config_list" title="26.10.5.&nbsp;configuration list">configuration
    list</a>.</p>

    <pre class="programlisting">roo-gvNIX&gt; <span class="bold"><strong>configuration list</strong></span>
      (Active)      dev
----------------------------------------
 * Database Connection Properties
   - database.url = "jdbc:hsqldb:mem:mydevdb"
   - database.password = ""
 * Persistence Property Attributes XML
   - hibernate.hbm2ddl.auto = "create"
 * Logging Service Properties
   - log4j.rootLogger = "INFO, stdout"
                    pro
----------------------------------------
 * Database Connection Properties
   - database.url = "jdbc:hsqldb:file:myprodb"
   - database.password = (UNDEFINED)
 * Persistence Property Attributes XML
   - hibernate.hbm2ddl.auto = "update"
 * Logging Service Properties
   - log4j.rootLogger = "ERROR, stdout"
(use 'configuration export' to write configurations into the project)</pre>
    
    <p>Para escribir las configuraciones actuales en el proyecto
    se debe utilizar el comando <a class="link" href="#apendice-comandos_addon-dynamic_config-config_export" title="26.10.6.&nbsp;configuration export">configuration
    export</a>. Es muy importante destacar que hasta que no se haya ejecutado
    este comando, las configuraciones no ser&aacute;n escritas en los ficheros destino
    y por lo tanto hasta ese momento no se podr&aacute;n utilizar las configuraciones.</p>
    
    <pre class="programlisting">roo-gvNIX&gt; <span class="bold"><strong>configuration export</strong></span>
Updated ROOT/pom.xml
Updated ROOT/pom.xml
Updated SRC_MAIN_RESOURCES/META-INF/spring/database.properties
Updated SRC_MAIN_RESOURCES/log4j.properties
Updated SRC_MAIN_RESOURCES/META-INF/persistence.xml
Updated SRC_MAIN_RESOURCES/META-INF/spring/database.properties
Updated SRC_MAIN_RESOURCES/log4j.properties
Updated SRC_MAIN_RESOURCES/META-INF/persistence.xml
Configurations exported into project
(use '-P name' on maven commands to use a configuration)
(use 'configuration create' to define a new configuration)
</pre>
    
    <p>Una vez exportadas las configuraciones, pueden utilizarse
    como perfiles desde Maven mediante el modificador <span class="emphasis"><em>-P nombre</em></span>
    utilizando como nombre el valor que se defini&oacute; para la configuraci&oacute;n con el comando
    <a class="link" href="#apendice-comandos_addon-dynamic_config-config_save" title="26.10.1.&nbsp;configuration create">configuration
    create</a>. Por ejemplo, al empaquetar la aplicaci&oacute;n para
	desplegarla en uno u otro entorno, debe especificarse el nombre de la configuraci&oacute;n
	y opcionalmente el valor de los par&aacute;metros que se crearon como indefinidos
	en la configuraci&oacute;n.</p>
	
<pre class="programlisting">shell&gt; <span class="bold"><strong>mvn clean package -P dev</strong></span>
... (Empaquetando la aplicaci&oacute;n con la configuraci&oacute;n llamada dev) ...
shell&gt; <span class="bold"><strong>mvn clean package -P pro -D database.password=mypassword</strong></span>
... (Empaquetando la aplicaci&oacute;n con la configuraci&oacute;n llamada pro) ...
... (Se utilizar&aacute; como clave de acceso a la base de datos "mypassword") ...</pre>

	<p>Tambi&eacute;n es posible
	elegir la configuraci&oacute;n (perfil) a utilizar desde Eclipse/STS
	desde las propiedades del proyecto accediendo a la opci&oacute;n
	<span class="emphasis"><em>Maven</em></span> del men&uacute;.</p>

	<div class="figure"><a name="d4e3246"></a><div class="figure-contents">
	  
	
	  <div class="mediaobject" align="center"><img src="images/eclipse_maven_profiles.png" align="middle" alt="Selecci&oacute;n del perfil Maven desde Eclipse"></div>
	</div><p class="title"><b>Figure&nbsp;23.1.&nbsp;Selecci&oacute;n del perfil Maven desde Eclipse</b></p></div><br class="figure-break">
	
  </div>
  
  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="addon-dynamic_config_futuras-versiones"></a>23.3.&nbsp;Futuras versiones</h2></div></div></div>
    

	<div class="itemizedlist"><ul type="disc"><li>
		    <p>Incluir nuevas propiedades a la lista de propiedades
		    disponibles para las configuraciones. O por contra, permitir cierta libertad
		    para a&ntilde;adir cualquier propiedad del proyecto como configurable.</p>
		 </li><li>
		    <p>Posibilidad de incluir otro tipo de elementos
		    en las configuraciones como, por ejemplo, distintas dependencias.</p>
		 </li><li>
		    <p>Definir plantillas de configuraci&oacute;n de modo
		    que establezcan unos valores est&aacute;ndar que se consideren adecuados
		    para una determinada configuraci&oacute;n. Por ejemplo, establecer el
		    formato de los logs en producci&oacute;n para reducir el consumo de recursos.</p>
		 </li></ul></div>
  </div>
</div>

    <div class="chapter" lang="es"><div class="titlepage"><div><div><h2 class="title"><a name="addon-web-mvc-binding"></a>Cap&iacute;tulo 24. Add-on Web MVC Binding</h2></div></div></div>
  

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="addon-web-mvc-binding_descripcion"></a>24.1. Descripci&oacute;n</h2></div></div></div>
    

    <p>El add-on permite registrar ciertos editores de
    propiedades en Spring MVC para uno o todos los controladores
    del proyecto.</p>
    
    <p>Los editores son una pieza m&aacute;s de la arquitectura de
    Spring MVC. Se encargan de controlar el modo en que las cadenas
    enviadas por el navegador cliente, por ejemplo desde un formulario,
    se convierten en objetos al llegar al servidor.</p>

    <p>Para obtener m&aacute;s informaci&oacute;n sobre los editores de
    propiedades ver la <a class="ulink" href="http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/validation.html#beans-beans-conversion" target="_top">
    secci&oacute;n de conversi&oacute;n de beans</a> de la documentaci&oacute;n de Spring.</p>
    
    <p>El comando <a class="link" href="#apendice-comandos_addon-web-mvc-binding_web-binding-setup" title="26.11.1.&nbsp;web mvc binding stringTrimmer">
    web mvc binding stringTrimmer</a> permite registrar un editor
    especialmente &uacute;til. Este editor elimina los espacios en blanco al principio
    y al final de las cadenas y adem&aacute;s permite transformar las
    cadenas vac&iacute;as en valores nulos.</p>
    
    <p>Este editor es especialmente interesante al
    realizar mantenimientos de valores almacenados en bases de datos.
    Por defecto, cuando se deja vac&iacute;o un valor de un formulario y est&aacute;
    relacionado con una columna de base de datos del tipo cadena, al
    almacenar se escribe una cadena vac&iacute;a. En estos casos puede suele
    ser m&aacute;s interesante almacenar un valor nulo.</p>

<pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>web mvc binding stringTrimmer --class ~.web.EntityController</strong></span>
Updated SRC_MAIN_JAVA/org/gvnix/test/web/EntityController.java
Updated ROOT/pom.xml added dependency org.gvnix:org.gvnix.web.mvc.binding.roo.addon:1.0.0
Created SRC_MAIN_JAVA/org/gvnix/test/web/EntityController_Roo_GvNIXStringTrimmerBinder.aj</pre>

    <p>Al ejecutar el comando, el add-on incluir&aacute; la
    anotaci&oacute;n  @GvNIXStringTrimmerBinder en la clase
    controladora especificada en el par&aacute;metro <span class="emphasis"><em>--class</em></span>
    del comando o en todas las clases controladoras del proyecto si no se
    especific&oacute; dicho par&aacute;metro. El par&aacute;metro <span class="emphasis"><em>--emptyAsNull</em></span>
    por defecto toma el valor <span class="emphasis"><em>true</em></span> indicando que
    las cadenas vac&iacute;as deben convertirse en valores nulos.</p>
    
<pre class="programlisting">...
@GvNIXStringTrimmerBinder(emptyAsNull = true)
public class EntityController {
}</pre>

    <p>Esto generar&aacute; en un aspecto Java propio 
    todo el c&oacute;digo necesario para registrar el 
    editor, representado en Spring MVC mediante la clase <a class="ulink" href="http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/beans/propertyeditors/StringTrimmerEditor.html" target="_top">
    StringTrimmerEditor</a>.</p>
    
<pre class="programlisting">privileged aspect EntityController_Roo_GvNIXStringTrimmerBinder {

    @InitBinder
    public void EntityController.initStringTrimmerBinder(WebDataBinder binder) {
        binder.registerCustomEditor(String.class, new StringTrimmerEditor(true));
    }

}</pre>

	<p>Es interesante resaltar que este m&eacute;todo puede ser
	reutilizado haciendo push-in para registrar cualquier editor asociado a
	un tipo de datos adecuado, como se hace en el ejemplo anterior asociando
	<span class="emphasis"><em>String</em></span> con <span class="emphasis"><em>StringTrimmerEditor</em></span>.</p>

    <p>Para obtener mas detalles sobre el comando ver el <a class="link" href="#apendice-comandos_addon-web-mvc-binding" title="26.11.&nbsp;Comandos del add-on Web MVC Binding">ap&eacute;ndice de
    comandos</a> de este add-on.</p>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="addon-web-mvc-binding_futuras-versiones"></a>24.2. Futuras versiones</h2></div></div></div>
    

    <div class="itemizedlist"><ul type="disc"><li>
		    <p>Para futuras versiones este add-on permitir&aacute; registrar
		    m&aacute;s editores de entre los enumerados en la Tabla 5.2 de la <a class="ulink" href="http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/validation.html#beans-beans-conversion" target="_top">
		    documentaci&oacute;n de Spring</a>.</p>
	    </li></ul></div>
  </div>
</div>
  </div>

  <div class="part" lang="es"><div class="titlepage"><div><div><h1 class="title"><a name="d4e3292"></a>Parte&nbsp;IV.&nbsp;Recetas de desarrollo</h1></div></div></div>
    

    <div class="partintro" lang="es"><div></div>
      <p>En esta parte se ver&aacute;n distintas gu&iacute;as para realizar ciertas
      modificaciones sobre el c&oacute;digo generado para adaptarlo a distintas necesidades.</p>
	</div>
	
    <div class="chapter" lang="es"><div class="titlepage"><div><div><h2 class="title"><a name="recetas"></a>Cap&iacute;tulo 25. Recetas</h2></div></div></div>
  

  <p>En este cap&iacute;tulo se ver&aacute; como realizar algunas modificaciones 
  sobre el c&oacute;digo generado para adaptar la aplicaci&oacute;n a distintos
  requerimientos habituales dada la experiencia de uso del framework.</p>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="recetas-repositorio_maven"></a>25.1. Repositorios Maven</h2></div></div></div>
    

    <p>Cuando una funcionalidad generada por el framework
    requiere de librer&iacute;as externas, el add-on correspondiente registrar&aacute;
    el repositorio de artefactos Maven necesario en el fichero
    <span class="emphasis"><em>pom.xml</em></span>, si todav&iacute;a no lo estaba.</p>
    
    <p>No es habitual, pero en el caso de ser necesario a&ntilde;adir alg&uacute;n
    repositorio adicional al proyecto puede realizarse mediante el comando de la consola <a class="ulink" href="http://static.springsource.org/spring-roo/reference/html-single/index.html#command-index-maven-repository-add" target="_top">
    maven repository add </a>. El siguiente ejemplo define el repositorio Maven
    interno de la Consejer&iacute;a de Infraestructuras, Transporte y Medio
    Ambiente. Este repositorio es accesible &uacute;nicamente desde la red interna
    de la Consejer&iacute;a.</p>

<pre class="programlisting">roo-gvNIX&gt; maven repository add --id citma-maven --name "CITMA Maven Repository" 
		--url http://benigno.coput.gva.es:8081/nexus/content/groups/public
Updated ROOT/pom.xml [
		added repository http://benigno.coput.gva.es:8081/nexus/content/groups/public]</pre>

    <p>El comando modificar&aacute; el fichero pom.xml y en la secci&oacute;n
    <span class="emphasis"><em>&lt;repositories&gt;</em></span> a&ntilde;adir&aacute; la definici&oacute;n del repositorio
    indicado.</p>

    <pre class="programlisting">&lt;repositories&gt;
    ...
    &lt;repository&gt;
        &lt;id&gt;citma-maven&lt;/id&gt;
        &lt;url&gt;http://benigno.coput.gva.es:8081/nexus/content/groups/public&lt;/url&gt;
        &lt;name&gt;CITMA Maven Repository&lt;/name&gt;
    &lt;/repository&gt;
    ...
&lt;/repositories&gt;</pre>

    <p>En el lado opuesto, tambi&eacute;n es posible eliminar repositorios
    Maven del proyecto mediante el comando <a class="ulink" href="http://static.springsource.org/spring-roo/reference/html-single/index.html#command-index-maven-repository-remove" target="_top">
    maven repository remove </a>. </p>

  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="recetas-finders-multitud-campos"></a>25.2. Desarrollo de buscadores con gran cantidad de campos</h2></div></div></div>
    

    <p>El add-on de los buscadores (finder) tiene una limitaci&oacute;n
    impuesta por el sistema operativo Windows en el tama&ntilde;o m&aacute;ximo del nombre de
    archivos. La limitaci&oacute;n del tama&ntilde;o m&aacute;ximo del nombre de
    archivo limita al comando <span class="emphasis"><em>finder add</em></span> a generar
    nombres de buscadores que generen paths a archivos jspx de tama&ntilde;o
    menor de 244 caracteres.</p>

    <p>Existe una forma para generar buscadores con un tama&ntilde;o
    superior al de la limitaci&oacute;n impuesta. Consiste en
    dividir el buscador necesario en varios m&aacute;s peque&ntilde;os, parciales de unos
    pocos campos cada uno, y al final unir el c&oacute;digo que se genera para cada
    uno de ellos en un unico m&eacute;todo. Esto implica tener que modificar el
    c&oacute;digo que se ha generado para el buscador en la entidad, el controlador y
    la jspx de la siguiente forma:</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p>En el archivo Java de la entidad para la que se est&aacute;
        generando el buscador crear un m&eacute;todo con el nombre, por ejemplo, 
        <span class="emphasis"><em>findByTodo</em></span> y cuyos par&aacute;metros de entrada ser&aacute;n
        todos los par&aacute;metros que reciben los m&eacute;todos de los buscadores
        parciales que se hayan generado. Del mismo modo, el cuerpo de este nuevo
        m&eacute;todo es la uni&oacute;n de la implementaci&oacute;n de todos los buscadores
        parciales. Es posible modificar el c&oacute;digo, seg&uacute;n se explica
        en el siguiente apartado, de forma que los par&aacute;metros sean
        opcionales.</p>
      </li><li>
        <p>De manera similar, en el fichero Java del controlador de la
        entidad crear dos m&eacute;todos: uno <span class="emphasis"><em>findByTodoForm</em></span> que
        devolver&aacute; la vista del formulario del buscador y otro
        <span class="emphasis"><em>findByTodo</em></span> que responder&aacute; a las peticiones que lleguen
        desde el formulario del buscador. Este segundo m&eacute;todo, al igual que
        en el m&eacute;todo creado en la entidad, deber&aacute; tener como par&aacute;metros la uni&oacute;n de
        todos par&aacute;metros de los m&eacute;todos de los buscadores parciales en el controlador.
        El cuerpo de este m&eacute;todo deber&aacute; invocar al m&eacute;todo <span class="emphasis"><em>findByTodo</em></span>
        creado en la entidad. Para definir la anotaci&oacute;n @RequestMapping de estos dos
        m&eacute;todos se recomienda utilizar como gu&iacute;a los buscadores parciales ya existentes.</p>
      </li><li>
        <p>Finalmente, crear una p&aacute;gina jspx (por ejemplo, con nombre
        findByTodo.jspx) en el directorio WEB-INF/views/&lt;entidad&gt; que
        contendr&aacute; el formulario del buscador. Esta p&aacute;gina debe incluir todos
        los campos que hayan en el resto de p&aacute;ginas jspx de los buscadores parciales.
        Recordar, que esta vista se ha de definir tambi&eacute;n en el fichero views.xml
        que hay en la misma carpeta y que esta vista es la que devuelve
        el m&eacute;todo findByTodoForm creada anteriormente en el controlador.</p>
      </li></ul></div>

    <p>Con todo lo anterior se ha descrito un proceso manual
    que permite montar buscadores con cualquier cantidad de campos.</p>
	
  </div>
	
  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="recetas-finders-modificar"></a>25.3. Campos opcionales en los buscadores</h2></div></div></div>
    

    <p>El comportamiento que implementa autom&aacute;ticamente la generaci&oacute;n
    de buscadores es hacer todos los campos de busqueda obligatorios.
    Por lo tanto, si no se proporciona alguno de los par&aacute;metros
    se generar&aacute; una excepci&oacute;n indicando la falta de un par&aacute;metro
    obligatorio. En ocasiones no es lo deseado, es decir,
    puede necesario que los par&aacute;metros no informados simplemente
    no se incluyan en la consulta si no se especifican. Para ello se debe
    modificar el c&oacute;digo del m&eacute;todo <span class="emphasis"><em>finderByXxxx</em></span>
    declarado en el aspecto Java <span class="emphasis"><em>*_Roo_Finder.aj</em></span>.
    A continuaci&oacute;n se ejemplifica como hacer este cambio.</p>

    <p>Hacer <span class="emphasis"><em>push-in</em></span> del m&eacute;todo tal y como
    se comenta en la secci&oacute;n sobre <a class="link" href="#guia-desarrollo_generacion-codigo" title="Cap&iacute;tulo 7. C&oacute;digo generado por gvNIX/Roo">modificaci&oacute;n del c&oacute;digo
    generado</a> y llevarlo al fichero Java de la entidad. Una vez all&iacute;
    modificarlo para que no requiera los campos y as&iacute; construir la consulta
    considerando tan solo los par&aacute;metros que lleguen informados:</p>

    <pre class="programlisting">public static TypedQuery&lt;Owner&gt; findOwnersByLastNameLikeAndCityLike(
    		String lastName, String city) {
  <span class="command"><strong>StringBuilder query = new StringBuilder("SELECT o FROM Owner AS o");</strong></span>
  <span class="command"><strong>StringBuilder whereClause = new StringBuilder();</strong></span>

  <span class="command"><strong>// if (lastName == null || lastName.length() == 0)
  // throw new IllegalArgumentException("The lastName argument is required");
  if (lastName != null &amp;&amp; lastName.length() &gt; 0) {</strong></span>
    lastName = lastName.replace('*', '%');
    if (lastName.charAt(0) != '%') {
        lastName = "%" + lastName;
    }
    if (lastName.charAt(lastName.length() - 1) != '%') {
        lastName = lastName + "%";
    }
    <span class="command"><strong>whereClause.append(" WHERE LOWER(o.lastName) LIKE LOWER(:lastName)");</strong></span>
  }

  <span class="command"><strong>// if (city == null || city.length() == 0)
  // throw new IllegalArgumentException("The city argument is required");
  if (city != null &amp;&amp; city.length() &gt; 0) {</strong></span>
    city = city.replace('*', '%');
    if (city.charAt(0) != '%') {
        city = "%" + city;
    }
    if (city.charAt(city.length() - 1) != '%') {
        city = city + "%";
    }
    <span class="command"><strong>if (whereClause.length() &gt; 0) {
      whereClause.append(" AND LOWER(o.city) LIKE LOWER(:city)");
    } else {
      whereClause.append(" WHERE LOWER(o.city) LIKE LOWER(:city)");
    }</strong></span>
  }
  <span class="command"><strong>query.append(whereClause);</strong></span>

  EntityManager em = Owner.entityManager();
  TypedQuery&lt;Owner&gt; q = em.createQuery(<span class="command"><strong>query.toString()</strong></span>, Owner.class);
  <span class="command"><strong>if (lastName != null &amp;&amp; lastName.length() &gt; 0) {</strong></span>
    q.setParameter("lastName", lastName);
  }
  <span class="command"><strong>if (city != null &amp;&amp; city.length() &gt; 0) {</strong></span>
    q.setParameter("city", city);
  }
  return q;
}</pre>

    <p>Se han marcado en negrita las l&iacute;neas de c&oacute;digo modificadas.
    Como puede observarse, se construye la consulta de forma din&aacute;mica de forma
    que se a&ntilde;aden los distintos filtros al <span class="emphasis"><em>where</em></span> de la consulta
    solo si el campo asociado al filtro tiene alg&uacute;n valor y se elimina la generaci&oacute;n
    de excepciones al detectar alguno de dichos campos como vac&iacute;o.</p>

    <p>En este ejemplo se ha construido la consulta usando un
    StringBuilder en el que se genera la consulta deseada, pero se podr&iacute;a
    utilizar cualquier otra tecnolog&iacute;a como por ejemplo Hibernate
    Criteria Builder.</p>

    <p>Como ya se ha comentado, el c&oacute;digo generado fuerza que todos los
    par&aacute;metros de b&uacute;squeda sean obligatorios, esto implica tambi&eacute;n al
    formulario situadao en la p&aacute;gina jspx. Tal como se genera, si alguno de los campos no se
    rellena, no dejar&aacute; enviar la petici&oacute;n. Se debe editar la jspx y
    modificar el atributo <span class="emphasis"><em>required</em></span> de los campos
    <span class="emphasis"><em>field</em></span> y establecer su valor a
    <span class="emphasis"><em>false</em></span>, no olvidar cambiar el valor
    del atributo <span class="emphasis"><em>z</em></span> a
    "<span class="emphasis"><em>user-managed</em></span>" para indicar que este campo ha sido
    personalizado.</p>

    <pre class="programlisting">&lt;field:input disableFormBinding="true" field="city"
    		id="f_com_springsource_petclinic_domain_Owner_city" max="30" <span class="bold"><strong>
        		required="false" z="user-managed"</strong></span>/&gt;</pre>

    <p>En los buscadores en los que uno de los par&aacute;metros sea
    una entidad del modelo, es decir una relaci&oacute;n con otra entidad del modelo,
    ser&aacute; necesario realizar un cambio adicional.
    En estos casos se visualiza un selector desplegable, mediante el
    componente <span class="emphasis"><em>select.tagx</em></span>. Sin embargo, este selector
    tiene el inconveniente de que no incluye una opci&oacute;n vac&iacute;a
    entre las disponibles, con lo que obliga a elegir siempre alg&uacute;n valor.
    Un ejemplo de este caso se encuentra en el buscador findPetsByOwner generado
    para la entidad Pet en el ejemplo de <span class="emphasis"><em>clinic.roo</em></span>
    .</p>

    <p>La forma de tratar estas peticiones en Spring MVC es intentar
    cargar el registro asociado con el valor del selector que llega como par&aacute;metro.
    Por tanto si llega como par&aacute;metro un dato que no concuerda con ning&uacute;n registro de
    la entidad par&aacute;metro, usar&aacute; null como valor. Como se ha comentado,
    el componente <span class="emphasis"><em>select.tagx</em></span> no ofrece una opci&oacute;n
    vac&iacute;a. gvNIX en su <a class="link" href="#addon-web-screen-patterns" title="Cap&iacute;tulo 16. Add-on Web Screen Patterns">Add-on Web
    MVC Pattern</a> incluye un componente
    <span class="emphasis"><em>select-withempty.tagx</em></span> que s&iacute; lo ofrece. Mediante el
    comando <span class="emphasis"><em>web mvc pattern install</em></span> se instalan los
    componentes de MVC Pattern entre los que se incluye el selector con
    opci&oacute;n vac&iacute;a. Entonces es posible modificar la jspx del buscador findPetsByOwner
    para que utilice <span class="emphasis"><em>select-withempty</em></span> en lugar del original
    de la siguiente forma:</p>

    <pre class="programlisting">&lt;div xmlns:field="urn:jsptagdir:/WEB-INF/tags/form/fields" ... 
    		<span class="bold"><strong>xmlns:pattern-field="urn:jsptagdir:/WEB-INF/tags/pattern/form/fields"</strong></span>
    		version="2.0"&gt;
  &lt;jsp:directive.page contentType="text/html;charset=UTF-8"/&gt;
  &lt;jsp:output omit-xml-declaration="yes"/&gt;
  &lt;form:find finderName="ByOwner" id="ff_com_springsource_petclinic_domain_Pet"
  		path="/pets" z="ThIGSmua6R7WM6q2P1BpNC3zMi4="&gt;
      <span class="bold"><strong>&lt;pattern-field:select-withempty disableFormBinding="true" field="owner"
      		emptyValueEnable="true" emptyValue="0"
      		id="f_com_springsource_petclinic_domain_Pet_owner" itemValue="id"
      		items="${owners}" path="/owners" required="false" z="user-managed"/&gt;</strong></span>
  &lt;/form:find&gt;
&lt;/div&gt;</pre>

    <p>El componente select-withempty.tagx tiene los mismos atributos que el
    select.tagx y otros tres adicionales:</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p><span class="emphasis"><em>emptyValueEnable</em></span>: Valor booleano que habilita la
        opci&oacute;n vac&iacute;a en el selector.</p>
      </li><li>
        <p><span class="emphasis"><em>emtpyValue</em></span>: Valor a dar
        para la opci&oacute;n vac&iacute;a del selector. Si se corresponde con una entidad,
        este valor no deber&iacute;a corresponder con ning&uacute;n identificador existente
        para esa entidad, de esta forma el valor que llega al buscador es
        nulo.</p>
      </li><li>
        <p><span class="emphasis"><em>emptyLabel</em></span>: Descripci&oacute;n a mostrar para la
        opci&oacute;n vac&iacute;a del selector.</p>
      </li></ul></div>

    <p>Con este cambio y con el m&eacute;todo findPetsByOwner modificado
    para que no sea requerido el par&aacute;metro Owner, de la misma forma
    que se explicado antes, se consigue realizar b&uacute;squedas por par&aacute;metros opcionales
    sea cual sea el tipo del par&aacute;metro.</p>
  </div>
  
  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="recetas-reports-fuentes"></a>25.4. Instalar fuentes de letra para los informes</h2></div></div></div>
    

    <p>Las fuentes instaladas autom&aacute;ticamente proporcionan soporte para
    la inclusi&oacute;n de texto en negrita y cursiva. El desarrollador debe instalar cualquier
    otro tipo de fuente que se utilice en los informes que dise&ntilde;e. Para ello, basta con
    ampliar las definiciones <span class="emphasis"><em>fontFamily</em></span> realizadas en el archivo
    <span class="emphasis"><em>gvnix_reportfonts.xml</em></span> y copiar los archivos de
    fuente en la carpeta <span class="emphasis"><em>jasperfonts</em></span>. La inclusi&oacute;n de nuevas
    fuentes se puede realizar utilizando una utilidad que ofrece iReport.
    Desde el men&uacute; <span class="emphasis"><em>Herramientas &gt; Opciones &gt; Pesta&ntilde;a
    Fonts</em></span> se acceder&aacute; a la siguiente pantalla:</p>

    <div class="figure"><a name="d4e3389"></a><div class="figure-contents">
      

      <div class="mediaobject" align="center"><img src="images/iReportFonts.png" align="middle" alt="Herramienta de gesti&oacute;n de fuentes de IReport"></div>
    </div><p class="title"><b>Figura 25.1. Herramienta de gesti&oacute;n de fuentes de IReport</b></p></div><br class="figure-break">

    <p>Desde esta pantalla, seleccionando una fuente de la lista de
    fuentes instaladas en iReports y con el bot&oacute;n <span class="emphasis"><em>"Export as
    extension"</em></span> se crear&aacute; un archivo JAR que al descomprimirlo
    contiene:</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p>Directorio fonts</p>

        <div class="itemizedlist"><ul type="circle"><li>
            <p>Archivos de fuentes en formato TTF.</p>
          </li><li>
            <p>Archivo
            <span class="emphasis"><em>fontsfamily&lt;IdentificadorAleatorio&gt;.xml</em></span></p>
          </li></ul></div>
      </li><li>
        <p>Archivo
        <span class="emphasis"><em>jasperreports_extension.properties</em></span></p>
      </li></ul></div>

    <p>Para instalar esta fuente en la aplicaci&oacute;n se deben
    copiar los ficheros con extensi&oacute;n TTF a 
    <span class="emphasis"><em>/WEB-INF/classes/jasperfonts</em></span> y del archivo
    <span class="emphasis"><em>fontsfamily&lt;IdentificadorAleatorio&gt;.xml</em></span>
    adaptar el elemento &lt;fontFamily/&gt; para copiarlo en el archivo del proyecto
    <span class="emphasis"><em>gvnix_reportfonts.xml</em></span> (modificando las rutas para
    que apunten a <span class="emphasis"><em>jasperfonts</em></span>). El archivo <span class="emphasis"><em>
    jasperreports_extension.properties</em></span> se puede ignorar porque
    ya se encuentra definido en el proyecto en
    <span class="emphasis"><em>/WEB-INF/classes.</em></span></p>
  </div>

  <div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="recetas-reports-subinforme"></a>25.5. Dise&ntilde;o de informes con sub informes</h2></div></div></div>
    

    <p>gvNIX mediante el <a class="link" href="#addon-web-report" title="Cap&iacute;tulo 20. Add-on Web Report">Add-on Web
    Report</a> facilita la creaci&oacute;n de informes sobre una entidad.
    El add-on genera el dise&ntilde;o de un informe Jasper Reports b&aacute;sico el cual
    se puede modificar utilizando un dise&ntilde;ador gr&aacute;fico como iReport.</p>

    <p>Puede ser necesario mostrar en un informe una lista de
    entidades relacionadas con la entidad sobre la que se ha generado el
    informe. Por ejemplo, en la aplicaci&oacute;n del script de ejemplo clinic.roo, se podr&iacute;a
    definir un informe sobre la entidad Owner y desear mostrar para cada Owner
    la lista de mascotas que le pertenecen, es decir, listar la relaci&oacute;n definida por el campo
    <span class="emphasis"><em>Set&lt;Pet&gt; pets</em></span> de la entidad Owner.</p>

    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Nota</h3>
      <p>Para este ejemplo se utilizar&aacute; la versi&oacute;n 4.0.1 de iReport.</p>
    </div>

    <p>Partiendo del informe definido por el siguiente comando de gvNIX:</p>

    <pre class="programlisting">roo-gvNIX&gt; web report add --controller ~.web.OwnerController --reportName ownerpets</pre>

    <p>En src/main/webapp/WEB-INF/reports se crear&aacute; el archivo con el dise&ntilde;o
    del informe <span class="emphasis"><em>owner_ownerpets.jrxml</em></span>. Abriendo este
    archivo usando iReport (<span class="emphasis"><em>Archivo &gt; Open</em></span>) aparecer&aacute;
    una pantalla como la que se muestra a continuaci&oacute;n.</p>

    <div class="figure"><a name="d4e3428"></a><div class="figure-contents">
      

      <div class="mediaobject" align="center"><img src="images/recetas-subreport-ireport-1.png" align="middle" alt="iReport - Dise&ntilde;ador"></div>
    </div><p class="title"><b>Figura 25.2. iReport - Dise&ntilde;ador</b></p></div><br class="figure-break">

    <p>En la parte izquierda, en la pesta&ntilde;a con t&iacute;tulo
    <span class="emphasis"><em>Report Inspector</em></span> se pueden observar
    los elementos principales del dise&ntilde;o de informes. </p>

    <div class="figure"><a name="d4e3435"></a><div class="figure-contents">
      

      <div class="mediaobject" align="center"><img src="images/recetas-subreport-ireport-2.png" align="middle" alt="iReport - Report Inspector"></div>
    </div><p class="title"><b>Figura 25.3. iReport - Report Inspector</b></p></div><br class="figure-break">

    <p>Lo primero que se debe hacer es declarar un nuevo par&aacute;metro con,
    por ejemplo, el nombre <span class="emphasis"><em>SubReportPetsLocation</em></span>. Para ello hacer
    click con el bot&oacute;n derecho sobre el elemento
    <span class="emphasis"><em>Parameters</em></span> y seleccionar la opci&oacute;n
    <span class="emphasis"><em>Agregar Parameter</em></span>. Justo debajo del &uacute;ltimo par&aacute;metro
    aparecer&aacute; uno nuevo con nombre <span class="emphasis"><em>parameter1</em></span>. Al seleccionarlo,
    en la parte derecha de la ventana de iReport se podr&aacute;n ver
    sus propiedades. Modificar sus propiedades estableciendo en la
    propiedad<span class="emphasis"><em>Name</em></span> el valor
    <span class="emphasis"><em>SubReportPetsLocation</em></span> y en la propiedad
    <span class="emphasis"><em>Parameter Class</em></span> el valor
    <span class="emphasis"><em>net.sf.jasperreports.engine.JasperReport</em></span>.</p>

    <p>A continuaci&oacute;n, a&ntilde;adir un elemento <span class="emphasis"><em>Subreport</em></span>
    al dise&ntilde;o. Para que aparezca el <span class="emphasis"><em>Subreport</em></span>
    para cada elemento de la lista de Owners,
    se debe a&ntilde;adir en la banda de detalle <span class="emphasis"><em>Detail1</em></span> del informe.
    Ser&aacute; necesario aumentar la altura de la banda <span class="emphasis"><em>Detail1</em></span>.
    Para ello, seleccionarla y en sus propiedad <span class="emphasis"><em>Band
    height</em></span> especificar el valor <span class="emphasis"><em>55</em></span>.
    De la paleta de elementos
    seleccionar el <span class="emphasis"><em>Subreport</em></span> y arrastrarlo
    a la banda de detalle. Se abrir&aacute; un asistente, seleccionar la opci&oacute;n
    <span class="emphasis"><em>Just create the subreport element</em></span> y cerrar con
    <span class="emphasis"><em>Terminar</em></span>. Es posible modificar las dimensiones del elemento
    <span class="emphasis"><em>Subreport</em></span> arrastrando las esquinas de la caja del elemento.</p>

    <div class="figure"><a name="d4e3460"></a><div class="figure-contents">
      

      <div class="mediaobject" align="center"><img src="images/recetas-subreport-ireport-3.png" align="middle" alt="iReport - Subreport"></div>
    </div><p class="title"><b>Figura 25.4. iReport - Subreport</b></p></div><br class="figure-break">

    <p>Antes de seguir con el establecimiento de las propiedades del
    Subreport, es necesario declarar un campo del informe que permitir&aacute;
    acceder al campo <span class="emphasis"><em>pets</em></span> de la Entidad
    <span class="emphasis"><em>Owner</em></span>. En <span class="emphasis"><em>Report Inspector</em></span>,
    seleccionar <span class="emphasis"><em>Fields</em></span> y con el bot&oacute;n derecho
    <span class="emphasis"><em>Agregar Field</em></span>. Modificar tambi&eacute;n este elemento
    estableciendo en la propiedad <span class="emphasis"><em>Name</em></span> el valor
    <span class="emphasis"><em>pets</em></span> y en la propiedad <span class="emphasis"><em>Field Class</em></span>
    el valor <span class="emphasis"><em>java.util.Collection</em></span>.</p>

    <p>Se debe indicar cuales son las propiedades del 
    <span class="emphasis"><em>Subreport</em></span>. Para ello, en la
    ventana de propiedades de la derecha buscar las siguientes propiedades y
    establecer los valores que se especifican a continuaci&oacute;n:</p>

    <div class="orderedlist"><ol type="1"><li>
        <p>Subreport Expression = $P{SubReportPetsLocation}</p>
      </li><li>
        <p>Expression Class = net.sf.jasperreports.engine.JasperReport</p>
      </li><li>
        <p>Connection type = Use a datasource expression</p>
      </li><li>
        <p>Data Source Expression = 
        new net.sf.jasperreports.engine.data.JRBeanCollectionDataSource($F{pets})</p>
      </li></ol></div>

    <p>En el flujo de ejecuci&oacute;n de un informe en Jasper Reports,
    los par&aacute;metros del mismo han de ser informados antes de su
    visualizaci&oacute;n o, de lo contrario, se tomar&aacute;n los valores por defecto
    que se hubiesen definido o <span class="emphasis"><em>null</em></span> en su defecto.
    Observar que se ha definido el par&aacute;metro
    <span class="emphasis"><em>SubReportPetsLocation</em></span> y el valor que toma este
    par&aacute;metro en tiempo de ejecuci&oacute;n ha de ser una ruta absoluta al sistema
    de archivos o al classpath de la aplicaci&oacute;n. En la secci&oacute;n del <a class="link" href="#addon-web-report" title="Cap&iacute;tulo 20. Add-on Web Report">Add-on Web Report</a> se explic&oacute; que al
    a&ntilde;adir un informe a la aplicaci&oacute;n, utilizando el comando <span class="emphasis"><em>web report
    add</em></span>, en el archivo
    <span class="emphasis"><em>src/main/webapp/WEB-INF/spring/jasper-views.xml</em></span> se
    declara un bean que establece la ruta hasta el fichero jrxml del informe
    a&ntilde;adido. Este bean tiene un atributo que indica el lugar donde se declaran
    los subreports que se usan en los distintos informes mediante el atributo
    <span class="emphasis"><em>p:subReportsUrls-ref</em></span>.</p>

    <pre class="programlisting">&lt;bean id="owner_ownerpets"
class=
 "com.springsource.petclinic.web.servlet.view.jasperreports.CustomJasperReportsMultiFormatView" 
p:reportDataKey="ownerpetsList" p:url="/WEB-INF/reports/owner_ownerpets.jrxml"
p:subReportDataKeys-ref="subReportDataKeys" <span class="bold"><strong>p:subReportUrls-ref="subReportUrls"</strong></span> /&gt;</pre>

    <p>El elemento anterior marcado en negrita apunta 
    al elemento <span class="emphasis"><em>&lt;util:map/&gt;</em></span>, declarado tambi&eacute;n
    en el fichero jasper-views.xml. Aqu&iacute; se ha de especificar el valor que
    debe tomar el par&aacute;metro <span class="emphasis"><em>SubReportPetsLocation.</em></span>
    Modificar este elemento a&ntilde;adiendo una entrada, quedando como se muestra
    a continuaci&oacute;n.</p>

    <pre class="programlisting">&lt;util:map id="<span class="bold"><strong>subReportUrls</strong></span>"&gt;
  &lt;!-- This entry key must be declared exactly as declared in the master JRXML file --&gt;
  &lt;!-- Add one &lt;entry /&gt; node for each sub-report you need to define --&gt;
  <span class="bold"><strong>&lt;entry key="SubReportPetsLocation"
  		value="/WEB-INF/reports/owner_ownerpets_sub_pets.jrxml"/&gt;</strong></span>
&lt;/util:map&gt;</pre>

    <p>En el elemento <span class="emphasis"><em>&lt;util:map/&gt;</em></span>
    se pueden definir tantos elementos <span class="emphasis"><em>&lt;entry/&gt;</em></span> como 
    sea necesario para definir los par&aacute;metros que indican el lugar donde se
    localizan los archivos jrxml de los distintos
    subreports.</p>

    <p>Ahora se debe dise&ntilde;ar el informe que mostrar&aacute; el
    listado de mascotas (pets) que conformar&aacute; el subreport.</p>

    <p>Crear un nuevo dise&ntilde;o de informe (<span class="emphasis"><em>Archivo &gt;
    Nuevo</em></span>), y en el asistente seleccionar
    <span class="emphasis"><em>Blank A4</em></span> y <span class="emphasis"><em>Open This Template</em></span>.
    Se solicitar&aacute; un nombre para el dise&ntilde;o y el lugar donde guardarlo.
    Indicar, por ejemplo <span class="emphasis"><em>owner_ownerpets_sub_pets.jrxml</em></span> y
    guardarlo en el mismo directorio donde se encuentre el report padre
    (<span class="emphasis"><em>owner_ownerpets.jrxml</em></span>).</p>

    <div class="figure"><a name="d4e3511"></a><div class="figure-contents">
      

      <div class="mediaobject" align="center"><img src="images/recetas-subreport-ireport-4.png" align="middle" alt="iReport - Nuevo dise&ntilde;o"></div>
    </div><p class="title"><b>Figura 25.5. iReport - Nuevo dise&ntilde;o</b></p></div><br class="figure-break">

    <div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Importante</h3>
      <p>Se debe validar que el nuevo informe se crea con
      el lenguage Java configurado para las expresiones. En <span class="emphasis"><em>Report
      Inspector</em></span>, al seleccionar el primer elemento (el nombre del
      informe) y mirar en sus propiedades (parte derecha de la pantalla de
      iReport) se debe buscar la propiedad <span class="emphasis"><em>Language</em></span>, si
      no tiene el valor Java, cambiarla usando el desplegable.</p>
    </div>

    <p>Este nuevo informe, que constituir&aacute; el subreport, es un informe
    a todos los efectos, por tanto se debe definir los campos (elemento
    Fields del dise&ntilde;o), par&aacute;metros (elemento Parameters), etc.</p>

    <p>Al igual que se ha hecho anteriormente con el
    campo pets del informe padre,
    definir los campos que permiten acceder a los valores de la entidad
    Pet que se visualizar&aacute;n en el subreport. Click con el bot&oacute;n derecho sobre
    Fields y Agregar Field:</p>

    <div class="orderedlist"><ol type="1"><li>
        <p>Crear field con nombre
        <span class="emphasis"><em>name</em></span> y clase 
        <span class="emphasis"><em>java.lang.String</em></span> </p>
      </li><li>
        <p>Crear field con nombre
        <span class="emphasis"><em>weight</em></span> y clase
        <span class="emphasis"><em>java.lang.Float</em></span></p>
      </li><li>
        <p>Crear field con nombre
        <span class="emphasis"><em>type</em></span> y clase
        <span class="emphasis"><em>com.springsource.petclinic.reference.PetType</em></span>
        (enumerado declarado en el proyecto clinic.roo)</p>
      </li></ol></div>

    <p>El dise&ntilde;o del informe se compone de distitnas bandas, donde se
    colocan los elementos a mostrar (<span class="emphasis"><em>Title, Page Header,
    Column Header, Detail1, Column Footer, ...</em></span>). Para un
    subreport como el de este ejemplo, algunas bandas son
    innecesarias y pueden ser eliminadas. Esto permitir&aacute; ajustar mejor el
    dise&ntilde;o completo del informe (informe padre ownerpets + subreport
    pets). Si se hace click con el bot&oacute;n derecho sobre
    <span class="emphasis"><em>Title</em></span> y se selecciona <span class="emphasis"><em>Delete
    Band</em></span>, es eliminada. Hacerlo con todas las bandas excepto con
    <span class="emphasis"><em>Column Header, Detail1 y Summary</em></span>.</p>

    <div class="figure"><a name="d4e3540"></a><div class="figure-contents">
      

      <div class="mediaobject" align="center"><img src="images/recetas-subreport-ireport-6.png" align="middle" alt="iReport - Bandas subreport"></div>
    </div><p class="title"><b>Figura 25.6. iReport - Bandas subreport</b></p></div><br class="figure-break">

    <p><span class="emphasis"><em>Column Header</em></span> es una banda que se dibujar&aacute;
    solo al inicio de la columna del informe (en este caso solo existir&aacute;
    una). A&ntilde;adir textos est&aacute;ticos que har&aacute;n las veces de cabecera de
    tabla. Para ello, de la paleta de componentes, seleccionar
    <span class="emphasis"><em>Static Text</em></span> y arrastrarlo hasta la banda
    <span class="emphasis"><em>Column Header</em></span>.</p>

    <div class="figure"><a name="d4e3549"></a><div class="figure-contents">
      

      <div class="mediaobject" align="center"><img src="images/recetas-subreport-ireport-5.png" align="middle" alt="iReport - Paleta"></div>
    </div><p class="title"><b>Figura 25.7. iReport - Paleta</b></p></div><br class="figure-break">

    <p>En el primer <span class="emphasis"><em>Static Text</em></span> establecer el
    valor <span class="emphasis"><em>Nombre</em></span> y repetir la misma operaci&oacute;n para definir un
    texto para el campo <span class="emphasis"><em>Peso</em></span> y para el campo
    <span class="emphasis"><em>Tipo</em></span>. Es posible distribuir las etiquetas para que quede
    tal y como se muestra en la captura anterior.</p>

    <p>A continuaci&oacute;n, hacer lo mismo pero usando el elemento
    <span class="emphasis"><em>Text Field</em></span>. Este elemento sirve para mostrar el valor
    de un campo de la entidad <span class="emphasis"><em>Pet</em></span> y se ha de corresponder
    con los field definidos anteriormente (<span class="emphasis"><em>name, weight,
    type</em></span>). Estos elementos <span class="emphasis"><em>Text Field</em></span> se
    definir&aacute;n en la banda <span class="emphasis"><em>Detail1</em></span>, puesto que se
    repetir&aacute;n para cada uno de los elementos de la fuente de datos del
    subreport. Recordar que la fuente de datos de este subreport se hab&iacute;a
    definido anteriormente como <span class="emphasis"><em>JRBeanCollectionDataSource</em></span> 
    usando la colecci&oacute;n de <span class="emphasis"><em>Pets</em></span> que pertenecen a un
    <span class="emphasis"><em>Owner</em></span>.</p>

    <p>En los Text Field, es importante establecer correctamente la
    propiedad Expression Class, esta se ha de corresponder con el tipo Java
    del field definido y que se va a usar para mostrarlo. Por ejemplo, el Text
    Field que mostar&aacute; el peso de la mascota tendr&iacute;a las propiedades como
    sigue:</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p>Text Field Expression = $F{weight}</p>
      </li><li>
        <p>Expression Class = java.lang.Float</p>
      </li></ul></div>

    <p>Para establecer el Text Field Expression se puede utilizar el di&aacute;logo
    que se muestra a continuaci&oacute;n Este di&aacute;logo permite seleccionar elementos de 
    los campos definidos en el informe, de los par&aacute;metros e incluso acceder a
    alguna de las operaciones que proporcionan estos objetos.</p>

    <div class="figure"><a name="d4e3575"></a><div class="figure-contents">
      

      <div class="mediaobject" align="center"><img src="images/recetas-subreport-ireport-7.png" align="middle" alt="iReport - Di&aacute;logo Text Field Expression"></div>
    </div><p class="title"><b>Figura 25.8. iReport - Di&aacute;logo Text Field Expression</b></p></div><br class="figure-break">

    <p>Obviamente, en un <span class="emphasis"><em>Text Field</em></span> es posible
    establecer expresiones m&aacute;s elaboradas, como a&ntilde;adir a la cadena las unidades de
    peso. Se debe tener en cuenta que la propiedad <span class="emphasis"><em>Expression
    Class</em></span> deber&aacute; establecerse al tipo Java resultante de la
    expresi&oacute;n (por ejemplo, $F{weight} + "kg" da como resultado un
    java.lang.String). Establecer en el <span class="emphasis"><em>Text
    Field</em></span> asociado con el tipo de mascota la expresi&oacute;n
    <span class="emphasis"><em>$F{type}.toString()</em></span> y la clase
    <span class="emphasis"><em>java.lang.String</em></span>.</p>

    <p>Ya est&aacute; dise&ntilde;ada la banda de detalle y para terminar el
    subreport, opcionalmente, se puede definir un <span class="emphasis"><em>Text
    Field</em></span> que indique cuantos registros de
    <span class="emphasis"><em>Pet</em></span> se han impreso cada vez que se ejecuta el
    subreport. Esto ya se encuentra incluido en el informe padre (owners)
    y se consigue utilizando la variable del report
    <span class="emphasis"><em>REPORT_COUNT</em></span>, ya difinida por defecto.
    Incluirla en la banda <span class="emphasis"><em>Summary</em></span> con un
    <span class="emphasis"><em>Text Field</em></span> en la que el <span class="emphasis"><em>Expression</em></span>
    tome el valor <span class="emphasis"><em>$V{REPORT_COUNT}</em></span> y el <span class="emphasis"><em>Class</em></span>
    sea <span class="emphasis"><em>java.lang.Integer</em></span>.</p>

    <p>Solo queda arrancar de nuevo la aplicaci&oacute;n, desde el
    Tomcat de Eclipse o desde la l&iacute;nea de comandos y probar la generaci&oacute;n
    del informe de Owners.</p>

    <div class="figure"><a name="d4e3597"></a><div class="figure-contents">
      

      <div class="mediaobject" align="center"><img src="images/recetas-subreport-ireport-8.png" align="middle" alt="Informe Owners con subreport Pets"></div>
    </div><p class="title"><b>Figura 25.9. Informe Owners con subreport Pets</b></p></div><br class="figure-break">

    <p>JasperReports permite gran cantidad de opciones al trabajar con subreports
    (paso de par&aacute;metros desde el informe padre a los subinformes, devoluci&oacute;n
    de par&aacute;metros desde los subinformes al informe padre, actualizaci&oacute;n de
    variables, ...). Para conocerlas con profundidad consultar la
    documentaci&oacute;n de referencia de Jasper Reports e iReport.</p>
  </div>
</div>
  </div>

  <div class="part" lang="es"><div class="titlepage"><div><div><h1 class="title"><a name="apendices"></a>Parte&nbsp;V.&nbsp;Ap&eacute;ndices</h1></div></div></div>
    

    <div class="partintro" lang="es"><div></div>
      <p>Listado de comandos adicionales incluidos
      en gvNIX detallando cada uno de sus par&aacute;metros.</p>
    </div>

    <div class="chapter" lang="es"><div class="titlepage"><div><div><h2 class="title"><a name="apendice-comandos"></a>Cap&iacute;tulo 26. Ap&eacute;ndice de comandos de gvNIX</h2></div></div></div>
  

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="apendice-comandos_addon-persistence"></a>26.1.&nbsp;Comandos del add-on OCC</h2></div></div></div>

  

  <p>Para una descripci&oacute;n detallada de las caracter&iacute;sticas
  del add-on consultar la documentaci&oacute;n del <a class="link" href="#addon-persistence" title="Cap&iacute;tulo 17. Add-on OCC (Optimistic Concurrency Control)">
  add-on OCC (Optimistic Concurrency Control)</a>.</p>

  <div class="table"><a name="d4e3613"></a><p class="title"><b>Table&nbsp;26.1.&nbsp;Comandos del add-on OCC</b></p><div class="table-contents">
    

    <table summary="Comandos del add-on OCC" border="1"><colgroup><col><col></colgroup><thead><tr><th align="center">Comando</th><th align="center">Descripci&oacute;n</th></tr></thead><tbody><tr><td><a class="link" href="#apendice-comandos_addon-persistence_occchecksum_occ-checksum-set" title="26.1.1.&nbsp;occ checksum set">occ
          checksum set</a></td><td>Establece un control de concurrencia optimista mediante
          una suma de comprobaci&oacute;n (checksum) para una determinada entidad
          del proyecto</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-persistence_occchecksum_occ-checksum-all" title="26.1.2.&nbsp;occ checksum all">occ
          checksum all</a></td><td>Establece un control de concurrencia optimista mediante
          una suma de comprobaci&oacute;n (checksum) para todas las entidades del
          proyecto</td></tr></tbody></table>
  </div></div><br class="table-break">

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-persistence_occchecksum_occ-checksum-set"></a>26.1.1.&nbsp;occ checksum set</h3></div></div></div>
    

    <p>Establece un control de concurrencia optimista
    mediante una suma de comprobaci&oacute;n (checksum) en una entidad
    del modelo. Si la entidad ya tiene configurado este sistema de control,
    el comando no permitir&aacute; sobreescribir su configuraci&oacute;n y
    cualquier modificaci&oacute;n deber&aacute; realizarse sobre la anotaci&oacute;n relacionada
    <span class="emphasis"><em>@GvNIXEntityOCCChecksum</em></span>
    que se habr&aacute; incluido en la clase Java de la entidad.</p>

    <p>Sus par&aacute;metros son:</p><div class="variablelist"><dl><dt><span class="term">--entity</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido si no est&aacute; en el
            contexto] [Clase Java] [Autocompletado]</em></span></p>

            <p>Entidad sobre la que establecer el sistema de control
            de concurrencia optimista mediante una suma de comprobaci&oacute;n (checksum).</p>
          </dd><dt><span class="term">--fieldName</span></dt><dd>
            <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

            <p>Nombre del campo de la entidad en donde almacenar
            la suma de comprobaci&oacute;n (checksum). Habitualmente este par&aacute;metro no necesita
            ser establecido. Si no se especifica, tomar&aacute; por convenci&oacute;n el nombre
            <span class="emphasis"><em>occChekcsum</em></span> para dicha propiedad.
            </p>
          </dd><dt><span class="term">--digestMethod</span></dt><dd>
            <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

            <p>M&eacute;todo a utilizar en el c&aacute;lculo de la suma de comprobaci&oacute;n (checksum).
            Habitualmente este par&aacute;metro no necesita ser establecido.
            Los posibles valores vienen definidos por los algoritmos aceptados por 
            <a class="ulink" href="http://docs.oracle.com/javase/1.5.0/docs/api/java/security/MessageDigest.html" target="_top">
            MessageDigest.getInstance(String algorithm)</a>. Por defecto, se utilizar&aacute;
            el algoritmo <span class="emphasis"><em>md5</em></span>, pero pueden utilizarse otros como por
            ejemplo <span class="emphasis"><em>sha</em></span>.</p>
          </dd></dl></div>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-persistence_occchecksum_occ-checksum-all"></a>26.1.2.&nbsp;occ checksum all</h3></div></div></div>
    

    <p>Estable un control de concurrencia optimista
    mediante una suma de comprobaci&oacute;n (checksum) en todas las
    entidades de la aplicaci&oacute;n que no la tuviesen todav&iacute;a establecida.
    Cualquier modificaci&oacute;n una vez establecido el control
    deber&aacute; realizarse sobre la anotaci&oacute;n relacionada
    <span class="emphasis"><em>@GvNIXEntityOCCChecksum</em></span>
    que se habr&aacute; incluido en todas las clases Java de entidad.</p>

    <p>Sus par&aacute;metros son:</p><div class="variablelist"><dl><dt><span class="term">--fieldName</span></dt><dd>
            <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

            <p>Nombre del campo en cada entidad en donde almacenar
            la suma de comprobaci&oacute;n (checksum). Habitualmente este par&aacute;metro no necesita
            ser establecido. Si no se especifica, tomar&aacute; por convenci&oacute;n el nombre
            <span class="emphasis"><em>occChekcsum</em></span> para dicha propiedad.</p>
          </dd><dt><span class="term">--digestMethod</span></dt><dd>
            <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

            <p>M&eacute;todo a utilizar en el c&aacute;lculo de la suma de comprobaci&oacute;n (checksum).
            Habitualmente este par&aacute;metro no necesita ser establecido.
            Los posibles valores vienen definidos por los algoritmos aceptados por 
            <a class="ulink" href="http://docs.oracle.com/javase/1.5.0/docs/api/java/security/MessageDigest.html" target="_top">
            MessageDigest.getInstance(String algorithm)</a>. Por defecto, se utilizar&aacute;
            el algoritmo <span class="emphasis"><em>md5</em></span>, pero pueden utilizarse otros como por
            ejemplo <span class="emphasis"><em>sha</em></span>.</p>
          </dd></dl></div>
  </div>

</div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="apendice-comandos_addon-theme-manager"></a>26.2.&nbsp;Comandos del add-on Theme Manager</h2></div></div></div>

  

  <p>Para una descripci&oacute;n detallada de las
  caracter&iacute;sticas del add-on consultar la documentaci&oacute;n del <a class="link" href="#addon-theme-manager" title="Cap&iacute;tulo 14. Add-on Theme Manager">Add-on Theme Manager</a>.</p>

  <div class="table"><a name="d4e3685"></a><p class="title"><b>Table&nbsp;26.2.&nbsp;Comandos del add-on Theme Manager</b></p><div class="table-contents">
    

    <table summary="Comandos del add-on Theme Manager" border="1"><colgroup><col><col></colgroup><thead><tr><th align="center">Comando</th><th align="center">Descripci&oacute;n</th></tr></thead><tbody><tr><td><a class="link" href="#apendice-comandos_addon-theme-manager_theme-install" title="26.2.1.&nbsp;theme install">theme
          install</a></td><td>Instala un tema en el proyecto de
          forma que ser&aacute; un candidato para establecerlo como tema
          visible</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-theme-manager_theme-set" title="26.2.2.&nbsp;theme set">theme
          set</a></td><td>Establece el tema en la aplicaci&oacute;n de
          forma que ser&aacute; el tema visible a partir de ese momento</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-theme-manager_theme-list" title="26.2.3.&nbsp;theme list">theme
          list</a></td><td>Lista los temas disponible para instalar,
          los temas instalados en el proyecto y el tema actualmente
          establecido que se est&aacute; visualizando en la aplicaci&oacute;n</td></tr></tbody></table>
  </div></div><br class="table-break">

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-theme-manager_theme-install"></a>26.2.1.&nbsp;theme install</h3></div></div></div>
    

    <p>Coje un tema que el framework detecte que est&aacute;
    disponible y lo copia en el directorio <code class="filename">themes</code>
    del proyecto. A partir de ese momento el tema estar&aacute; disponible
    para establecerlo como tema visible mediante el comando
    <a class="link" href="#apendice-comandos_addon-theme-manager_theme-set" title="26.2.2.&nbsp;theme set">
    theme set</a>.</p>

    <p>Sus par&aacute;metros son:</p><div class="variablelist"><dl><dt><span class="term">--id</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Tema] [Autocompletado]</em></span></p>

            <p>Identificador del tema a instalar.</p>
          </dd></dl></div>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-theme-manager_theme-set"></a>26.2.2.&nbsp;theme set</h3></div></div></div>
    

    <p>Coje un tema que se encuentre instalado
    en el proyecto y lo establece como visible en la aplicaci&oacute;n 
    actualizando la informaci&oacute;n del fichero
    <code class="filename">src/main/webapp/WEB-INF/theme.xml</code>.
    Este comando sobreescribe los ficheros que existan en el proyecto
    sin comprobar si ya hab&iacute;a alg&uacute;n tema establecido previamente.</p>

    <p>Sus par&aacute;metros son:</p><div class="variablelist"><dl><dt><span class="term">--id</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Identificador de tema]
            [Autocompletado]</em></span></p>

            <p>Identificador del tema a establecer.</p>
          </dd></dl></div>
      
      <p>Es interesante borrar las cookies del navegador
      antes de recargar la p&aacute;gina para ver el tema activo de forma
      correcta.</p>
      
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-theme-manager_theme-list"></a>26.2.3.&nbsp;theme list</h3></div></div></div>
    

    <p>Lista por consola todos los temas
    <span class="emphasis"><em>disponibles</em></span>, <span class="emphasis"><em>instalados</em></span> y el
    <span class="emphasis"><em>establecido</em></span>. La salida del comando es similar a la
    siguiente:</p>

    <pre class="programlisting">	     ID          Avail  Instal  Active          Description
	---------------  -----  ------  ------  --------------------------------
	gvnix             Yes     Yes     Yes   gvNIX example theme
	cit               Yes     Yes     No    CIT theme for Roo applications
	blue              Yes     No      No    Blue color theme</pre>
  </div>

</div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="apendice-comandos_addon-web-dialog"></a>26.3.&nbsp;Comandos del add-on Web Dialog</h2></div></div></div>
         
  

  <p>Para una descripci&oacute;n detallada de las
  caracter&iacute;sticas del add-on consultar la documentaci&oacute;n del <a class="link" href="#addon-web-dialog" title="Cap&iacute;tulo 18. Add-on Web Dialog">add-on Web Dialog</a>.</p>

  <div class="table"><a name="d4e3744"></a><p class="title"><b>Table&nbsp;26.3.&nbsp;Comandos del add-on Web Dialog</b></p><div class="table-contents">
    

    <table summary="Comandos del add-on Web Dialog" border="1"><colgroup><col><col></colgroup><thead><tr><th align="center">Comando</th><th align="center">Descripci&oacute;n</th></tr></thead><tbody><tr><td><a class="link" href="#">web
          mvc dialog setup</a></td><td>Instala el soporte para di&aacute;logos modales y realiza
          la gesti&oacute;n de ciertas excepciones para que sean visualizadas de forma
          amigable y en m&uacute;ltiples idiomas</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-web-exception-handler_exception-handler-list" title="26.3.2.&nbsp;web mvc dialog exception list">web
          mvc dialog exception list</a></td><td>Muestra por la consola la lista de excepciones
          que est&aacute;n siendo actualmente gestionadas</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-web-exception-handler_exception-handler-add">web
          mvc dialog exception add</a></td><td>Incluye una nueva excepci&oacute;n dentro de la gesti&oacute;n de
          excepciones y permite definir el mensaje amigable asociado a la
          excepci&oacute;n en un determinado idioma</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-web-exception-handler_exception-handler-set-language">web
          mvc dialog exception set language</a></td><td>A&ntilde;ade o actualiza un mensaje amigable asociado a una excepci&oacute;n
          en un determinado idioma para lo que la excepci&oacute;n debe haber sido incluida previamente
          en el sistema de gesti&oacute;n de excepciones con el comando anterior</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-web-exception-handler_exception-handler-remove">web
          mvc dialog exception remove</a></td><td>Quita una excepci&oacute;n de la gesti&oacute;n y por lo tanto no
          se mostrar&aacute; un mensaje amigable y en m&uacute;ltiples idiomas en el caso de producirse
          y no ser controlada desde el proyecto</td></tr><tr><td><a class="link" href="#">web
          mvc dialog add</a></td><td>A&ntilde;ade dos m&eacute;todos en el c&oacute;digo fuente de un controlador
          que permiten abrir un di&aacute;logo modal en una p&aacute;gina de la aplicaci&oacute;n
          sin realizar ninguna implementaci&oacute;n en la capa web</td></tr></tbody></table>
  </div></div><br class="table-break">

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-web-exception-handler_dialog-setup"></a>26.3.1.&nbsp;web mvc dialog setup</h3></div></div></div>
    

    <p>Instala en el proyecto el soporte para di&aacute;logos de error y de usuario en
    ventana modal (pop-up). A partir de ese momento los mensajes de error
    de la aplicaci&oacute;n se mostrar&aacute;n con ese formato. Tambi&eacute;n configura un sistema
    para visualizar de forma amigable y con soporte multi idioma ciertas excepciones
    que se pueden producir en esta clase de aplicaciones.
    Ver <a class="link" href="#addon-web-dialog" title="Cap&iacute;tulo 18. Add-on Web Dialog">Add-on Web Dialog</a> para una informaci&oacute;n
    m&aacute;s detallada.
    </p>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-web-exception-handler_exception-handler-list"></a>26.3.2.&nbsp;web mvc dialog exception list</h3></div></div></div>
    

    <p>Muestra por consola la lista de excepciones que actualmente
    est&aacute;n siendo gestionadas. Es decir, las excepciones que si no son controladas
    desde la aplicaci&oacute;n y se producen, aparecer&aacute;n al usuario en una 
    ventana modal con un mensaje amigable y en multiples idiomas.
	El resultado mostrado por la consola ser&aacute; algo similar a lo siguiente:</p>

    <pre class="programlisting">Handled Exceptions:
.DataAccessException
.NoSuchRequestHandlingMethodException
.TypeMismatchException
.MissingServletRequestParameterException
java.sql.SQLException
java.io.IOException
org.springframework.transaction.TransactionException
java.lang.UnsupportedOperationException
javax.persistence.OptimisticLockException
org.hibernate.NonUniqueObjectException
org.hibernate.exception.ConstraintViolationException
org.hibernate.id.IdentifierGenerationException
</pre>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d4e3786"></a>26.3.3.&nbsp;web
    mvc dialog exception add</h3></div></div></div>
    

    <p>Incluye una nueva excepci&oacute;n a la gesti&oacute;n de excepciones.
	De esta forma, si se produce dicha excepci&oacute;n en la
    aplicaci&oacute;n se visualizar&aacute; de forma amigable mediante un mensaje modal y
    en m&uacute;ltiples idiomas. Este comando permite tambi&eacute;n definir el mensaje amigable
    asociado a la excepci&oacute;n en un determinado idioma. El mensaje amigable se
    compone de t&iacute;tulo y descripci&oacute;n.
    </p>

    <p>Sus par&aacute;metros son:</p><div class="variablelist"><dl><dt><span class="term">--exception</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>

            <p>Nombre de la excepci&oacute;n a incluir en la gesti&oacute;n
            de excepciones. Si se desea que la definici&oacute;n sea &uacute;nica, se ha de
            especificar el paquete java completo del que proviene, por ejemplo
            <span class="emphasis"><em>java.lang.NullPointerException</em></span>, ya que si se
            especifica &uacute;nicamente el nombre, por ejemplo 
            <span class="emphasis"><em>NullPointerException</em></span>, aplicar&iacute;a a todas las
            excepciones con dicho nombre sea cual sea el paquete en el que se
            encuentre.</p>
          </dd><dt><span class="term">--title</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>

            <p>T&iacute;tulo de la ventana modal que se mostrar&aacute; en
            pantalla cuando se produzca la excepci&oacute;n.</p>
          </dd><dt><span class="term">--description</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>

            <p>Texto con el contenido de la ventana modal
            que se mostrar&aacute; en pantalla cuando se produzca la excepci&oacute;n.</p>
          </dd><dt><span class="term">--language</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>

            <p>Idioma del t&iacute;tulo y de la descripci&oacute;n en su formato ISO:
            <span class="emphasis"><em>es, de, it, nl, sv, en, etc</em></span>.</p>
          </dd></dl></div>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d4e3818"></a>26.3.4.&nbsp;web
    mvc dialog exception set language</h3></div></div></div>
    

    <p>A&ntilde;ade o actualiza el mensaje amigable asociado a una excepci&oacute;n 
	en un determinado idioma. La excepci&oacute;n debe haber sido incluida anteriormente 
	en el sistema de gesti&oacute;n de excepciones con el comando 
	<span class="emphasis"><em>web mvc dialog exception add</em></span>. El mensaje amigable se
    compone de t&iacute;tulo y descripci&oacute;n.</p>

    <p>Sus par&aacute;metros son:</p><div class="variablelist"><dl><dt><span class="term">--exception</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>

            <p>Nombre de la excepci&oacute;n ya incluida en la gesti&oacute;n
            de excepciones para la que se desea a&ntilde;adir o modificar sus mensajes
            amigables en un idioma determinado. Se puede obtener el
            nombre exacto de la excepci&oacute;n mediante el comando
            <span class="emphasis"><em>web mvc dialog exception list</em></span>.</p>
          </dd><dt><span class="term">--title</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>

            <p>T&iacute;tulo de la ventana modal que se mostrar&aacute; en
            pantalla cuando se produzca la excepci&oacute;n.</p>
          </dd><dt><span class="term">--description</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>

            <p>Texto con el contenido de la ventana modal
            que se mostrar&aacute; en pantalla cuando se produzca la excepci&oacute;n.</p>
          </dd><dt><span class="term">--language</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>

            <p>Idioma del t&iacute;tulo y de la descripci&oacute;n en su formato ISO:
            <span class="emphasis"><em>es, de, it, nl, sv, en, etc</em></span>.</p>
          </dd></dl></div>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d4e3850"></a>26.3.5.&nbsp;web
    mvc dialog exception remove</h3></div></div></div>
    

    <p>Quita una excepci&oacute;n del sistema de gesti&oacute;n de excepciones y
    por lo tanto no se mostrar&aacute; un mensaje amigable y en m&uacute;ltiples idiomas en el caso
    de producirse cuando no es controlada desde el c&oacute;digo fuente de la aplicaci&oacute;n.</p>

    <p>Sus par&aacute;metros son:</p><div class="variablelist"><dl><dt><span class="term">--exception</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>

            <p>Nombre de la excepci&oacute;n ya incluida en la gesti&oacute;n
            de excepciones que se desea eliminar. Se puede obtener el
            nombre exacto de la excepci&oacute;n mediante el comando
            <span class="emphasis"><em>web mvc dialog exception list</em></span>.</p>
          </dd></dl></div>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d4e3862"></a>26.3.6.&nbsp;web mvc
    dialog add</h3></div></div></div>
    

    <p>A&ntilde;ade dos m&eacute;todos en el c&oacute;digo fuente de un controlador
	que permiten abrir un di&aacute;logo modal en una p&aacute;gina de la aplicaci&oacute;n
	sin realizar ninguna implementaci&oacute;n en la capa web. Ver la secci&oacute;n
	de inclusi&oacute;n de
	<a class="link" href="#addon-web-exception-handler_nuevos-dialogos" title="18.4. Nuevos di&aacute;logos modales">
    nuevos di&aacute;logos modales</a> para una informaci&oacute;n m&aacute;s detallada.</p>

    <p>Sus par&aacute;metros son:</p><div class="variablelist"><dl><dt><span class="term">--class</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Clase Java] [Autocompletado]</em></span></p>

            <p>Controlador para el cual generar
            los m&eacute;todos de creaci&oacute;n de un di&aacute;logo modal.</p>
          </dd><dt><span class="term">--name</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>

            <p>Nombre que se dar&aacute; a uno de los m&eacute;todos en el
            controlador. Este m&eacute;todo y el m&eacute;todo por defecto con nombre
            <span class="emphasis"><em>modalDialog</em></span> permitir&aacute;n mostrar un di&aacute;logo
            modal cada uno con distintas caracter&iacute;sticas.</p>
          </dd></dl></div>
  </div>
</div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="apendice-comandos_addon-web-menu"></a>26.4.&nbsp;Comandos del add-on Web Menu</h2></div></div></div>
         
  

  <p>Para una descripci&oacute;n detallada de las
  caracter&iacute;sticas del add-on consultar la documentaci&oacute;n del
  <a class="link" href="#addon-web-menu" title="Cap&iacute;tulo 15. Add-on Web Menu">add-on Web Menu</a>.</p>

  <div class="table"><a name="d4e3885"></a><p class="title"><b>Table&nbsp;26.4.&nbsp;Comandos del add-on Web Menu</b></p><div class="table-contents">
    

    <table summary="Comandos del add-on Web Menu" border="1"><colgroup><col><col></colgroup><thead><tr><th align="center">Comando</th><th align="center">Descripci&oacute;n</th></tr></thead><tbody><tr><td><a class="link" href="#apendice-comandos_addon-web-menu_page-menu-setup" title="26.4.1.&nbsp;menu setup">menu
          setup</a></td><td>Instala el sistema de gesti&oacute;n del men&uacute; web que permite
          organizar de forma sencilla su estructura de p&aacute;ginas y permisos</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-web-menu_page-add" title="26.4.2.&nbsp;menu entry add">menu entry
          add</a></td><td>A&ntilde;ade un elemento al men&uacute;, sea una p&aacute;gina o un grupo</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-web-menu_page-hide" title="26.4.3.&nbsp;menu entry visibility">menu entry
          visibility</a></td><td>Define un elemento del men&uacute; como visible o oculto</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-web-menu_page-show" title="26.4.4.&nbsp;menu entry roles">menu entry
          roles</a></td><td>Establece una lista de perfiles de usuario
          para los que se mostrar&aacute; una entrada del men&uacute;</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-web-menu_page-move" title="26.4.5.&nbsp;menu entry move">menu entry
          move</a></td><td>Mueve un elemento del men&uacute; y todos los hijos
          que pueda tener</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-web-menu_page-update" title="26.4.6.&nbsp;menu entry update">menu entry
          update</a></td><td>Actualiza un elemento del men&uacute;</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-web-menu_page-info" title="26.4.7.&nbsp;menu entry info">menu entry
          info</a></td><td>Muestra por consola los valores establecidos
          en un elemento del men&uacute; y en todos los hijos que pueda tener</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-web-menu_page-list" title="26.4.8.&nbsp;menu tree">menu
          tree</a></td><td>Muestra por consola un &aacute;rbol con un resumen de los
          elementos del men&uacute;.</td></tr></tbody></table>
  </div></div><br class="table-break">

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-web-menu_page-menu-setup"></a>26.4.1.&nbsp;menu setup</h3></div></div></div>
    

    <p>Instala y activa en la aplicaci&oacute;n el sistema de
    gesti&oacute;n del men&uacute; web para la organizaci&oacute;n de su estructura de
    p&aacute;ginas y la definici&oacute;n de permisos. A partir de este momento se
    podr&aacute;n utilizar todos los comandos de gesti&oacute;n
    del men&uacute; para modificar su modelo de datos y definir
    permisos de visualizaci&oacute;n sobre las distintas opciones del men&uacute; en funci&oacute;n
    del perfil de cada usuario. El modelo de datos se encuentra definido en
    el fichero <code class="filename">src/main/webapp/WEB-INF/views/menu.xml</code>.
    </p>
    
    <p>Para una descripci&oacute;n detallada de las tareas que
    realiza este comando consultar la documentaci&oacute;n de
    <a class="link" href="#addon-web-menu_instalacion" title="15.3. Instalaci&oacute;n de la gesti&oacute;n del men&uacute;">
    instalaci&oacute;n de la gesti&oacute;n del men&uacute;</a>.</p>

  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-web-menu_page-add"></a>26.4.2.&nbsp;menu entry add</h3></div></div></div>
    

    <p>A&ntilde;ade un elemento al men&uacute;, sea una p&aacute;gina o un grupo.  
    La diferencia entre ambos es que una p&aacute;gina tiene asociada una URL y un
    grupo no. Este comando crea un elemento del men&uacute;, pero no crea una
    nueva vista en el proyecto. La creaci&oacute;n de una vista puede realizarse
    con el comando <a class="ulink" href="http://static.springsource.org/spring-roo/reference/html-single/index.html#command-index-web-mvc-view" target="_top">
    web mvc view</a>.</p>
    
    <p>Sus par&aacute;metros son:</p><div class="variablelist"><dl><dt><span class="term">--category</span></dt><dd>
            <p><span class="emphasis"><em>[Opcional] [Elemento del men&uacute;] [Autocompletado]</em></span></p>

            <p>Identificador del elemento del men&uacute; donde incluir la nueva
            entrada. El elemento del men&uacute; puede ser una p&aacute;gina o un grupo.
            Si no se especifica este par&aacute;metro la nueva entrada se
            incluir&aacute; en el grupo <span class="emphasis"><em>Page</em></span> que si no existe
            ser&aacute; creado al final del men&uacute;.</p>
          </dd><dt><span class="term">--url</span></dt><dd>
            <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

            <p>URL con la que enlazar&aacute; el elemento del men&uacute;.</p>
          </dd><dt><span class="term">--label</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>

            <p>T&iacute;tulo para el elemento del men&uacute;. Se crear&aacute; una etiqueta
            con este t&iacute;tulo en el fichero
            <code class="filename">src/main/webapp/WEB-INF/i18n/application.properties
            </code>. Este t&iacute;tulo ser&aacute; ignorado si se define el
            par&aacute;metro <span class="emphasis"><em>messageCode</em></span>.</p>
          </dd><dt><span class="term">--messageCode</span></dt><dd>
            <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

            <p>Etiqueta que representar&aacute; la traducci&oacute;n en m&uacute;ltiples
            idiomas del t&iacute;tulo del elemento del men&uacute;. Si todav&iacute;a no existe, se
            deber&aacute; crear dicha etiqueta en cada fichero de idioma
            que exista configurado en el proyecto en 
            <code class="filename">src/main/webapp/WEB-INF/i18n/messages_xx.properties
            </code>.</p>
          </dd><dt><span class="term">--roles</span></dt><dd>
            <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

            <p>Lista de perfiles con permiso para ver el elemento del men&uacute;.
            Los distintos elementos de la lista de perfiles deben estar separados por comas.
            Si no se establece este par&aacute;metro, el elemento del men&uacute; 
            aparecer&aacute; para todos los perfiles.</p>
          </dd></dl></div>
      
      <p>Al finalizar la ejecuci&oacute;n de este comando se informar&aacute; del
      identificador del nuevo elemento del men&uacute; a&ntilde;adido con un texto similar
      al siguiente.</p>
      
      <pre class="programlisting">New page 'i_page_xxxx_xxxx' added.</pre>
      
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-web-menu_page-hide"></a>26.4.3.&nbsp;menu entry visibility</h3></div></div></div>
    

    <p>Cambia la visibilidad de un elemento del men&uacute;, es decir,
    permite definirlo como visible o oculto.</p>

    <p>Sus par&aacute;metros son:</p><div class="variablelist"><dl><dt><span class="term">--id</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Elemento del men&uacute;] [Autocompletado]</em></span></p>

            <p>Identificador del elemento del men&uacute;, sea p&aacute;gina o grupo.</p>
          </dd><dt><span class="term">--hidden</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Booleano] [Autocompletado]</em></span></p>

            <p>Indica si este elemento del men&uacute; debe ocultarse.
            Si se especifica este par&aacute;metro sin ning&uacute;n valor, tomar&aacute; el
            valor <span class="emphasis"><em>true</em></span> y ocultar&aacute; el elemento del men&uacute;.
            Si no se especifica este par&aacute;metro, tomar&aacute; el valor
            <span class="emphasis"><em>false</em></span> y mostrar&aacute; el elemento del men&uacute;.</p>
          </dd></dl></div>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-web-menu_page-show"></a>26.4.4.&nbsp;menu entry roles</h3></div></div></div>
    

    <p>Establece una lista de perfiles de usuario
    para los que se mostrar&aacute; una entrada del men&uacute;. No se mostrar&aacute;
    a los usuarios que no tengan alg&uacute;n perfil de la lista.</p>

    <p>Sus par&aacute;metros son:</p><div class="variablelist"><dl><dt><span class="term">--id</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Elemento del men&uacute;] [Autocompletado]</em></span></p>

            <p>Identificador del elemento del men&uacute;, sea p&aacute;gina o grupo.</p>
          </dd><dt><span class="term">--roles</span></dt><dd>
            <p>[Requerido] [Cadena]</p>

            <p>Lista de perfiles con permiso para ver el elemento del men&uacute;.
            Los distintos elementos de la lista de perfiles deben estar separados por comas.
            </p>
          </dd></dl></div>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-web-menu_page-move"></a>26.4.5.&nbsp;menu entry move</h3></div></div></div>
    

    <p>Mueve un elemento del men&uacute; y todos los hijos
    que pueda tener. Se puede cambiar su posici&oacute;n en el orden de elementos
    del men&uacute; o se puede mover dentro de otro elemento del men&uacute;.</p>

    <p>Sus par&aacute;metros son:</p><div class="variablelist"><dl><dt><span class="term">--id</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Elemento del men&uacute;] [Autocompletado]</em></span></p>

            <p>Identificador del elemento del men&uacute;, sea p&aacute;gina o grupo.</p>
          </dd><dt><span class="term">--into</span></dt><dd>
            <p><span class="emphasis"><em>[Opcional] [Elemento del men&uacute;] [Autocompletado]</em></span></p>

            <p>Identificador de un elemento del men&uacute; donde a&ntilde;adir
            como hijo el elemento del men&uacute;. El elemento se insertar&aacute; en la &uacute;ltima
            posici&oacute;n de la lista de hijos. Este par&aacute;metro no se puede especificar
            simultaneamente junto al par&aacute;metro <span class="emphasis"><em>before</em></span>.</p>
          </dd><dt><span class="term">--before</span></dt><dd>
            <p><span class="emphasis"><em>[Opcional] [Elemento del men&uacute;] [Autocompletado]</em></span></p>

            <p>Identificador de un elemento del men&uacute; antes del cual
            insertar el elemento del men&uacute;. Este par&aacute;metro no se puede especificar
            simultaneamente junto al par&aacute;metro <span class="emphasis"><em>into</em></span>.</p>
          </dd></dl></div>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-web-menu_page-update"></a>26.4.6.&nbsp;menu entry update</h3></div></div></div>
    

    <p>Actualiza un elemento del men&uacute;, sea una p&aacute;gina o un grupo. 
    Los valores no especificados en el comando se mantendr&aacute;n con su valor original.</p>

    <p>Sus par&aacute;metros son:</p><div class="variablelist"><dl><dt><span class="term">--id</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Elemento del men&uacute;] [Autocompletado]</em></span></p>

            <p>Identificador del elemento del men&uacute;, sea p&aacute;gina o grupo.</p>
          </dd><dt><span class="term">--nid</span></dt><dd>
            <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

            <p>Nuevo identificador para el elemento del men&uacute;.
            Por convenci&oacute;n, se utiliza el prefijo <span class="emphasis"><em>c_</em></span> para
            los grupos e <span class="emphasis"><em>i_</em></span> para las p&aacute;ginas.</p>
          </dd><dt><span class="term">--label</span></dt><dd>
            <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

            <p>T&iacute;tulo para el elemento del men&uacute;. Se actualizar&aacute;
            con el nuevo t&iacute;tulo la etiqueta correspondiente en el fichero
            <code class="filename">src/main/webapp/WEB-INF/i18n/application.properties
            </code>. Este t&iacute;tulo ser&aacute; ignorado si se define o ya estaba
            definido el par&aacute;metro <span class="emphasis"><em>messageCode</em></span>.</p>
          </dd><dt><span class="term">--messageCode</span></dt><dd>
            <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

            <p>Etiqueta que representar&aacute; la traducci&oacute;n en m&uacute;ltiples
            idiomas del t&iacute;tulo del elemento del men&uacute;. Si todav&iacute;a no existe, se
            deber&aacute; crear dicha etiqueta en cada fichero de idioma
            que exista configurado en el proyecto en 
            <code class="filename">src/main/webapp/WEB-INF/i18n/messages_xx.properties
            </code>.</p>
          </dd><dt><span class="term">--url</span></dt><dd>
            <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

            <p>URL con la que enlazar&aacute; el elemento del men&uacute;.</p>
          </dd><dt><span class="term">--roles</span></dt><dd>
            <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

            <p>Lista de perfiles con permiso para ver el elemento del men&uacute;.
            Los distintos elementos de la lista de perfiles deben estar separados por comas.</p>
          </dd><dt><span class="term">--hidden</span></dt><dd>
            <p>[Requerido] [Booleano] [Autocompletado]</p>

            <p>Indica si este elemento del men&uacute; debe ocultarse.
            Si se especifica este par&aacute;metro sin ning&uacute;n valor, tomar&aacute; el
            valor <span class="emphasis"><em>true</em></span> y ocultar&aacute; el elemento del men&uacute;.
            Si no se especifica este par&aacute;metro, tomar&aacute; el valor
            <span class="emphasis"><em>false</em></span> y mostrar&aacute; el elemento del men&uacute;.</p>
          </dd></dl></div>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-web-menu_page-info"></a>26.4.7.&nbsp;menu entry info</h3></div></div></div>
    

    <p>Muestra por consola los valores establecidos 
    en un elemento del men&uacute; y en todos los hijos que pueda tener,
    formateados de forma amigable para su f&aacute;cil lectura.</p>

    <p>Sus par&aacute;metros son:</p><div class="variablelist"><dl><dt><span class="term">--id</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Elemento del men&uacute;] [Autocompletado]</em></span></p>

            <p>Identificador del elemento del men&uacute;, sea p&aacute;gina o grupo.</p>
          </dd><dt><span class="term">--lang</span></dt><dd>
            <p>[Opcional] [Idioma]</p>

            <p>Idioma en el que mostrar los valores de las
            distintas etiquetas definidas para cada elemento del men&uacute;.</p>
          </dd></dl></div>

    <p>El comando mostrar&aacute; un resultado similar al siguiente:
	</p><pre class="programlisting"><span class="command"><strong>roo-gvNIX&gt; menu entry info --id c_person</strong></span>
[c_person]
URL          : No
Label Code   : menu_category_person_label
Label        : Person
Message Code : 
Message      : 
Roles        : 
Hidden       : false
Children     : 
               [i_person_new]
               URL          : /people?form
               Label Code   : menu_item_person_new_label
               Label        : Person
               Message Code : global_menu_new
               Message      : Create new {0}
               Roles        : 
               Hidden       : false

               [i_person_list]
               URL          : /people?page=1&amp;size=${empty param.size ? 10 : param.size}
               Label Code   : menu_item_person_list_label
               Label        : People
               Message Code : global_menu_list
               Message      : List all {0}
               Roles        : 
               Hidden       : false</pre><p>
	</p>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-web-menu_page-list"></a>26.4.8.&nbsp;menu tree</h3></div></div></div>
    

    <p>Muestra por consola un &aacute;rbol con un resumen de los
    elementos del men&uacute;, opcionalmente a partir de un determinado elemento del
    men&uacute;.</p>

    <p>Sus par&aacute;metros son:</p><div class="variablelist"><dl><dt><span class="term">--id</span></dt><dd>
            <p><span class="emphasis"><em>[Opcional] [Elemento del men&uacute;] [Autocompletado]</em></span></p>

            <p>Identificador del elemento del men&uacute;, sea p&aacute;gina o grupo,
            a partir del cual comenzar a mostrar el &aacute;rbol resumen.
            Si no se especifica, se muestran todas las p&aacute;gina del men&uacute;.</p>
          </dd></dl></div>

    <p>El comando mostrar&aacute; un resultado similar al siguiente:
</p><pre class="programlisting">roo-gvNIX&gt; <span class="command"><strong>menu tree</strong></span>
[c_pet, visible, no-URL]
          /pets?form  [i_pet_new, visible]
          /pets?page=1&amp;size=${empty param.size ? 10 : param.size}  [i_pet_list, visible]
          /pets?find=ByNameAndWeight&amp;form  [fi_pet_nameandweight, visible]
          /pets?find=ByOwner&amp;form  [fi_pet_owner, visible]
          /pets?find=BySendRemindersAndWeightLessThan&amp;form
          		[fi_pet_sendremindersandweightlessthan, visible]
          /pets?find=ByTypeAndNameLike&amp;form  [fi_pet_typeandnamelike, visible]

[c_owner, visible, no-URL]
          /owners?form  [i_owner_new, visible]
          /owners?page=1&amp;size=${empty param.size ? 10 : param.size}
          		[i_owner_list, visible]

[c_visit, visible, no-URL]
          /visits?form  [i_visit_new, visible]
          /visits?page=1&amp;size=${empty param.size ? 10 : param.size}
          		[i_visit_list, visible]
          /visits?find=ByDescriptionAndVisitDate&amp;form
          		[fi_visit_descriptionandvisitdate, visible]
          /visits?find=ByDescriptionLike&amp;form  [fi_visit_descriptionlike, visible]
          /visits?find=ByVisitDateBetween&amp;form  [fi_visit_visitdatebetween, visible]

[c_vet, visible, no-URL]
          /vets?form  [i_vet_new, visible]
          /vets?page=1&amp;size=${empty param.size ? 10 : param.size}  [i_vet_list, visible]

[c_seleniumtests, visible, no-URL]
          /resources/selenium/test-suite.xhtml  [si_seleniumtests_test, visible]
</pre>
  </div>
</div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="apendice-comandos_web-relation-styles"></a>26.5.&nbsp;Comandos del add-on Web Screen Patterns</h2></div></div></div>
         
  

  <p>Para una descripci&oacute;n detallada de las
  caracter&iacute;sticas del add-on consultar la documentaci&oacute;n del
  <a class="link" href="#addon-web-screen-patterns" title="Cap&iacute;tulo 16. Add-on Web Screen Patterns">add-on Web Screen
  Patterns</a>.</p>

  <div class="table"><a name="d4e4125"></a><p class="title"><b>Table&nbsp;26.5.&nbsp;Comandos del add-on Web Screen Patterns</b></p><div class="table-contents">
    

    <table summary="Comandos del add-on Web Screen Patterns" border="1"><colgroup><col><col></colgroup><thead><tr><th align="center">Comando</th><th align="center">Descripci&oacute;n</th></tr></thead><tbody><tr><td><a class="link" href="#apendice-comandos_addon-web_mvc_relation_pattern" title="26.5.3.&nbsp;web mvc pattern detail">web
          mvc pattern install</a></td><td>Crea o actualiza en el proyecto los ficheros que
          utilizar&aacute;n los patrones de visualizaci&oacute;n</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-web_mvc_pattern" title="26.5.2.&nbsp;web mvc pattern master">web mvc
          pattern master</a></td><td>Crea un patr&oacute;n de visualizaci&oacute;n maestro en el
          controlador que gestiona una entidad del proyecto</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-web_mvc_relation_pattern" title="26.5.3.&nbsp;web mvc pattern detail">web
          mvc pattern detail</a></td><td>Crea un patr&oacute;n de visualizaci&oacute;n detalle en el
          controlador que gestiona una entidad del proyecto dada una de las
          relaciones de la entidad</td></tr></tbody></table>
  </div></div><br class="table-break">

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-web_mvc_pattern_install"></a>26.5.1.&nbsp;web mvc pattern install</h3></div></div></div>
    

    <p>Crea o actualiza en el proyecto los ficheros que
    utilizar&aacute;n los patrones de visualizaci&oacute;n. El comando no tiene ning&uacute;n
    par&aacute;metro obligatorio ni opcional.</p>
    
    <p>Para una descripci&oacute;n detallada de los ficheros
    que instala este comando en el proyecto consultar la secci&oacute;n de
    <a class="link" href="#addon-web-screen-patterns" title="Cap&iacute;tulo 16. Add-on Web Screen Patterns">instalaci&oacute;n</a>
    del add-on Web Screen Patterns.</p>
    
  </div>
  
  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-web_mvc_pattern"></a>26.5.2.&nbsp;web mvc pattern master</h3></div></div></div>
    

    <p>Crea un patr&oacute;n de visualizaci&oacute;n maestro en el
    controlador que gestiona una entidad del proyecto. El patr&oacute;n maestro
    mostrar&aacute; los registros de la entidad gestionada por este controlador.</p>

    <p>Sus par&aacute;metros son:</p><div class="variablelist"><dl><dt><span class="term">--class</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Clase Java] [Autocompletado]</em></span></p>

            <p>Controlador en el cual generar el patr&oacute;n de visualizaci&oacute;n
            maestro.</p>
          </dd><dt><span class="term">--name</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>

            <p>Nombre que identificar&aacute; de forma &uacute;nica al patr&oacute;n.
            No permite espacios. El nombre elegido s&oacute;lo se podr&aacute; utilizar una vez
            en todo el proyecto para evitar colisiones con otros patrones.</p>
          </dd><dt><span class="term">--type</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Tipo de patr&oacute;n] [Autocompletado]</em></span></p>

            <p>Tipo de patr&oacute;n de visualizaci&oacute;n a aplicar.</p>
          </dd><dt><span class="term">--testAutomatically</span></dt><dd>
            <p><span class="emphasis"><em>[Opcional] [Booleano] [Autocompletado]</em></span></p>

            <p>Crear los tests funcionales de Selenium
            para este patr&oacute;n. Por defecto los tests no se generan.</p>
          </dd><dt><span class="term">--testName</span></dt><dd>
            <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

            <p>Nombre con el que crear el test funcional de
            Selenium. Por defecto, si no se especifica, el test tomar&aacute; el
            mismo nombre que el proporcionado para el patr&oacute;n.</p>
          </dd><dt><span class="term">--testServerUrl</span></dt><dd>
            <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

            <p>Direcci&oacute;n donde responde la aplicaci&oacute;n donde se
            ejecutan los tests; incluyendo protocolo, servidor, puerto y ruta
            a la aplicaci&oacute;n. Por defecto, toma el valor 
            <span class="emphasis"><em>http://localhost:8080/</em></span>.</p>
          </dd></dl></div>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-web_mvc_relation_pattern"></a>26.5.3.&nbsp;web mvc pattern detail</h3></div></div></div>
    

    <p>Crea un patr&oacute;n de visualizaci&oacute;n detalle en el
    controlador que gestiona una entidad del proyecto dada una de las
    relaciones de la entidad. El patr&oacute;n detalle mostrar&aacute; los registros
    de la entidad relacionada que est&eacute;n asociados con los registros
    de la entidad maestra. La entidad maestra en la entidad gestionada
    por este controlador.</p>
    
    <p>Para aplicar un patr&oacute;n detalle sobre un
    controlador, es necesario definir previamente un patr&oacute;n
    maestro sobre el mismo controlador.</p>

    <p>Sus par&aacute;metros son:
      </p><div class="variablelist"><dl><dt><span class="term">--class</span></dt><dd>
          
            <p><span class="emphasis"><em>[Requerido] [Clase Java] [Autocompletado]</em></span></p>

            <p>Controlador en el cual generar el patr&oacute;n de visualizaci&oacute;n
            detalle. Es necesario que previamente se haya definido un patr&oacute;n maestro
            sobre este mismo controlador.</p>
          </dd><dt><span class="term">--name</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>

            <p>Nombre de un patr&oacute;n maestro, previamente definido
            en el controlador, sobre el que se desea aplicar el patr&oacute;n detalle.
            El patr&oacute;n maestro se debe haber definido previamente mediante el
            comando <span class="emphasis"><em>web mvc pattern master</em></span>.</p>
            
          </dd><dt><span class="term">--field</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>

            <p>Nombre del campo de la entidad maestra de la que obtener
            los registros a mostrar en el patr&oacute;n detalle. Es decir, el nombre de una
            propiedad de la clase Java de la entidad gestionada por el controlador.
            El campo debe definir una relaci&oacute;n a muchos, es decir, debe estar anotado con 
            <span class="emphasis"><em>@OneToMany</em></span> o <span class="emphasis"><em>@ManyToMany</em></span>.
            </p>
          </dd><dt><span class="term">--type</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Tipo de patr&oacute;n] [Autocompletado]</em></span></p>

            <p>Tipo de patr&oacute;n de visualizaci&oacute;n a aplicar
            en el detalle.</p>
            
          </dd><dt><span class="term">--testAutomatically</span></dt><dd>
            <p><span class="emphasis"><em>[Opcional] [Booleano] [Autocompletado]</em></span></p>

            <p>Crear los tests funcionales de Selenium
            para este patr&oacute;n. Por defecto los tests no se generan.</p>
          </dd><dt><span class="term">--testName</span></dt><dd>
            <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

            <p>Nombre con el que crear el test funcional de
            Selenium. Por defecto, si no se especifica, el test tomar&aacute; el
            mismo nombre que el proporcionado para el patr&oacute;n.</p>
          </dd><dt><span class="term">--testServerUrl</span></dt><dd>
            <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

            <p>Direcci&oacute;n donde responde la aplicaci&oacute;n donde se
            ejecutan los tests; incluyendo protocolo, servidor, puerto y ruta
            a la aplicaci&oacute;n. Por defecto, toma el valor 
            <span class="emphasis"><em>http://localhost:8080/</em></span>.</p>
          </dd></dl></div><p>
    </p>
  </div>

</div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="apendice-comandos_cit-security"></a>26.6.&nbsp;Comandos del add-on CIT Security</h2></div></div></div>

  

  <p>Para una descripci&oacute;n detallada de las caracter&iacute;sticas
  del add-on consultar la documentaci&oacute;n del <a class="link" href="#addon-cit-security" title="Cap&iacute;tulo 19. Add-on CIT Security">
  add-on CIT Security</a>.</p>

  <div class="table"><a name="d4e4250"></a><p class="title"><b>Table&nbsp;26.6.&nbsp;Comandos de Add-on CIT Security</b></p><div class="table-contents">
    

    <table summary="Comandos de Add-on CIT Security" border="1"><colgroup><col><col></colgroup><thead><tr><th align="center">Comando</th><th align="center">Descripci&oacute;n</th></tr></thead><tbody><tr><td><a class="link" href="#apendice-comandos_addon-cit-security_cit-security-setup" title="26.6.1.&nbsp;cit security setup">cit
          security setup</a></td><td>Instala y configura el sistema de autenticaci&oacute;n y
          autorizaci&oacute;n de la CITMA.</td></tr></tbody></table>
  </div></div><br class="table-break">

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-cit-security_cit-security-setup"></a>26.6.1.&nbsp;cit security setup</h3></div></div></div>
    

    <p>Instala y configura el sistema de autenticaci&oacute;n y
    autorizaci&oacute;n de la Consejer&iacute;a de Infraestructuras, Transporte y
    Medio Ambiente (CITMA) del Gobierno de Valencia.</p>

    <p>Sus par&aacute;metros son:</p><div class="variablelist"><dl><dt><span class="term">--url</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>

            <p>Direcci&oacute;n URL que referencia al punto de entrada o
            <span class="emphasis"><em>end-point</em></span> del servidor de servicio web de
            autenticaci&oacute;n y autorizaci&oacute;n de la CITMA.</p>
          </dd><dt><span class="term">--login</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>

            <p>Nombre de usuario v&aacute;lido para conectar con el
            servicio web de autenticaci&oacute;n y autorizaci&oacute;n de la CITMA.</p>
          </dd><dt><span class="term">--password</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>

            <p>Clave v&aacute;lida para conectar con el servicio web de autenticaci&oacute;n
            y autorizaci&oacute;n de la CITMA.</p>
          </dd><dt><span class="term">--appName</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>

            <p>C&oacute;digo de la aplicaci&oacute;n para la que se
            solicita la informaci&oacute;n de autenticaci&oacute;n y autorizaci&oacute;n al
            servicio web de autenticaci&oacute;n y autorizaci&oacute;n de la CITMA.</p>
          </dd></dl></div>
  </div>
  
</div>
	
  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="apendice-comandos_addon-web-report"></a>26.7.&nbsp;Comandos del add-on Web Report</h2></div></div></div>
         
  

  <p>Para una descripci&oacute;n detallada de las caracter&iacute;sticas
  del add-on consultar la documentaci&oacute;n del <a class="link" href="#addon-web-report" title="Cap&iacute;tulo 20. Add-on Web Report">
  add-on Web Report</a>.</p>
  
  <div class="table"><a name="d4e4298"></a><p class="title"><b>Table&nbsp;26.7.&nbsp;Comandos del add-on Web Report</b></p><div class="table-contents">
    

    <table summary="Comandos del add-on Web Report" border="1"><colgroup><col><col></colgroup><thead><tr><th align="center">Comando</th><th align="center">Descripci&oacute;n</th></tr></thead><tbody><tr><td><a class="link" href="#apendice-comandos_addon-web-report_setup" title="26.7.1.&nbsp;web report setup">web
          report setup</a></td><td>Configura en el proyecto el soporte para la generaci&oacute;n de
          informes en formato PDF, XLS, CSV y HTML</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-web-report_add" title="26.7.2.&nbsp;web report add">web
          report add</a></td><td>Crea un nuevo informe y permite su acceso desde
          el controlador de una entidad que se le proporciona como par&aacute;metro
          </td></tr></tbody></table>
  </div></div><br class="table-break">

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-web-report_setup"></a>26.7.1.&nbsp;web report setup</h3></div></div></div>
    

    <p>Configura en el proyecto el soporte para la generaci&oacute;n
    de informes en formato PDF, XLS, CSV y HTML mediante <span class="emphasis"><em>Jasper Reports
    </em></span> y su descarga desde la aplicaci&oacute;n web.</p>
    
    <p>El comando s&oacute;lo estar&aacute; disponible si el proyecto utiliza
    Spring MVC en la capa web y <a class="link" href="#guia-desarrollo_web_tiles" title="11.2.3.2. Motor de plantillas: Tiles">
    Tiles</a> como motor de vistas web.</p>
    
    <p>Este comando no tiene ning&uacute;n par&aacute;metro obligatorio
    ni opcional.</p>
    
    <p>Para una descripci&oacute;n detallada de las configuraciones
    que realiza este comando en el proyecto, consultar la secci&oacute;n de
    <a class="link" href="#addon-web-report_instalacion" title="20.2. Instalaci&oacute;n">instalaci&oacute;n</a>
    del add-on Web Report.</p>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-web-report_add"></a>26.7.2.&nbsp;web report add</h3></div></div></div>
    

    <p>Crea un nuevo informe y permite su acceso desde el controlador
    de una entidad que se le proporciona como par&aacute;metro al comando. El controlador
    debe obligatoriamente estar gestionando una entidad del proyecto. El informe,
    por defecto, mostrar&aacute; los 10 primeros registros de la entidad.</p>

    <p>Si el comando se ejecuta varias veces sobre el mismo
    controlador y con el mismo nombre de informe, se a&ntilde;adir&aacute;n al informe existente
    los nuevos formatos de generaci&oacute;n que se hayan podido especificar.
    Para mas informaci&oacute;n consultar la secci&oacute;n de
    <a class="link" href="#addon-web-report_generacion" title="20.3. Generaci&oacute;n de un informe">generaci&oacute;n de un informe</a>
    del add-on Web Report.</p>

    <p>El comando s&oacute;lo estar&aacute; disponible si el proyecto utiliza
    Spring MVC en la capa web y <a class="link" href="#guia-desarrollo_web_tiles" title="11.2.3.2. Motor de plantillas: Tiles">
    Tiles</a> como motor de vistas web.</p>
    
    <p>Sus par&aacute;metros son:</p><div class="variablelist"><dl><dt><span class="term">--controller</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Clase Java] [Autocompletado]</em></span></p>

            <p>Clase controladora que gestiona una entidad en la que se
            desea a&ntilde;adir el informe. Este controlador ha de contener la
	        anotaci&oacute;n <span class="emphasis"><em>@RooWebScaffold</em></span> y su atributo
	        <span class="emphasis"><em>formBackingObject</em></span> indicar&aacute; la entidad para la que
	        se generar&aacute; el informe.</p>
          </dd><dt><span class="term">--reportName</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>

            <p>Nombre que se le quiere dar al informe y que servir&aacute;
            de identificador &uacute;nico. No admite espacios y el valor proporcionado ser&aacute;
            convertido a min&uacute;sculas.</p>
          </dd><dt><span class="term">--format</span></dt><dd>
            <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

            <p>Lista de formatos en los que se permitir&aacute; generar el informe.
            Los formatos de la lista deber&aacute;n estar separados por comas y sin espacios.
            Los formatos soportados son: <span class="emphasis"><em>pdf, xls, csv y html</em></span>.
            Si el nombre del informe ya existe en un controlador, los formatos
            nuevos que se hubiesen podido definir se a&ntilde;adir&aacute;n al informe existente.
            Los formatos siempre ser&aacute;n convertidos a min&uacute;sculas.
            Si este par&aacute;metro no se especifica, tomar&aacute;
            por defecto el valor <span class="emphasis"><em>pdf</em></span>.</p>
          </dd></dl></div>
  </div>
</div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="apendice-comandos_addon-service"></a>26.8.&nbsp;Comandos del add-on Service</h2></div></div></div>
         
  

  <p>Para una descripci&oacute;n detallada de las caracter&iacute;sticas
  del add-on consultar la documentaci&oacute;n del <a class="link" href="#addon-service" title="Cap&iacute;tulo 21. Add-on Service">
  add-on Service</a>.</p>
  
  <div class="table"><a name="d4e4360"></a><p class="title"><b>Table&nbsp;26.8.&nbsp;Comandos del add-on Service</b></p><div class="table-contents">
    

    <table summary="Comandos del add-on Service" border="1"><colgroup><col><col></colgroup><thead><tr><th align="center">Comando</th><th align="center">Descripci&oacute;n</th></tr></thead><tbody><tr><td><a class="link" href="#apendice-comandos_addon-service_class" title="26.8.1.&nbsp;remote service class">remote service
          class</a></td><td>Crea una clase Java que actuar&aacute; como servicio local
          dentro de la aplicaci&oacute;n</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-service_operation" title="26.8.2.&nbsp;remote service operation">remote service
          operation</a></td><td>A&ntilde;ade un nuevo m&eacute;todo en una clase Java</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-service_define_ws" title="26.8.3.&nbsp;remote service define ws">remote service define
          ws</a></td><td>Hace que una clase Java pueda ser accedida desde
          el exterior a trav&eacute;s de un servicio web</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-service_export_operation" title="26.8.4.&nbsp;remote service export operation">remote service
          export operation</a></td><td>Hace que un m&eacute;todo de una clase Java pueda
          ser accedido desde el exterior a trav&eacute;s de una operaci&oacute;n
          del servicio web</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-service_list_operation" title="26.8.5.&nbsp;remote service list operation">remote service
          list operation</a></td><td>Muestra el listado de m&eacute;todos de una clase Java que
          podr&iacute;an ser ofrecidos al exterior como operaciones del servicio web</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-service_export_ws" title="26.8.6.&nbsp;remote service export ws">remote service export
          ws</a></td><td>Crea en el proyecto la infraestructura necesaria
          definida por un <span class="emphasis"><em>WSDL</em></span> para ofrecer ciertas operaciones
          mediante un servicio web
          </td></tr><tr><td><a class="link" href="#apendice-comandos_addon-service_import_ws" title="26.8.7.&nbsp;remote service import ws">remote service import
          ws</a></td><td>Crea en el proyecto la infraestructura necesaria
          definida por un <span class="emphasis"><em>WSDL</em></span> para acceder a ciertas operaciones
          situadas en un servicio web</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-service_ws_list" title="26.8.8.&nbsp;remote service ws list">remote service ws
          list</a></td><td>Lista los servicios web que se encuentran definidos
          en la aplicaci&oacute;n</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-service_security_ws" title="26.8.9.&nbsp;remote service security ws">remote service
          security ws</a></td><td>A&ntilde;ade la configuraci&oacute;n necesaria para firmar las
          peticiones que se hacen a un servicio web remoto</td></tr></tbody></table>
  </div></div><br class="table-break">

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-service_class"></a>26.8.1.&nbsp;remote service class</h3></div></div></div>
    

    <p>Crea una clase Java que actuar&aacute; como servicio local
    dentro de la aplicaci&oacute;n. El servicio se podr&aacute; utilizar desde
    cualquier otra clase Java definiendo una propiedad del tipo de la clase
    de servicio con la anotaci&oacute;n <span class="emphasis"><em>@Autowired</em></span>.</p>
    
    <p>Sus par&aacute;metros son:
    </p><div class="variablelist"><dl><dt><span class="term">--class</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Clase Java] [Autocompletado]</em></span></p>

            <p>Paquete y nombre donde crear la clase Java
            de servicio.</p>
          </dd></dl></div>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-service_operation"></a>26.8.2.&nbsp;remote service operation</h3></div></div></div>
    

    <p>A&ntilde;ade un nuevo m&eacute;todo en una clase Java.
    La clase Java puede ser una entidad, controlador,
    servicio o cualquier otro tipo.</p>

    <p>Sus par&aacute;metros son:
    </p><div class="variablelist"><dl><dt><span class="term">--name</span></dt><dd>
          <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>

          <p>Nombre del m&eacute;todo a a&ntilde;adir en la clase Java.</p>
        </dd><dt><span class="term">--service</span></dt><dd>
          <p><span class="emphasis"><em>[Requerido] [Clase Java] [Autocompletado]</em></span></p>

          <p>Paquete y nombre de la clase Java donde crear el
          nuevo m&eacute;todo.</p>
        </dd><dt><span class="term">--return</span></dt><dd>
          <p><span class="emphasis"><em>[Opcional] [Tipo Java] [Autocompletado]</em></span></p>

          <p>Tipo de dato Java que devolver&aacute; el m&eacute;todo.</p>
        </dd><dt><span class="term">--paramNames</span></dt><dd>
          <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

          <p>Nombre de los par&aacute;metros de entrada del m&eacute;todo,
          separados mediante comas y sin espacios.</p>
        </dd><dt><span class="term">--paramTypes</span></dt><dd>
          <p><span class="emphasis"><em>[Opcional] [Tipos Java] [Autocompletado]</em></span></p>

          <p>Tipos Java de los par&aacute;metros de entrada del m&eacute;todo,
          separados mediante comas y sin espacios.</p>
        </dd><dt><span class="term">--exceptions</span></dt><dd>
          <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

          <p>Tipos Java de las excepciones que puede lanzar el
          m&eacute;todo, separados mediante comas y sin espacios.</p>
        </dd></dl></div><p>
    </p>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-service_define_ws"></a>26.8.3.&nbsp;remote service define ws</h3></div></div></div>
    

    <p>Hace que una clase Java pueda ser accedida
    desde el exterior a trav&eacute;s de un servicio web.
    Para ello, crear&aacute; toda la infraestructura necesaria para
    que sistemas externos puedan comunicarse con ella mediante los protocolos
    y tecnolog&iacute;as propias de los servicios web. Si la clase indicada como
    par&aacute;metro no existe, ser&aacute; creada autom&aacute;ticamente.</p>
    
    <p>Se recomienda no especificar en este comando
    ning&uacute;n par&aacute;metro opcional si no es estrictamente necesario
    y se conoce las implicaciones que tendr&aacute; desde el punto de vista
    de la interoperabilidad de servicios web. Si no se especifica, para
    cada par&aacute;metro se proporcionar&aacute; un valor adecuado para facilitar
    la m&aacute;xima interoperabilidad del servicio web con el exterior.</p>
    
    <p>Tr&aacute;s publicar una clase Java a trav&eacute;s de un
    servicio web, sus m&eacute;todos todav&iacute;a no ser&aacute;n accesibles como
    operaciones del servicio web hasta que no se le indique
    para cada m&eacute;todo.</p>

    <p>Sus par&aacute;metros son:
    </p><div class="variablelist"><dl><dt><span class="term">--class</span></dt><dd>
          <p><span class="emphasis"><em>[Requerido] [Clase Java] [Autocompletado]</em></span></p>

          <p>Paquete y nombre de la clase Java a hacer
          accesible desde el exterior a trav&eacute;s de un servicio web.
          Si la clase Java no existe, ser&aacute; creada y adem&aacute;s se le aplicar&aacute;
          las caracter&iacute;sticas propias de un servicio local. Por ejemplo,
          <span class="emphasis"><em>org.gvnix.test.service.Service</em></span>.</p>
        </dd><dt><span class="term">--serviceName</span></dt><dd>
          <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

          <p>Nombre con el que se quiere publicar el servicio web.
          Por defecto, tomar&aacute; el mismo nombre que la clase Java. Por ejemplo,
          <span class="emphasis"><em>Service</em></span>.</p>
        </dd><dt><span class="term">--portTypeName</span></dt><dd>
          <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

          <p>Nombre para el tipo de puerto o
          <span class="emphasis"><em>PortType</em></span> del servicio web.
          Por defecto, tomar&aacute; el mismo nombre que la clase Java seguido del sufijo 
          <span class="emphasis"><em>PortType</em></span>. Por ejemplo, <span class="emphasis"><em>ServicePortType
          </em></span>.</p>

        </dd><dt><span class="term">--addressName</span></dt><dd>
          <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

          <p>Direcci&oacute;n URL relativa a la ra&iacute;z de la aplicaci&oacute;n
          desde donde se podr&aacute; acceder al servicio web.
          Por defecto, tomar&aacute; el mismo nombre que la clase Java.
          Por ejemplo, <span class="emphasis"><em>Service</em></span>.</p>
        </dd><dt><span class="term">--targetNamespace</span></dt><dd>
          <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

          <p>Espacio de nombres o <span class="emphasis"><em>Namespace</em></span>
          del servicio web. Debe tener formato de URL. Por defecto,
          tendr&aacute; el mismo valor que el paquete de la clase Java
          en sentido inverso y con formato de URL. Por ejemplo,
          <span class="emphasis"><em>http://service.test.gvnix.org/</em></span>.</p>
        </dd></dl></div><p>
    </p>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-service_export_operation"></a>26.8.4.&nbsp;remote service export operation</h3></div></div></div>
    

    <p>Hace que un m&eacute;todo de una clase Java pueda
    ser accedido desde el exterior a trav&eacute;s de una 
    operaci&oacute;n del servicio web. Para ello, crear&aacute; 
    toda la infraestructura necesaria para que sistemas
    externos puedan comunicarse con ella mediante los protocolos
    y tecnolog&iacute;as propias de los servicios web. Si la clase indicada como
    par&aacute;metro no est&aacute; configurada todav&iacute;a para ser accedida a trav&eacute;s de un
    servicio web, se le aplicar&aacute; esta configuraci&oacute;n autom&aacute;ticamente.</p>
    
    <p>Se recomienda no especificar en este comando
    ning&uacute;n par&aacute;metro opcional si no es estrictamente necesario
    y se conoce las implicaciones que tendr&aacute; desde el punto de vista
    de la interoperabilidad de servicios web. Si no se especifica, para
    cada par&aacute;metro se proporcionar&aacute; un valor adecuado para facilitar
    la m&aacute;xima interoperabilidad de la operaci&oacute;n del servicio web
    con el exterior.</p>

    <p>Sus par&aacute;metros son:
    </p><div class="variablelist"><dl><dt><span class="term">--class</span></dt><dd>
          <p><span class="emphasis"><em>[Requerido] [Clase Java] [Autocompletado]</em></span></p>

          <p>Paquete y nombre de la clase Java que contiene el m&eacute;todo
          que se desea hacer accesible a trav&eacute;s de una operaci&oacute;n del servicio web. 
          Por ejemplo, <span class="emphasis"><em>org.gvnix.test.service.Service</em></span>.</p>
        </dd><dt><span class="term">--method</span></dt><dd>
          <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>

          <p>Nombre del m&eacute;todo que se desea hacer accesible
          a trav&eacute;s de una operaci&oacute;n del servicio web. Por ejemplo, 
          <span class="emphasis"><em>method</em></span>.
          </p>
        </dd><dt><span class="term">--operationName</span></dt><dd>
          <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

          <p>Nombre que tendr&aacute; la operaci&oacute;n del servicio
          web y que dar&aacute; acceso al m&eacute;todo de la clase Java. Por defecto,
          tomar&aacute; el mismo nombre que el m&eacute;todo. Por ejemplo, 
          <span class="emphasis"><em>method</em></span>.</p>
        </dd><dt><span class="term">--resultName</span></dt><dd>
          <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

          <p>Nombre que tendr&aacute; el resultado de la operaci&oacute;n del
          servicio web y que ser&aacute; de un tipo de datos equivalente al resultado
          del m&eacute;todo. Por defecto, tomar&aacute; el nombre <span class="emphasis"><em>result</em></span>.
          </p>
        </dd><dt><span class="term">--resultNamespace</span></dt><dd>
          <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

          <p>Espacio de nombres o <span class="emphasis"><em>Namespace</em></span>
          del resultado de la operaci&oacute;n del servicio web. Debe tener formato de
          URL. Por defecto, tendr&aacute; el mismo valor que el paquete de la clase Java
          en sentido inverso y con formato de URL. Por ejemplo,
          <span class="emphasis"><em>http://service.test.gvnix.org/</em></span>.</p>
        </dd><dt><span class="term">--responseWrapperName</span></dt><dd>
          <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

          <p>Nombre que tendr&aacute; el objeto que contendr&aacute; la
          respuesta de la operaci&oacute;n del servicio web. Por defecto, tomar&aacute; el
          mismo nombre que el m&eacute;todo seguido del sufijo  <span class="emphasis"><em>Response
          </em></span>. Por ejemplo, <span class="emphasis"><em>methodResponse</em></span>.</p>
        </dd><dt><span class="term">--responseWrapperNamespace</span></dt><dd>
          <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

          <p>Espacio de nombres o <span class="emphasis"><em>Namespace</em></span>
          del objeto que contendr&aacute; el resultado de la operaci&oacute;n del servicio web.
          Debe tener formato de URL. Por defecto, tendr&aacute; el mismo valor que el
          paquete de la clase Java en sentido inverso y con formato de URL.
          Por ejemplo, <span class="emphasis"><em>http://service.test.gvnix.org/</em></span>.</p>
        </dd><dt><span class="term">--requestWrapperName</span></dt><dd>
          <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

          <p>Nombre que deber&aacute; tener el objeto que contendr&aacute; la
          petici&oacute;n a la operaci&oacute;n del servicio web. Por defecto, tomar&aacute; el
          mismo nombre que el m&eacute;todo. Por ejemplo, <span class="emphasis"><em>method</em></span>.
          </p>
        </dd><dt><span class="term">--requestWrapperNamespace</span></dt><dd>
          <p><span class="emphasis"><em>[Opcional] [Cadena]</em></span></p>

          <p>Espacio de nombres o <span class="emphasis"><em>Namespace</em></span>
          del objeto que contendr&aacute; el la petici&oacute;n a la operaci&oacute;n del servicio web.
          Debe tener formato de URL. Por defecto, tendr&aacute; el mismo valor que el
          paquete de la clase Java en sentido inverso y con formato de URL.
          Por ejemplo, <span class="emphasis"><em>http://service.test.gvnix.org/</em></span>.</p>
        </dd></dl></div><p>
    </p>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-service_list_operation"></a>26.8.5.&nbsp;remote service list operation</h3></div></div></div>
    

    <p>Muestra el listado de m&eacute;todos de una clase Java que podr&iacute;an
    ser ofrecidos como operaciones del servicio web. La clase Java debe haber sido
    previamente definida como accesible a trav&eacute;s de un servicio web.</p>

    <p>Sus par&aacute;metros son:
    </p><div class="variablelist"><dl><dt><span class="term">--class</span></dt><dd>
          <p><span class="emphasis"><em>[Requerido] [Clase Java] [Autocompletado]</em></span></p>

          <p>Paquete y nombre de la clase Java de la que obtener
          el listado de m&eacute;todos que podr&iacute;an ser ofrecidos como operaciones del
          servicio web. Por ejemplo, <span class="emphasis"><em>org.gvnix.test.service.Service
          </em></span>.</p>
        </dd></dl></div><p>
    </p>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-service_export_ws"></a>26.8.6.&nbsp;remote service export ws</h3></div></div></div>
    

    <p>Crea en el proyecto toda la infraestructura necesaria para
    ofrecer ciertas operaciones mediante un servicio web. El servicio web y sus
    operaciones vendr&aacute;n definidas mediante un contrato de servicio o
    <span class="emphasis"><em>WSDL</em></span>.</p>
    
    <p>El comando crear&aacute; una clase Java que representar&aacute;
    en el proyecto al servicio web y crear&aacute; dentro tantos m&eacute;todos como
    operaciones hubiesen definidas en el contrato de servicio. Con esto,
    el servicio web y sus operaciones ya son accesibles desde el exterior.  
    Ser&aacute; responsabilidad del desarrollador el implementar la l&oacute;gica de
    negocio de cada m&eacute;todo.</p>
    
    <p>Sus par&aacute;metros son:    
    </p><div class="variablelist"><dl><dt><span class="term">--wsdl</span></dt><dd>
          <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>

          <p>Ruta al archivo que define el contrado de servicio o
          <span class="emphasis"><em>WSDL</em></span> cuya infraestructura Java se desea crear en
          el proyecto. La ruta puede ser a un archivo local 
          mediante <span class="emphasis"><em>file://ruta</em></span>, a una direcci&oacute;n web mediante
          <span class="emphasis"><em>http://ruta</em></span> o a una direcci&oacute;n web segura mediante
          <span class="emphasis"><em>https://ruta</em></span>.</p>
        </dd></dl></div><p>
    </p>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-service_import_ws"></a>26.8.7.&nbsp;remote service import ws</h3></div></div></div>
    

    <p>Crea en el proyecto toda la infraestructura necesaria para
    acceder a ciertas operaciones situadas en un servicio web. El servicio web y sus
    operaciones vendr&aacute;n definidas mediante un contrato de servicio o
    <span class="emphasis"><em>WSDL</em></span>.</p>
    
    <p>El comando crear&aacute; una clase Java que representar&aacute;
    en el proyecto al servicio web y crear&aacute; dentro tantos m&eacute;todos como
    operaciones hubiesen definidas en el contrato de servicio. Invocando
    a alguno de estos m&eacute;todos se estar&aacute; accediendo a la operaci&oacute;n
    correspondiente del sistema externo.</p>
    
    <p>Sus par&aacute;metros son:
    </p><div class="variablelist"><dl><dt><span class="term">--wsld</span></dt><dd>
          <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>

          <p>Ruta al archivo que define el contrado de servicio o
          <span class="emphasis"><em>WSDL</em></span> cuya infraestructura Java se desea crear en
          el proyecto. La ruta puede ser a un archivo local 
          mediante <span class="emphasis"><em>file://ruta</em></span>, a una direcci&oacute;n web mediante
          <span class="emphasis"><em>http://ruta</em></span> o a una direcci&oacute;n web segura mediante
          <span class="emphasis"><em>https://ruta</em></span>.</p>
        </dd><dt><span class="term">--class</span></dt><dd>
          <p><span class="emphasis"><em>[Requerido] [Clase Java] [Autocompletado]</em></span></p>
          
          <p>Paquete y nombre de la clase Java que permitir&aacute;
          acceder al servicio web externo creando un m&eacute;todo por cada una de
          las operaciones del servicio web. Si la clase Java no existe,
          ser&aacute; creada y adem&aacute;s se le aplicar&aacute; las caracter&iacute;sticas
          propias de un servicio local. Por ejemplo,
          <span class="emphasis"><em>org.gvnix.test.service.Service</em></span>.</p>
        </dd></dl></div><p>
    </p>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-service_ws_list"></a>26.8.8.&nbsp;remote service ws list</h3></div></div></div>
    

    <p>Lista los servicios web que se encuentran definidos en
    la aplicaci&oacute;n, tanto los que ofrecen servicios web al exterior como los que
    acceden a servicios web externos.</p>
    
    <p>Este comando no tiene ning&uacute;n par&aacute;metro obligatorio
    ni opcional.</p>
    
</div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-service_security_ws"></a>26.8.9.&nbsp;remote service security ws</h3></div></div></div>
    

    <p>A&ntilde;ade la configuraci&oacute;n necesaria para firmar las
    peticiones que se hacen a un servicio web remoto.</p>

    <p>Sus par&aacute;metros son:
    </p><div class="variablelist"><dl><dt><span class="term">--class</span></dt><dd>
          <p><span class="emphasis"><em>[Requerido] [Clase Java] [Autocompletado]</em></span></p>
          
          <p>Paquete y nombre de la clase Java que define
          realiza el acceso al servicio web externo. Por ejemplo,
          <span class="emphasis"><em>org.gvnix.test.service.Service</em></span>.</p>

        </dd><dt><span class="term">--certificate</span></dt><dd>
          <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>

          <p>Ruta y nombre del fichero donde se encuentra el
          certificado a utilizar para firmar la petici&oacute;n. El certificado debe
          de tener un formato <span class="emphasis"><em>pkcs12</em></span> y una extensi&oacute;n
          <span class="emphasis"><em>p12</em></span>. El certificado ser&aacute; copiado
          al directorio de recursos del proyecto. Por ejemplo,
          <span class="emphasis"><em>/tmp/certificado.p12</em></span>.</p>
        </dd><dt><span class="term">--password</span></dt><dd>
          <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>

          <p>Contrase&ntilde;a para acceder al certificado de firma.</p>
        </dd><dt><span class="term">--alias</span></dt><dd>
          <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>

          <p>Alias a utilizar para la firma.</p>
        </dd></dl></div><p>
    </p>
  </div>
</div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="apendice-comandos_addon-web_i18n"></a>26.9.&nbsp;Comandos del add-on Web MVC i18n</h2></div></div></div>
         
  

  <p>Para una descripci&oacute;n detallada de las caracter&iacute;sticas
  del add-on consultar la documentaci&oacute;n del <a class="link" href="#addon-web-i18n" title="Cap&iacute;tulo 22. Add-on Web MVC i18n">
  add-on Web MVC i18n</a>.</p>
  
  <div class="table"><a name="d4e4673"></a><p class="title"><b>Table&nbsp;26.9.&nbsp;Comandos de add-on Web MVC i18n</b></p><div class="table-contents">
    

    <table summary="Comandos de add-on Web MVC i18n" border="1"><colgroup><col><col></colgroup><thead><tr><th align="center">Comando</th><th align="center">Descripci&oacute;n</th></tr></thead><tbody><tr><td><a class="link" href="#apendice-comandos_addon-web_i18n_install_language" title="26.9.1.&nbsp;web mvc install language">web mvc
          install language</a></td><td>Instala el soporte para un nuevo idioma en el proyecto</td></tr></tbody></table>
  </div></div><br class="table-break">

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-web_i18n_install_language"></a>26.9.1.&nbsp;web mvc install language</h3></div></div></div>
    

    <p>Crea un fichero de propiedades con las traducciones
    de las etiquetas multi idioma del proyecto en el lenguage solicitado y
    configura en la capa web un acceso para cambiar a dicho idioma.</p>
    
    <p>Sus par&aacute;metros son:
    </p><div class="variablelist"><dl><dt><span class="term">--code</span></dt><dd>
            <p><span class="emphasis"><em>[Requerido] [Idioma] [Autocompletado]</em></span></p>

            <p>C&oacute;digo del idioma a instalar. Los idiomas
            disponibles son <span class="emphasis"><em>de, en, es, it, nl y sv.</em></span></p>
          </dd></dl></div>
  </div>
</div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="apendice-comandos_addon-dynamic_config"></a>26.10.&nbsp;Comandos del add-on Dynamic Configuration</h2></div></div></div>
         
  

  <p>Para una descripci&oacute;n detallada de las caracter&iacute;sticas
  del add-on consultar la documentaci&oacute;n del <a class="link" href="#addon-dynamic_config" title="Chapter&nbsp;23.&nbsp;Add-on Dynamic Configuration">
  add-on Dynamic Configuration</a>.</p>
  
  <div class="table"><a name="d4e4703"></a><p class="title"><b>Table&nbsp;26.10.&nbsp;Comandos del add-on Dynamic Configuration</b></p><div class="table-contents">
    

    <table summary="Comandos del add-on Dynamic Configuration" border="1"><colgroup><col><col></colgroup><thead><tr><th align="center">Comando</th><th align="center">Descripci&oacute;n</th></tr></thead><tbody><tr><td><a class="link" href="#apendice-comandos_addon-dynamic_config-config_save" title="26.10.1.&nbsp;configuration create">configuration
          create</a></td><td>Crea una nueva configuraci&oacute;n con un determinado nombre</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-dynamic_config-config_prop_add" title="26.10.2.&nbsp;configuration property add">configuration
          property add</a></td><td>A&ntilde;ade una propiedad a la gesti&oacute;n de configuraciones</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-dynamic_config-config_prop_update" title="26.10.3.&nbsp;configuration property value">configuration
          property value</a></td><td>Cambia el valor que tiene una propiedad en una determinada
          configuraci&oacute;n</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-dynamic_config-config_prop_undefined" title="26.10.4.&nbsp;configuration property undefined">configuration
          property undefined</a></td><td>Deja sin valor una propiedad en una determinada
          configuraci&oacute;n</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-dynamic_config-config_list" title="26.10.5.&nbsp;configuration list">configuration
          list</a></td><td>Lista todas las configuraciones definidas</td></tr><tr><td><a class="link" href="#apendice-comandos_addon-dynamic_config-config_export" title="26.10.6.&nbsp;configuration export">configuration
          export</a></td><td>Escribe en el proyecto los cambios definidos hasta el
          momento en las configuraciones</td></tr></tbody></table>
  </div></div><br class="table-break">

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-dynamic_config-config_save"></a>26.10.1.&nbsp;configuration create</h3></div></div></div>
    

    <p>Crea una nueva configuraci&oacute;n con un determinado nombre.</p>
    
    <p>La primera configuraci&oacute;n creada quedar&aacute; marcada
    como la configuraci&oacute;n por defecto de modo que en el caso de empaquetar
    la aplicaci&oacute;n sin elegir ninguna configuraci&oacute;n, ser&aacute; esta la que se
    aplique.</p>

    <p>Sus par&aacute;metros son:
    </p><div class="variablelist"><dl><dt><span class="term">--name</span></dt><dd>
          <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>
          
          <p>Nombre para la nueva configuraci&oacute;n que la
          referenciar&aacute; de forma un&iacute;voca.</p>
        </dd></dl></div><p>
    </p>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-dynamic_config-config_prop_add"></a>26.10.2.&nbsp;configuration property add</h3></div></div></div>
    

    <p>A&ntilde;ade una propiedad a la gesti&oacute;n de
    configuraciones de modo que dicha propiedad podr&aacute; tener distinto
    valor para cada configuraci&oacute;n.</p>
    
    <p>Al a&ntilde;adir una nueva propiedad, quedar&aacute;
    almacenado internamente el valor que tubiese en dicho momento.
    En todas las configuraciones existentes en ese momento
    y en aquellas que se creen en un futuro la propiedad tendr&aacute;
    por defecto dicho valor.</p>

    <p>Sus par&aacute;metros son:
    </p><div class="variablelist"><dl><dt><span class="term">--name</span></dt><dd>
          <p><span class="emphasis"><em>[Requerido] [Propiedad] [Autocompletado]</em></span></p>
          
          <p>Nombre de la propiedad cuyo valor puede
          tomar distinto valor en cada configuraci&oacute;n.</p>
        </dd></dl></div><p>
    </p>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-dynamic_config-config_prop_update"></a>26.10.3.&nbsp;configuration property value</h3></div></div></div>
    

    <p>Cambia el valor que tiene una propiedad en una determinada
    configuraci&oacute;n.</p>

    <p>Sus par&aacute;metros son:
    </p><div class="variablelist"><dl><dt><span class="term">--configuration</span></dt><dd>
          <p><span class="emphasis"><em>[Requerido] [Configuraci&oacute;n] [Autocompletado]</em></span></p>
          
          <p>Nombre de la configuraci&oacute;n cuyo
          valor para una propiedad se quiere modificar.</p>
        </dd><dt><span class="term">--property</span></dt><dd>
          <p><span class="emphasis"><em>[Requerido] [Propiedad] [Autocompletado]</em></span></p>
          
          <p>Nombre de la propiedad cuyo valor se
          desea modificar.</p>
        </dd><dt><span class="term">--value</span></dt><dd>
          <p><span class="emphasis"><em>[Requerido] [Cadena]</em></span></p>
          
          <p>Nuevo valor para la propiedad en la configuraci&oacute;n.</p>
        </dd></dl></div><p>
    </p>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-dynamic_config-config_prop_undefined"></a>26.10.4.&nbsp;configuration property undefined</h3></div></div></div>
    

    <p>Deja sin valor una propiedad en una determinada configuraci&oacute;n.</p>
    
    <p>Esto es &uacute;til para evitar que quede almacenado en el c&oacute;digo fuente del
    proyecto algunos valores cr&iacute;ticos como puede ser la clave de conexi&oacute;n con la base de
    datos de producci&oacute;n. El valor se tendr&aacute; que proporcionar al empaquetar
    la aplicaci&oacute;n con Maven como un par&aacute;metro mediante el modificador
    <span class="emphasis"><em>-Dnombre.propiedad=valor</em></span>.</p>

    <p>Sus par&aacute;metros son:
    </p><div class="variablelist"><dl><dt><span class="term">--configuration</span></dt><dd>
          <p><span class="emphasis"><em>[Requerido] [Configuraci&oacute;n] [Autocompletado]</em></span></p>
          
          <p>Nombre de la configuraci&oacute;n cuyo
          valor para una propiedad se desea dejar sin valor.</p>
        </dd><dt><span class="term">--property</span></dt><dd>
          <p><span class="emphasis"><em>[Requerido] [Propiedad] [Autocompletado]</em></span></p>
          
          <p>Nombre de la propiedad cuyo valor se
          desea dejar sin valor.</p>
        </dd></dl></div><p>
    </p>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-dynamic_config-config_list"></a>26.10.5.&nbsp;configuration list</h3></div></div></div>
    

    <p>Lista todas las configuraciones definidas junto con las
    propiedades incluidas y los valores definidos para cada una de ellas.</p>
    
    <p>Este comando no tiene ning&uacute;n par&aacute;metro obligatorio
    ni opcional.</p>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-dynamic_config-config_export"></a>26.10.6.&nbsp;configuration export</h3></div></div></div>
    

    <p>Escribe en el proyecto los cambios definidos
    hasta el momento en las configuraciones mediante todos los comandos 
    anteriores utilizando para ello el sistema de perfiles de Maven. Mientras
    no se ejecute este comando, las configuraciones no ser&aacute;n aplicadas en el
    proyecto y por lo tanto no podr&aacute;n ser utilizadas.</p>
    
    <p>Este comando no tiene ning&uacute;n par&aacute;metro obligatorio
    ni opcional.</p>
  </div>
</div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="apendice-comandos_addon-web-mvc-binding"></a>26.11.&nbsp;Comandos del add-on Web MVC Binding</h2></div></div></div>
         
  

  <p>Para una descripci&oacute;n detallada de las caracter&iacute;sticas
  del add-on consultar la documentaci&oacute;n del <a class="link" href="#addon-web-mvc-binding" title="Cap&iacute;tulo 24. Add-on Web MVC Binding">
  add-on Web MVC Binding</a>.</p>
  
  <div class="table"><a name="d4e4815"></a><p class="title"><b>Table&nbsp;26.11.&nbsp;Comandos del add-on Web MVC Binding</b></p><div class="table-contents">
    

    <table summary="Comandos del add-on Web MVC Binding" border="1"><colgroup><col><col></colgroup><thead><tr><th align="center">Comando</th><th align="center">Descripci&oacute;n</th></tr></thead><tbody><tr><td><a class="link" href="#apendice-comandos_addon-web-mvc-binding_web-binding-setup" title="26.11.1.&nbsp;web mvc binding stringTrimmer">web
          mvc binding stringTrimmer</a></td><td>Registra el StringTrimmerEditor.</td></tr></tbody></table>
  </div></div><br class="table-break">

  <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="apendice-comandos_addon-web-mvc-binding_web-binding-setup"></a>26.11.1.&nbsp;web mvc binding stringTrimmer</h3></div></div></div>
    

	<p>Configura en un controlador concreto o en todos los
	controladores del proyecto un editor de propiedades para cadenas
	que elimina espacios al inicio y al fin y opcionalmente permite transformar
	cadenas vac&iacute;as a valores nulos.</p>
  
    <p>Sus par&aacute;metros son:</p><div class="variablelist"><dl><dt><span class="term">--class</span></dt><dd>
            <p><span class="emphasis"><em>[Opcional] [Clase Java] [Autocompletado]</em></span></p>

            <p>Nombre de la clase Java controladora en la que
            registrar el editor. Si no se indica este par&aacute;metro, se registrar&aacute; el
            editor en todos los controladores del proyecto.</p>
          </dd><dt><span class="term">--emptyAsNull</span></dt><dd>
            <p><span class="emphasis"><em>[Opcional] [Booleano] [Autocompletado]</em></span></p>

            <p>Indica si las cadenas vacias deben convertirse en
            valores nulos.</p>
          </dd></dl></div>
  </div>
</div>
</div>
  </div>

  <div class="part" lang="es"><div class="titlepage"><div><div><h1 class="title"><a name="d4e4846"></a>Parte&nbsp;VI.&nbsp;Recursos</h1></div></div></div>
    

    <div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="recursos"></a>Chapter&nbsp;27.&nbsp;Recursos</h2></div></div></div>
  

  <p>En este apartado pondremos una lista de recursos de documentaci&oacute;n,
  tutoriales, etc que pueden ser &uacute;tiles.</p>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="recursos_cit"></a>27.1.&nbsp;Proyectos relacionados con gvNIX</h2></div></div></div>
    

    <p>Proyectos relacionados con gvNIX y con la Consejer&iacute;a
    de Infraestructuras, Transporte y Medio Ambiente de la Generalidad Valenciana.</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p><a class="ulink" href="http://www.gvpontis.gva.es/" target="_top">gvPONTIS</a></p>
      </li><li>
        <p><a class="ulink" href="http://www.gvsig.org/" target="_top">gvSIG</a></p>
      </li><li>
        <p><a class="ulink" href="http://www.gvpontis.gva.es/proyectos-integra/proy-desarrollo/gvhidra-herramienta/" target="_top">gvHIDRA</a></p>
      </li><li>
        <p><a class="ulink" href="http://www.moskitt.org/" target="_top">Moskitt</a></p>
      </li></ul></div>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="recursos_roo"></a>27.2.&nbsp;Recursos de Spring Roo</h2></div></div></div>
    

    <p>Esta es una lista de recursos relacionados con Spring Roo:</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p><a class="ulink" href="http://static.springsource.org/spring-roo/reference/html-single/index.html" target="_top">Documentaci&oacute;n
        de referencia Spring Roo (<span class="emphasis"><em>on-line</em></span>)</a></p>
      </li></ul></div>

    <div class="itemizedlist"><ul type="disc"><li>
        <p><a class="ulink" href="http://www.springsource.org/roo" target="_top">P&aacute;gina del
        proyecto</a></p>
      </li><li>
        <p><a class="ulink" href="http://forum.springsource.org/forumdisplay.php?f=67" target="_top">Foro
        de Spring Roo</a></p>
      </li><li>
        <p><a class="ulink" href="http://jira.springframework.org/browse/ROO" target="_top">JIRA de Spring
        Roo</a></p>
      </li><li>
        <p><a class="ulink" href="http://www.springsource.com/products/sts" target="_top">Spring STS
        (Spring Tools Suite)</a></p>
      </li><li>
        <p><a class="ulink" href="http://forum.springsource.org/showthread.php?t=71985" target="_top">P&aacute;gina
        con recursos para Roo</a></p>
      </li></ul></div>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="recursos_librerias"></a>27.3.&nbsp;Recursos de librer&iacute;as relacionadas</h2></div></div></div>
    

    <p>Enlaces a recursos de librer&iacute;as relacionadas con los
    proyectos generados.</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p><a class="ulink" href="http://www.springsource.org/about" target="_top">Spring</a></p>
      </li><li>
        <p><a class="ulink" href="http://static.springsource.org/spring/docs/3.0.x/reference/index.html" target="_top">
        Documentaci&oacute;n de Spring Framework</a></p>
      </li><li>
        <p><a class="ulink" href="http://static.springsource.org/spring/docs/3.0.x/reference/mvc.html" target="_top">
        Documentaci&oacute;n de Spring MVC</a></p>
      </li><li>
        <p><a class="ulink" href="http://static.springsource.org/spring-security/site/" target="_top">Spring
        Security</a></p>
      </li><li>
        <p><a class="ulink" href="http://www.eclipse.org/aspectj/" target="_top">AspectJ (Aspectos Java)</a></p>
      </li><li>
        <p><a class="ulink" href="http://www.eclipse.org/ajdt/" target="_top">AJDT</a></p>
      </li></ul></div>
  </div>
</div>
  </div>
</div></body></html>